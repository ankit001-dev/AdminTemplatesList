import.meta;var Fn=Object.defineProperty,Un=Object.defineProperties,Bn=Object.getOwnPropertyDescriptors,nr=Object.getOwnPropertySymbols,$n=Object.prototype.hasOwnProperty,Hn=Object.prototype.propertyIsEnumerable,gt=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),ft=(t,e,n)=>e in t?Fn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_=(t,e)=>{for(var n in e||(e={}))$n.call(e,n)&&ft(t,n,e[n]);if(nr)for(var n of nr(e))Hn.call(e,n)&&ft(t,n,e[n]);return t},D=(t,e)=>Un(t,Bn(e)),c=(t,e,n)=>(ft(t,typeof e!="symbol"?e+"":e,n),n),ar=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},v=(t,e,n)=>(ar(t,e,"read from private field"),n?n.call(t):e.get(t)),Y=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Q=(t,e,n,r)=>(ar(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),z=function(t,e){this[0]=t,this[1]=e},fe=(t,e,n)=>{var r=(o,s,u,l)=>{try{var d=n[o](s),p=(s=d.value)instanceof z,y=d.done;Promise.resolve(p?s[0]:s).then(m=>p?r(o==="return"?o:"next",s[1]?{done:m.done,value:m.value}:m,u,l):u({value:m,done:y})).catch(m=>r("throw",m,u,l))}catch(m){l(m)}},a=o=>i[o]=s=>new Promise((u,l)=>r(o,s,u,l)),i={};return n=n.apply(t,e),i[gt("asyncIterator")]=()=>i,a("next"),a("throw"),a("return"),i},V=(t,e,n)=>(e=t[gt("asyncIterator")])?e.call(t):(t=t[gt("iterator")](),e={},n=(r,a)=>(a=t[r])&&(e[r]=i=>new Promise((o,s,u)=>(i=a.call(t,i),u=i.done,Promise.resolve(i.value).then(l=>o({value:l,done:u}),s)))),n("next"),n("return"),e);const Gn=":host{display:flex;align-items:center;justify-content:center}";class zn extends HTMLElement{constructor(){var e,n;super(),c(this,"size"),c(this,"color"),this.size=(e=this.getAttribute("size"))!=null?e:"18px",this.color=(n=this.getAttribute("color"))!=null?n:"gray",this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=document.createElement("style");e.textContent=Gn,this.shadowRoot.appendChild(e)}render(){const e=this.shadowRoot,n='\n      width="'.concat(this.size,'"\n      height="').concat(this.size,'"\n      xmlns="http://www.w3.org/2000/svg"\n      aria-hidden="true"\n    ');e.innerHTML="\n      <svg ".concat(n,' viewBox="0 0 20 20" fill="').concat(this.color,'">\n        <path d="M17.1 4.3l-1.4-1.4-5.7 5.7-5.7-5.7-1.4 1.4 5.7 5.7-5.7 5.7 1.4 1.4 5.7-5.7 5.7 5.7 1.4-1.4-5.7-5.7z"/>\n      </svg>\n    ')}}const Vn="#overlay{position:fixed;width:100%;height:100%;background:#0006;top:0;left:0;z-index:2147483647;animation:modalPop .3s ease-out}#modal{position:fixed;top:20%;left:50%;width:100%;max-width:383px;transform:translate(-50%,-100%);background:#fff;color:#000;border-radius:5px;animation:modalSlideInFromTop .3s forwards}@keyframes modalPop{0%{opacity:0}to{opacity:1}}@keyframes modalSlideInFromTop{0%{transform:translate(-50%,-100%)}to{transform:translate(-50%)}}@keyframes modalSlideInFromBottom{0%{transform:translate(-50%,100%)}to{transform:translate(-50%)}}@media only screen and (max-width: 640px){#modal{top:auto;bottom:0;animation:modalSlideInFromBottom .3s forwards}}#modal footer{padding:0 21px 21px}#modal header{display:flex;justify-content:space-between;padding:21px 21px 16px}#title{font-size:21px;font-weight:600;line-height:25.2px;margin:0}#content{text-align:left;padding:0 21px 16px;overflow:auto;max-height:84vh}#modal #content p{margin:0;font-size:14px;line-height:21px}#close-icon,#close-button{cursor:pointer}#close-icon{min-width:24px;background:transparent;padding:0;border:none}#close-button{width:100%;padding:16px 21px;color:#fff;background-color:#1773b0;border:none;border-radius:5px;font-size:14px;line-height:21px;font-family:inherit}#close-button:hover,#close-button:active{background:#136f99}#close-button:active,#close-button:focus{box-shadow:0 0 0 4px #1990c640}";var xr=/^\s*at .*(\S+:\d+|\(native\))/m,qn=/^(eval@)?(\[native code])?$/;function jn(t){return t.stack?t.stack.match(xr)?Wn(t):Yn(t):[]}function Mr(t){if(t.indexOf(":")===-1)return[t];let e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));return[e[1],e[2]?Number(e[2]):void 0,e[3]?Number(e[3]):void 0]}function Wn(t){return t.stack.split("\n").filter(e=>!!e.match(xr)).map(e=>{let n=e.replace(/^\s+/,"").replace(/^.*?\s+/,""),r=n.match(/ (\(.+\)$)/);n=r?n.replace(r[0],""):n;let a=Mr(r?r[1]:n),i=r&&n||void 0,o=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return{method:i,file:o,lineNumber:a[1],columnNumber:a[2]}})}function Yn(t){return t.stack.split("\n").filter(e=>!e.match(qn)).map(e=>{if(e.indexOf("@")===-1&&e.indexOf(":")===-1)return{method:e};let n=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=e.match(n),a=r&&r[1]?r[1]:void 0,i=Mr(e.replace(n,""));return{method:a,file:i[0],lineNumber:i[1],columnNumber:i[2]}})}var ir="5",Kn=class{constructor(t){c(this,"breadcrumbs",[]),c(this,"apiKey"),c(this,"plugins"),c(this,"appId"),c(this,"appType"),c(this,"appVersion"),c(this,"releaseStage"),c(this,"locale"),c(this,"userAgent"),c(this,"metadata"),c(this,"persistedMetadata"),c(this,"onError"),c(this,"onPostErrorListeners",[]);var e;this.apiKey=t.apiKey,this.appType=t.appType,this.appId=t.appId,this.appVersion=t.appVersion,this.releaseStage=t.releaseStage,this.locale=t.locale,this.userAgent=t.userAgent,this.metadata=t.metadata,this.onError=t.onError,this.persistedMetadata={},this.plugins=(e=t.plugins)!=null?e:[],this.plugins.forEach(n=>n.load(this)),this.leaveBreadcrumb("Bugsnag started",void 0,"state")}addMetadata(t){for(let e of Object.keys(t))this.persistedMetadata[e]=t[e]}leaveBreadcrumb(t,e,n="manual"){this.breadcrumbs.push({name:t,metaData:e,type:n,timestamp:new Date().toISOString()})}notify(t,{errorClass:e,severity:n,severityType:r,handled:a=!0,metadata:i,context:o}={}){var s,u;let l=_(_(_({},this.metadata),this.persistedMetadata),i),d=this.buildBugsnagEvent({error:t,errorClass:e,severityType:r,handled:a,severity:n,metadata:l,context:o});if(((u=(s=this.onError)==null?void 0:s.call(this,d,t))==null||u)&&this.releaseStage!=="development"){let p=this.sendToBugsnag(d);return this.onPostErrorListeners.forEach(y=>y(d)),p}return Promise.resolve()}addOnPostError(t){this.onPostErrorListeners.push(t)}buildBugsnagEvent({error:t,errorClass:e,severity:n="error",severityType:r="handledException",handled:a,metadata:i={},context:o}){let s=new Date().toISOString(),{breadcrumbs:u,appId:l,appType:d,appVersion:p,releaseStage:y,locale:m,userAgent:C}=this;return{payloadVersion:ir,exceptions:[{errorClass:e!=null?e:t.name,stacktrace:Fr(l,t),message:t.message}],severity:n,severityReason:{type:r},unhandled:!a,app:{id:l,type:d,version:p,releaseStage:y},device:{time:s,locale:m,userAgent:C},breadcrumbs:u,context:o,metaData:i}}async sendToBugsnag(t){let{apiKey:e}=this,n={apiKey:e,notifier:{name:"Bugsnag JavaScript",version:"7.22.2",url:"https://github.com/bugsnag/bugsnag-js"},events:[t]};try{await fetch("https://notify.bugsnag.com/",{method:"POST",headers:{"Content-Type":"application/json","Bugsnag-Api-Key":e,"Bugsnag-Payload-Version":ir,"Bugsnag-Sent-At":t.device.time},body:JSON.stringify(n)})}catch(r){console.warn("[bugsnag-light] failed to send an event"),console.warn(r)}}};function Fr(t,e){return jn(e).map(n=>{var r,a,i,o;let s=(r=n.file)==null?void 0:r.includes(t);return{method:(a=n.method)!=null?a:"",file:(i=n.file)!=null?i:"",lineNumber:(o=n.lineNumber)!=null?o:0,columnNumber:n.columnNumber,inProject:s}})}function Jn(t){let e=window.onerror;window.onerror=(n,r,a,i,o)=>{o&&t.notify(o,{severityType:"unhandledException",handled:!1}),typeof e=="function"&&e.apply(window.onerror,[n,r,a,i,o])}}function Zn(t){window.addEventListener("unhandledrejection",({reason:e})=>{e&&t.notify(e,{severityType:"unhandledPromiseRejection",handled:!1})})}function Be(t){try{const e=new RegExp("(^| )".concat(t,"=([^;]+)")).exec(document.cookie);if(e){const n=e[2];try{return decodeURIComponent(n)}catch(r){return n}}return null}catch(e){return null}}const Pt={BRANDED_BUTTON:"shopify-payment-button__button shopify-payment-button__button--branded",UNBRANDED_BUTTON:"shopify-payment-button__button shopify-payment-button__button--unbranded",MORE_PAYMENT_OPTION_BUTTON:"shopify-payment-button__more-options",HIDDEN:"shopify-payment-button__button--hidden"},Qn={DARK:"apple-pay--dark",LIGHT:"apple-pay--light"},Xn=44,ea="_shopify_y",Ur=6,ta="discount_code",Gt="https://static-na.payments-amazon.com/checkout.js",ra={CURRENCY_CHANGE:"wallet_currency_change"},Ze="VALIDATION_CUSTOM",Br="portable-wallets",pe={BUTTON:"accelerated-checkout-button",BUTTON_ON_CART:"accelerated-checkout-button-cart",CONTAINER:"accelerated-checkout-button-container"};class De extends Error{constructor({code:e,message:n}){const r="An unexpected error happened likely because of customizations made to HTML/JavaScript on this site ".concat(n);super("[".concat(e,"]: ").concat(r)),c(this,"name","DeveloperError"),c(this,"code","unknown"),this.code=e}}class ze extends Error{constructor({message:e}){super(e),c(this,"name","SilencedError")}}class na extends Error{constructor(){super(...arguments),c(this,"name","MissingConfigError")}}const aa=["Load failed","Failed to fetch","when attempting to fetch resource"],ia=["Chrome-Lighthouse"],Dt={};function oa(t,e){if(!t.exceptions[0])return!1;sa(t);try{return la(t,e)}catch(n){const r=n;console.error(r);const a={errorClass:"UnfilterableError",message:"Could not properly filter error with message: ".concat(r.message),stacktrace:Fr(Br,r)};return t.exceptions.unshift(a),!0}}function sa(t){var e,n;t.context=window.location.pathname,t.request||(t.request={}),t.request.url=window.location.href,t.device.orientation=(n=(e=window.screen)==null?void 0:e.orientation)==null?void 0:n.type,t.metaData=_(_({},Dt),t.metaData);const r=t.exceptions[0].stacktrace[0];r&&!r.inProject&&t.unhandled&&(t.severity="warning")}function la(t,e){var n,r,a,i;if(ia.some(s=>navigator.userAgent.includes(s)))return!1;const o=t.exceptions[0];return aa.some(s=>{var u,l;return(l=(u=o.message)==null?void 0:u.includes(s))!=null?l:!1})?!1:e instanceof De?(console.error(e),!1):o.errorClass===ze.name||(n=o.message)!=null&&n.includes("Component closed")||o.stacktrace.some(s=>{var u;return(u=s.file)==null?void 0:u.includes("spin.dev")})||o.errorClass==="OpenTelemetryClientError"&&((r=o.message)!=null&&r.match(/Server responded with ([45]\d\d|undefined)/)||(a=o.message)!=null&&a.includes("error found in #10 byte"))||(i=o.message)!=null&&i.includes("GraphQL mutation failed with status 404")?!1:o.stacktrace.some(s=>!!(s!=null&&s.inProject))}var Or;const ca={apiKey:"cb577dc231be1c7494db8a63441ef66b",appId:Br,appVersion:"0.0.0-d40ac5f95930806bfd88643b084c0780f6dfeef6",releaseStage:"canary",locale:"de",userAgent:navigator.userAgent,metadata:{user:{id:(Or=Be(ea))!=null?Or:"unknown"}},onError:oa},w=new Kn(ca);function zt(t){for(const[e,n]of Object.entries(t))Dt[e]=_(_({},Dt[e]),n)}var da={de:{instruments_copy:{checkout:{buy_now:"Jetzt zum Checkout"}},error_dialogs:{checkout:{title:"Transaktion fehlgeschlagen",generic_error:"Checkout ist derzeit aufgrund technischer Probleme nicht verf\xFCgbar. Bitte versuche es in ein paar Minuten noch einmal.",button_text:"Schlie\xDFen"},wallet:{title:"%{wallet} nicht verf\xFCgbar",generic_error:"Es ist ein Problem mit %{wallet} aufgetreten. Versuche es erneut oder verwende eine andere Zahlungsmethode.",buy_with_prime:{empty_line_items:{title:"Buy with Prime ist nicht mehr verf\xFCgbar.",content:"Artikel, die f\xFCr Buy with Prime berechtigt waren, befinden sich nicht mehr in deinem Warenkorb."}}},product:{out_of_stock:"Dieser Artikel ist nicht mehr lieferbar."}},more_payment_options:"Weitere Bezahlm\xF6glichkeiten",brand:{apple_pay:"Apple Pay",amazon_pay:"Amazon Pay",shop_pay:"Shop Pay",buy_with_prime:"Buy with Prime",paypal:"PayPal",google_pay:"Google Pay"},buy_with_button_content:"Mit\xA0%{wallet}\xA0kaufen'",order_summary:{total:"Gesamtsumme",subtotal:"Zwischensumme",duties:"Zollgeb\xFChren",taxes:"Steuern",shipping:"Versand",discount:"Rabatt",shipping_one_time_purchase:"Versand (einmaliger Kauf)",shipping_subscription:"Versand (Abonnement)",subscriptions:{recurring_total_tooltip_line:"Beinhaltet keine Versandkosten, Steuern, Zollgeb\xFChren oder anwendbaren Rabatte",recurring_totals:"%{fixedPrice} jede/n/s %{interval}",recurring_totals_with_policies:{one:"Die erste Zahlung betr\xE4gt %{fixedPrice}, danach %{recurringPrice} alle %{interval}",other:"Die ersten %{count} Zahlungen betragen jeweils %{fixedPrice}, danach %{recurringPrice} alle %{interval}"},recurring_total_intervals:{day:{one:"Tag",other:"%{count}\xA0Tage"},month:{one:"Monat",other:"%{count}\xA0Monate"},week:{one:"Woche",other:"%{count}\xA0Wochen"},year:{one:"Jahr",other:"%{count}\xA0Jahre"}}}},errors:{missing:{address2:"Gib eine Wohnung, ein Zimmer usw. ein",phone:"Gib eine Telefonnummer ein",first_name:"Gib einen Vornamen ein",email:"Gib eine E-Mail-Adresse ein.",last_name:"Gib einen Nachnamen ein",address1:"Gib eine Adresse ein",city:"Gib eine Stadt ein",zone:"W\xE4hle ein Bundesland/eine Provinz aus",postal_code:"Gib eine Postleitzahl ein",shipping_option:"Eine Versandart ausw\xE4hlen"},invalid:{email:"Gib eine g\xFCltige E-Mail-Adresse ein",country:"W\xE4hle ein Land / eine Region aus",phone:"Eine g\xFCltige Telefonnummer eingeben",first_name:"Gib einen g\xFCltigen Vornamen ein",last_name:"Gib einen g\xFCltigen Nachnamen ein",address1:"Gib eine g\xFCltige Adresse ein",address2:"Gib eine g\xFCltige Wohnung, ein g\xFCltiges Zimmer usw. ein",city:"Eine g\xFCltige Stadt eingeben",zone:"Ein g\xFCltiges Bundesland / eine g\xFCltige Provinz ausw\xE4hlen",postal_code:"Gib eine g\xFCltige Postleitzahl ein",billing_address:"Ung\xFCltige Rechnungsadresse",shipping_address:"Ung\xFCltige Lieferadresse",payment_method:"Ung\xFCltige Zahlungsmethode"},emojis:{first_name:"Vorname darf keine Emojis enthalten",last_name:"Nachname darf keine Emojis enthalten",city:"Stadt darf keine Emojis enthalten",address1:"Adresszeile darf keine Emojis enthalten",address2:"Zweite Adresszeile darf keine Emojis enthalten",postal_code:"Postleitzahl darf keine Emojis enthalten"},too_long:{address1:"Adresszeile ist zu lang",address2:"Zweite Adresszeile ist zu lang",first_name:"Vorname ist zu lang",last_name:"Nachname ist zu lang",city:"Stadt ist zu lang"},url:{first_name:"Vorname darf keine URL enthalten",last_name:"Nachname darf keine URL enthalten"},html_tags:{first_name:"Der Vorname darf keine HTML-Tags enthalten",last_name:"Der Nachname darf keine HTML-Tags enthalten",city:"Stadt darf keine HTML-Tags enthalten",address1:"Adresszeile darf keine HTML-Tags enthalten",address2:"Zweite Adresszeile darf keine HTML-Tags enthalten"},currency:{mismatch:"Dein Warenkorb und deine W\xE4hrung wurden anhand deines Versandlands aktualisiert."},address_unserviceable:"%{shopName} liefert derzeit nicht an diese Adresse. Verwende eine andere Adresse, um deinen Kauf abzuschlie\xDFen."},subscriptions:{buyer_consent:"Ein oder mehrere Artikel in deinem Warenkorb ist/sind ein wiederkehrender Kauf oder ein Kauf mit Zahlungsaufschub. Durch das Fortfahren stimme ich der %{subscriptionPolicyLink} zu und autorisiere die Belastung meiner Zahlungsmethode zu den auf dieser Seite angegebenen Preisen, H\xE4ufigkeiten und Daten, bis meine Bestellung ausgef\xFChrt wurde oder bis ich die Bestellung, sofern m\xF6glich, storniere.",cancellation_policy:"Stornierungsrichtlinie",subscription_policy:"Abonnement-Richtlinie",policy_not_found:"Die Abonnement-Richtlinie konnte nicht gefunden werden. Aktualisiere die Seite oder kontaktiere uns, um weitere Informationen zu erhalten."},shipping_methods:{connect_shipping_methods:"%{methodOne} und %{methodTwo}",choose_delivery_strategy:"Eine Zustellmethode ausw\xE4hlen"},shop_promise_delivery:{same_day:"Zustellung am selben Tag",next_day:"Zustellung am n\xE4chsten Tag",two_day:"2-Tages-Zustellung"},action:{view:"%{content} anzeigen"}}};let bt;class or extends Error{constructor(e,n){const r="i18n: Missing or invalid translation '".concat(e,"' in '").concat(n,"'");super(r)}}class ua extends Error{constructor(e,n,r){const a="i18n: Missing translation template key '".concat(e,"' for '").concat(n,"' in '").concat(r,"'");super(a)}}class ha extends Error{constructor(e,n,r){const a="i18n: Invalid pluralization for '".concat(e,"':'").concat(n,"' in '").concat(r,"'");super(a)}}function it(){return bt==null&&(bt=pa(da)),bt}function pa(t){const e=(i,o)=>typeof i!="string"&&o.count!=="undefined",n=(i,o)=>{let s=o===1?"one":"other";return o===0&&typeof i!="string"&&i.zero!=="undefined"&&(s="zero"),s},r=(i,o={})=>{const s=i.match(/%\{.+?\}/g);return s?s.reduce((u,l)=>{const d=l.replace(/%\{(.*)\}/,"$1");return o[d]?u.replace(l,o[d]):(w.notify(new ua(d,i,a)),u)},i):i},a=ma();return{locale:a,translate(i,o={}){var s;const u=i.split(".");let l=t[a];try{for(const d of u)switch(typeof l){case"object":l=l[d];break;case"string":case"undefined":throw new or(i,a)}if(e(l,o)){if(typeof l=="string")throw new ha(i,l,a);l=l[n(l,o.count)]}if(typeof l!="string")throw new or(i,a);return r(l,o)}catch(d){return w.notify(d),(s=o.defaultValue)!=null?s:i}}}}function ma(){return"de"}var b=(t=>(t.BuyItNow="BuyItNow",t.MoreOptions="MoreOptions",t.ApplePay="ApplePay",t.PayPal="PayPal",t.Venmo="Venmo",t.GooglePay="GooglePay",t.ShopPay="ShopPay",t.MetaPay="FacebookPay",t.BuyWithPrime="BuyWithPrime",t.AmazonPay="AmazonPay",t.Unknown="Unknown",t))(b||{}),S=(t=>(t.CartPage="cart_page",t.CartAjax="cart_ajax",t.ProductPage="product",t.Checkout="checkout",t.Unknown="unknown",t))(S||{}),xe=(t=>(t.CartChange="/cart/change",t.CartUpdate="/cart/update",t.CartAdd="/cart/add",t.CartClear="/cart/clear",t))(xe||{}),$e=(t=>(t.OneTimePurchase="ONE_TIME_PURCHASE",t.Subscription="SUBSCRIPTION",t))($e||{});function ya(t){const e=document.querySelectorAll("accelerated-checkout .shopify-payment-button__skeleton, accelerated-checkout-cart .wallet-cart-button__skeleton");for(let n=0;n<e.length;n++)e[n].remove()}function $r(t){!(t instanceof ErrorEvent)||!(typeof t.message=="string"&&t.message.includes("import.meta"))||!(typeof t.filename=="string"&&t.filename.includes("portable-wallets"))||(window.removeEventListener("error",$r),window.Shopify.PaymentButton.failedToLoad=t,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",window.Shopify.PaymentButton.init):window.Shopify.PaymentButton.init())}window.addEventListener("error",$r);function E(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var ga=0;function me(t){return"__private_"+ga+++"_"+t}function ot(t){return Object.entries(t).map(([e,n])=>({key:e,value:{stringValue:String(n)}}))}function fa(t){return Object.entries(t).map(([e,n])=>({key:e,value:ba(n)}))}function ba(t){switch(typeof t){case"boolean":return{boolValue:!!t};case"number":return Number.isInteger(t)?{intValue:Number(t)}:{doubleValue:Number(t)};case"string":default:return{stringValue:String(t)}}}const Vt=1,wa=Aa(5,2,12);function Aa(t,e,n){const r=[0];for(let a=0;a<n;a++){const i=Math.floor(t*e**a);r.push(i)}return r}var ie=me("exporter"),$=me("attributes"),x=me("metrics"),oe=me("logs");class _a{constructor({exporter:e,attributes:n}){Object.defineProperty(this,ie,{writable:!0,value:void 0}),Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:[]}),Object.defineProperty(this,oe,{writable:!0,value:[]}),E(this,ie)[ie]=e,E(this,$)[$]=n!=null?n:{}}addAttributes(e){E(this,$)[$]=_(_({},E(this,$)[$]),e)}histogram({name:e,value:n,unit:r,bounds:a,attributes:i,scale:o}){const s=Date.now()*1e6;a?E(this,x)[x].push({name:e,type:"histogram",value:n,unit:r,timeUnixNano:s,attributes:i,bounds:a}):E(this,x)[x].push({name:e,type:"exponential_histogram",value:n,unit:r,timeUnixNano:s,attributes:i,scale:o})}counter({name:e,value:n,unit:r,attributes:a}){const i=Date.now()*1e6;E(this,x)[x].push({name:e,type:"counter",value:n,unit:r,timeUnixNano:i,attributes:a})}gauge({name:e,value:n,unit:r,attributes:a}){const i=Date.now()*1e6;E(this,x)[x].push({name:e,type:"gauge",value:n,unit:r,timeUnixNano:i,attributes:a})}log({body:e,attributes:n}){const r=Date.now()*1e6;E(this,oe)[oe].push({timeUnixNano:r,body:e,attributes:n})}async exportMetrics(){const e={};E(this,x)[x].forEach(r=>{switch(r.attributes=_(_({},E(this,$)[$]),r.attributes),r.type){case"histogram":Ca(e,r);break;case"exponential_histogram":Sa(e,r);break;case"counter":Ea(e,r);break;case"gauge":Ia(e,r);break}});const n=Object.values(e);n.length!==0&&(E(this,x)[x]=[],await E(this,ie)[ie].exportMetrics(n))}async exportLogs(){const e=E(this,oe)[oe].map(n=>{const r={timeUnixNano:n.timeUnixNano,observedTimeUnixNano:n.timeUnixNano,attributes:fa(_(_({},E(this,$)[$]),n.attributes))};return n.body&&(r.body={stringValue:n.body}),r});e.length!==0&&(E(this,oe)[oe]=[],await E(this,ie)[ie].exportLogs(e))}}function Ca(t,e){var n;const{name:r,value:a,unit:i,timeUnixNano:o,attributes:s}=e,u=(n=e.bounds)!==null&&n!==void 0?n:wa,l=new Array(u.length+1).fill(0);t[r]||(t[r]={name:r,unit:i||"1",histogram:{aggregationTemporality:Vt,dataPoints:[]}});for(let d=0;d<l.length;d++){const p=u[d];if(p===void 0)l[d]=1;else if(a<=p){l[d]=1;break}}t[r].histogram.dataPoints.push({startTimeUnixNano:o,timeUnixNano:o,count:1,sum:a,min:a,max:a,bucketCounts:l,explicitBounds:u,attributes:ot(s!=null?s:{})})}function Sa(t,e){const{name:n,value:r,unit:a,timeUnixNano:i,attributes:o,scale:s}=e;t[n]||(t[n]={name:n,unit:a||"1",exponentialHistogram:{aggregationTemporality:Vt,dataPoints:[]}});const u=r<=0?0:r,l=s||3,d=2**l/Math.log(2),p=Math.ceil(Math.log(r)*d)-1,y=r<=0?1:0,m={offset:0,bucketCounts:[]},C={offset:r>0?p:0,bucketCounts:r>0?[1]:[]};t[n].exponentialHistogram.dataPoints.push({attributes:ot(o!=null?o:{}),startTimeUnixNano:i,timeUnixNano:i,count:1,sum:u,scale:l,zeroCount:y,positive:C,negative:m,min:u,max:u,zeroThreshold:0})}function Ea(t,e){const{name:n,value:r,unit:a,timeUnixNano:i,attributes:o}=e;t[n]||(t[n]={name:n,unit:a||"1",sum:{aggregationTemporality:Vt,isMonotonic:!0,dataPoints:[]}}),t[n].sum.dataPoints.push({startTimeUnixNano:i,timeUnixNano:i,asDouble:r,attributes:ot(o!=null?o:{})})}function Ia(t,e){const{name:n,value:r,unit:a,timeUnixNano:i,attributes:o}=e;t[n]||(t[n]={name:n,unit:a||"1",gauge:{dataPoints:[]}}),t[n].gauge.dataPoints.push({startTimeUnixNano:i,timeUnixNano:i,asDouble:r,attributes:ot(o!=null?o:{})})}var ke=me("url"),se=me("serviceName"),Le=me("logger");class va{constructor(e,n,r){Object.defineProperty(this,ke,{writable:!0,value:void 0}),Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,Le,{writable:!0,value:void 0}),E(this,ke)[ke]=e.replace(/\/v1\/(logs|metrics|traces)\/?$/,""),E(this,se)[se]=n,E(this,Le)[Le]=r==null?void 0:r.logger}async exportMetrics(e){const n={resourceMetrics:[{resource:{attributes:[{key:"service.name",value:{stringValue:E(this,se)[se]}}]},scopeMetrics:[{scope:{name:"open-telemetry-mini-client",version:"1.1.0",attributes:[]},metrics:e}]}]};await this.exportTo(n,"/v1/metrics")}async exportLogs(e){const n={resourceLogs:[{resource:{attributes:[{key:"service.name",value:{stringValue:E(this,se)[se]}}]},scopeLogs:[{scope:{name:"open-telemetry-mini-client",version:"1.1.0",attributes:[]},logRecords:e}]}]};await this.exportTo(n,"/v1/logs")}async exportTo(e,n){var r;const a=await fetch("".concat(E(this,ke)[ke]).concat(n),{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if((r=E(this,Le)[Le])===null||r===void 0||r.log({status:a.status}),!a.ok){if(a.status===400){const i=await a.text();throw new Ke("Invalid OpenTelemetry Data: ".concat(i))}if(a.status===429||a.status===503){const i=await a.json(),o=a.headers.get("Retry-After"),s=o?{seconds:Number(o)}:void 0;throw new Ke("Server did not accept data",{errorData:i,retryAfter:s,body:e})}throw new Ke("Server responded with ".concat(a.status))}}}class Ke extends Error{constructor(e,n){super(e),this.metadata=void 0,this.name="OpenTelemetryClientError",this.metadata=n}}const Pa="https://otlp-http-production.shopifysvc.com/v1/metrics",Da="portable_wallets";class Na{constructor(e){this.exporter=e}async exportMetrics(e){var n;try{await this.exporter.exportMetrics(e)}catch(r){if(r instanceof Ke){const a=(n=r.metadata)==null?void 0:n.retryAfter;if(a){await new Promise(i=>{setTimeout(()=>{this.exportMetrics(e),i()},a.seconds*1e3)});return}}throw r}}async exportLogs(){}}const Ta=new va(Pa,Da),Ra=new Na(Ta),P=new _a({exporter:Ra}),Me=[];function G(t,e,n){if(window.customElements!=null)try{const r=e;window.customElements.get(t)||(window.customElements.define(t,r),n!=null&&n.isChildCustomElement&&Me.push(t))}catch(r){w.notify(r),ya()}}function Qe(){const t=new URLSearchParams(window.location.search);return function(e){return!!t.get(e)}}function ka(){var t,e,n,r;const a=(t=window.Shopify)==null?void 0:t.CartType;if(a===S.CartAjax)return S.CartAjax;if(a===S.CartPage)return S.CartPage;const i=(r=(n=(e=window.ShopifyAnalytics)==null?void 0:e.meta)==null?void 0:n.page)==null?void 0:r.pageType;if(i)switch(i.toLowerCase()){case"product":return S.ProductPage;case"cart":return S.CartPage}const o=document.querySelector("#shop-js-analytics");if(o)try{const s=JSON.parse(o.textContent||"{}");if(s.pageType)switch(s.pageType.toLowerCase()){case"product":return S.ProductPage;case"cart":return S.CartPage}}catch(s){console.error("Error parsing JSON script tag:",s)}return S.Unknown}function ue(t){return Number(t).toFixed(2)}function st(t){if(!(!t||!t.id||!t.id.includes("gid://shopify/Cart/")))return t.id.replace("gid://shopify/Cart/","").split("?")[0]}function W(){let t;return[new Promise(e=>t=e),t]}const La={force_shop_pay_product:"direct_checkout_product",force_shop_pay_cart:"direct_checkout_cart"};function ee(t,e="no_redirect_for_checkout"){P.exportMetrics();const n=new URL(t);switch(e){case"skip_shop_pay":n.searchParams.set("skip_shop_pay","true");break;case"no_redirect_for_checkout":n.searchParams.set("storefront_wallet","true");break;case"force_shop_pay_cart":case"force_shop_pay_product":case"force_shop_pay":{n.searchParams.set("payment","shop_pay");const r=La[e];r&&n.searchParams.set("redirect_source",r);break}}window.location.assign(n.toString())}function Hr(){return!!document.querySelector('[data-source-attribution="shopify.shop-promise-pdp"]')}class Oa extends HTMLElement{constructor(){super(),c(this,"overflow"),c(this,"formerFocus"),this.attachShadow({mode:"open"}),this.overflow="",this.formerFocus=document.activeElement}connectedCallback(){const e=it();this.render(e);const n=this.shadowRoot,r=n.getElementById("modal");n.querySelectorAll("button").forEach(o=>o.addEventListener("click",this.closeModal.bind(this)));const a=n.getElementById("overlay");a==null||a.addEventListener("click",o=>this.handleOutsideClick(o,r)),document.addEventListener("keydown",this.handleEscapeKey.bind(this));const i=document.createElement("style");i.textContent=Vn,n.appendChild(i),this.overflow=document.body.style.overflow,document.body.style.overflow="hidden",this.trapFocus(r,n),G("svg-icon",zn)}trapFocus(e,n){if(!e)return;const r=e.querySelectorAll("a[href], button"),a=Array.from(r),i=a[0],o=a[a.length-1];e.addEventListener("keydown",s=>{s.key==="Tab"&&!s.shiftKey&&n.activeElement===o&&(s.preventDefault(),i.focus()),s.key==="Tab"&&s.shiftKey&&n.activeElement===i&&(s.preventDefault(),o.focus())}),i.focus()}handleOutsideClick(e,n){n&&(n.contains(e.target)||this.closeModal())}handleEscapeKey(e){e.key==="Escape"&&this.closeModal()}closeModal(){var e;document.body.style.overflow=this.overflow,this.remove(),this.formerFocus&&"focus"in(this==null?void 0:this.formerFocus)&&typeof this.formerFocus.focus=="function"&&((e=this.formerFocus)==null||e.focus())}render(e){const n=this.getAttribute("title"),r=this.getAttribute("has-close-button"),a=e.translate("error_dialogs.checkout.button_text"),i='\n      <footer>\n        <button type="button" id="close-button" tabindex="0">'.concat(a,"</button>\n      </footer>\n    ");this.shadowRoot.innerHTML='\n      <div id="overlay">\n        <div id="modal" role="dialog" aria-modal="true" aria-labelledby="title">\n          <header>\n            <h2 id="title">\n              '.concat(n,'\n            </h2>\n            <button type="button" id="close-icon" aria-label=').concat(a,' tabindex="0">\n              <svg-icon color="gray"></svg-icon>\n            </button>\n          </header>\n          <div id="content">\n            <p><slot></slot></p>\n          </div>\n          ').concat(r?i:"","\n        </div>\n      </div>\n    ")}}function Ve({type:t="button",label:e=void 0}={}){const n=document.createElement("button");return n.type=t,e&&n.setAttribute("aria-label",e),n}function lt(t,e){for(const[n,r]of Object.entries(e))t.setAttribute(n,r)}function sr(t,e){for(const[n,r]of Object.entries(e))t.style.setProperty(n,r)}function ye(t,e){const n=document.createElement("top-level-modal");n.textContent=e,lt(n,{"data-testid":"top-level-modal","has-close-button":"true",title:t}),document.body.appendChild(n)}function qt(t,e){const n=document.createElement("top-level-modal");n.innerHTML=e,lt(n,{"data-testid":"top-level-modal",title:t}),document.body.appendChild(n)}function te(t){ye(t.translate("error_dialogs.checkout.title"),t.translate("error_dialogs.product.out_of_stock"))}function K(t,e){ye(e.translate("error_dialogs.wallet.title",{wallet:t}),e.translate("error_dialogs.wallet.generic_error",{wallet:t}))}G("top-level-modal",Oa);class ct extends HTMLElement{get buyerCountry(){return this.getAttribute("buyer-country")}get recommendedInstrument(){return this.getAttribute("recommended-instrument")}get buyerCurrency(){const e=this.getAttribute("buyer-currency");if(e==null)throw new Error("WalletElement buyer-currency is null");return e}get accessToken(){return this.getAttribute("access-token")}get disabled(){return this.hasAttribute("disabled")}set disabled(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get hasSellingPlan(){const e=this.getAttribute("has-selling-plan");return e==="true"||e===""}set hasSellingPlan(e){e?this.setAttribute("has-selling-plan",""):this.removeAttribute("has-selling-plan")}get isShippingRequired(){const e=this.getAttribute("requires-shipping");return e==="true"||e===""}set isShippingRequired(e){e?this.setAttribute("requires-shipping",""):this.removeAttribute("requires-shipping")}}const xa="#more-payment-options-link{cursor:pointer}",Ma="https://monorail-edge.shopifysvc.com",Fa="/v1/produce";function Ua(){if(typeof crypto<"u"&&crypto&&typeof crypto.randomUUID=="function")return crypto.randomUUID();const t=new Array(36);for(let e=0;e<36;e++)t[e]=Math.floor(Math.random()*16);return t[14]=4,t[19]=t[19]&=-5,t[19]=t[19]|=8,t[8]=t[13]=t[18]=t[23]="-",t.map(e=>e.toString(16)).join("")}function Ba(t){const e={"Content-Type":"application/json; charset=utf-8","X-Monorail-Edge-Event-Created-At-Ms":(t&&t.eventCreatedAtMs||Date.now()).toString(),"X-Monorail-Edge-Event-Sent-At-Ms":Date.now().toString(),"X-Monorail-Edge-Client-Message-Id":(t&&t.clientMessageId||Ua()).toString()};return t&&t.userAgent&&(e["User-Agent"]=t.userAgent),t&&t.remoteIp&&(e["X-Forwarded-For"]=t.remoteIp),e}async function $a({endpoint:t,event:e,keepalive:n}){return fetch(t!=null?t:Ma+Fa,{method:"post",headers:Ba(e.metadata),body:JSON.stringify({schema_id:e.schemaId,payload:e.payload}),keepalive:n})}var R=(t=>(t.Decelerated="portable_wallets_decelerated",t.InitCompleted="portable_wallets_init_completed",t.InstrumentLoadEligibility="portable_wallets_instrument_load_eligibility",t.InstrumentLoadTime="portable_wallets_instrument_load_time",t.InstrumentLoadTimeFromPageLoad="portable_wallets_instrument_load_time_from_page_load",t.MonorailProduceError="portable_wallets_monorail_produce_error",t.SheetClicked="portable_wallets_sheet_clicked",t.SheetCancelled="portable_wallets_sheet_cancelled",t.SheetFailed="portable_wallets_sheet_failed",t.AuthorizationAttempt="portable_wallets_authorization_attempt",t.AuthorizationComplete="portable_wallets_authorization_complete",t.CartTokenMissing="portable_wallets_cart_token_missing",t.GooglePayNotEligibleWebview="portable_wallets_google_pay_not_eligible_webview",t.WalletConfigDeveloperError="portable_wallets_wallet_config_developer_error",t.LegacyCartCookie="portable_wallets_legacy_cart_cookie",t))(R||{}),he=(t=>(t.InstrumentSdkLoaded="portable_wallets_instrument_sdk_loaded",t.InstrumentSdkFailed="portable_wallets_instrument_sdk_failed",t.InstrumentSdkEligible="portable_wallets_instrument_sdk_eligible",t.InstrumentSdkNotEligible="portable_wallets_instrument_sdk_not_eligible",t))(he||{});const Ha=["Chrome-Lighthouse"];function Ga(){const t=navigator.userAgent;return Ha.some(e=>t.includes(e))}async function za(t){if(Ga())return;w.leaveBreadcrumb("monorail event produced to ".concat(t.schemaId),t);let e;try{e=await $a({event:t})}catch(n){}if(!(e!=null&&e.ok))try{P.counter({name:R.MonorailProduceError,value:1,attributes:{schemaId:t.schemaId}})}catch(n){}}const lr="shopify_wallet_checkout_track/6.2";async function U(t){var e,n,r,a,i,o,s;let u=null;try{const l=await Va();if(u={schemaId:lr,payload:{app_name:"storefront",page_type:ka(),checkout_one:!0,event:t.event,event_subtype:t.eventSubtype,checkout_token:t.checkoutToken,instrument_id:t.instrumentId,ttl:t.ttl,error_reason:t.errorReason,uniq_token:(e=l==null?void 0:l.uniqToken)!=null?e:"",visit_token:(n=l==null?void 0:l.visitToken)!=null?n:"",micro_session_id:(r=l==null?void 0:l.microSessionId)!=null?r:"",micro_session_count:(a=l==null?void 0:l.microSessionCount)!=null?a:0,shop_id:(i=l==null?void 0:l.shopId)!=null?i:0,theme_id:l==null?void 0:l.themeId,theme_city_hash:(o=l==null?void 0:l.themeCityHash)!=null?o:"",content_language:(s=l==null?void 0:l.contentLanguage)!=null?s:"",referer:l==null?void 0:l.referer}},!(t!=null&&t.event)){w.notify(new Error("Event is required"),{metadata:{request:{monorail:{schemaId:lr,payload:JSON.stringify(u)}}}});return}await za(u)}catch(l){w.notify(new Error("Failed to send monorail event: ".concat(l)),{metadata:{request:{monorail:{payload:JSON.stringify(u!=null?u:t)}}}})}}async function Va(){var t,e,n,r,a;return(e=(t=window==null?void 0:window.ShopifyAnalytics)==null?void 0:t.lib)!=null&&e.trekkie||await new Promise(i=>{const o=setInterval(()=>{var u,l;(l=(u=window==null?void 0:window.ShopifyAnalytics)==null?void 0:u.lib)!=null&&l.trekkie&&(clearInterval(o),i())},100),s=setTimeout(()=>{clearInterval(o),clearTimeout(s),i()},7e3)}),(a=(r=(n=window.ShopifyAnalytics)==null?void 0:n.lib)==null?void 0:r.trekkie)==null?void 0:a.defaultAttributes}var L=(t=>(t.CartInitCalled="portable_wallets_cart_init_called",t.ClickSheetCancelled="portable_wallets_instrument_click_sheet_cancelled",t.ClickSheetFailed="portable_wallets_instrument_click_sheet_failure",t.ClickSheetSuccess="portable_wallets_instrument_click_sheet_success",t.SheetFailed="portable_wallets_instrument_sheet_failed",t.AuthorizationAttempt="portable_wallets_authorization_attempt",t.AuthorizationComplete="portable_wallets_authorization_complete",t.InitCalled="portable_wallets_init_called",t.InitFailed="portable_wallets_init_failed",t.InitSuccess="portable_wallets_init_success",t.UpdateFailed="portable_wallets_instrument_update_failed",t.InstrumentLoaded="portable_wallets_instrument_loaded",t.InstrumentLoadFailed="portable_wallets_instrument_load_failed",t))(L||{});const cr={[S.Checkout]:"bwp_checkout_widget_click",[S.CartAjax]:"bwp_cart_widget_click",[S.CartPage]:"bwp_cart_widget_click",[S.ProductPage]:"bwp_widget_click",[S.Unknown]:"bwp_widget_click"};function qa({apiClientId:t,skus:e,pageType:n}){var r;if(!((r=window.Shopify)!=null&&r.analytics))return;const a=n&&cr[n]||"bwp_widget_click";a===cr[S.Checkout]&&window.Shopify.analytics.publish("shopify:app:pixels:load:".concat(t),{},{sendTo:"PIXEL-LOADER"}),window.Shopify.analytics.publish(a,{skus:e},{sendTo:t})}function ja(){U({event:L.InitCalled})}function Wa(t){var e,n;const r="error"in t?"failed":t.result,a="error"in t&&ci(t.error)?"[".concat(t.error.name,"]: ").concat(t.error.code):"eventType"in t&&t.eventType||void 0;U({event:r==="success"?L.InitSuccess:L.InitFailed,eventSubtype:a}),P.counter({name:R.InitCompleted,value:1,attributes:{result:r,eventType:a,recoveredFailure:!!((n=(e=window.Shopify)==null?void 0:e.PaymentButton)!=null&&n.failedToLoad)}})}function Ya({instrumentOrComponentName:t,result:e,measurement:n}){U({event:e==="success"?L.InstrumentLoaded:L.InstrumentLoadFailed,instrumentId:t,ttl:n}),n!=null&&(P.histogram({name:R.InstrumentLoadTime,value:n,attributes:{instrument:t},unit:"ms"}),P.histogram({name:R.InstrumentLoadTimeFromPageLoad,value:window.performance.now(),attributes:{instrument:t},unit:"ms"}))}function Ka({instrument:t,measurement:e,result:n}){const r=n==="success"?he.InstrumentSdkLoaded:he.InstrumentSdkFailed;U({event:r,instrumentId:t,ttl:e,errorReason:n==="success"?void 0:n}),e!=null&&P.histogram({name:he.InstrumentSdkLoaded,value:e,attributes:{instrument:t,result:n},unit:"ms"})}function Ja({instrument:t,result:e,reason:n}){const r=e==="success"?he.InstrumentSdkEligible:he.InstrumentSdkNotEligible;U({event:r,instrumentId:t}),P.counter({name:he.InstrumentSdkEligible,value:1,attributes:{instrument:t,reason:n,result:e}})}function Za({instrument:t,result:e,reason:n}){P.counter({name:R.InstrumentLoadEligibility,value:1,attributes:{instrument:t,result:e,reason:n}})}function Qa({instrument:t,result:e,checkoutToken:n,webPixelMetaData:r}){U({event:e==="success"?L.ClickSheetSuccess:L.ClickSheetFailed,checkoutToken:n,instrumentId:t}),P.counter({name:R.SheetClicked,value:1,attributes:{instrument:t,result:e}}),t===b.BuyWithPrime&&r&&qa(r)}function Xa(t,e){U({event:"".concat(L.UpdateFailed,"-").concat(e),instrumentId:t})}function ei(t){U({event:L.ClickSheetCancelled,instrumentId:t}),P.counter({name:R.SheetCancelled,value:1,attributes:{instrument:t}})}function ti(t,e){U({event:L.SheetFailed,instrumentId:t,errorReason:e==null?void 0:e.message}),P.counter({name:R.SheetFailed,value:1,attributes:{instrument:t}})}function ri(t){U({event:L.AuthorizationAttempt,instrumentId:t}),P.counter({name:R.AuthorizationAttempt,value:1,attributes:{instrument:t}})}function ni({instrument:t,measurement:e,result:n}){U({event:L.AuthorizationComplete,eventSubtype:n,ttl:e,instrumentId:t}),e!=null&&P.histogram({name:R.AuthorizationComplete,value:e,attributes:{instrument:t,result:n},unit:"ms"})}function ai({instrument:t,reason:e}){P.counter({name:R.Decelerated,value:1,attributes:{instrument:t,reason:e}}),P.exportMetrics()}function ii({reason:t}){P.counter({name:R.CartTokenMissing,value:1,attributes:{reason:t}})}function oi(){P.counter({name:R.WalletConfigDeveloperError,value:1})}function si(){P.counter({name:R.LegacyCartCookie,value:1})}function li(){window.setInterval(()=>{P.exportMetrics()},1e3)}function ci(t){return(t==null?void 0:t.name)===De.name}const g={initStarted:N(ja),initCompleted:N(Wa),instrumentLoaded:N(Ya),instrumentLoadEligibility:N(Za),instrumentSDKLoaded:N(Ka),instrumentSDKEligible:N(Ja),sheetClicked:N(Qa),sheetCancelled:N(ei),sheetFailed:N(ti),updateFailed:N(Xa),authorizationAttempt:N(ri),authorizationComplete:N(ni),startExporter:N(li),decelerated:N(ai),cartTokenMissing:N(ii),walletConfigDeveloperError:N(oi),legacyCartCookie:N(si)};function N(t){return(...e)=>{try{t(...e)}catch(n){w.notify(n)}}}function re(t){const e=t===b.MetaPay?"MetaPay":t,n=new CustomEvent("acceleratedCheckoutStarted",{detail:{acceleratedCheckoutName:e}});document.dispatchEvent(n)}function di(t){const e=n=>{n.persisted&&(t(),window.removeEventListener("pageshow",e))};window.addEventListener("pageshow",e)}var h=(t=>(t.InvalidLanguage="Variable $language of type LanguageCode was provided invalid value",t.InvalidCountry="Variable $country of type CountryCode was provided invalid value",t.MissingCartId="Variable $cartId of type ID! was provided invalid value",t.BuyerIdentityInvalidCountry="Variable $buyerIdentity of type CartBuyerIdentityInput! was provided invalid value for countryCode",t.BuyerIdentityInvalidPhone="INVALID: buyerIdentity.phone",t.BuyerIdentityEmailRequired="BUYER_IDENTITY_EMAIL_REQUIRED",t.BuyerIdentityEmailDomainInvalid="BUYER_IDENTITY_EMAIL_DOMAIN_IS_INVALID",t.BuyerIdentityEmailNotExpectedPattern="BUYER_IDENTITY_EMAIL_DOES_NOT_MATCH_EXPECTED_PATTERN",t.BuyerIdentityEmailInvalid="INVALID: buyerIdentity.email",t.DeliveryFirstNameInvalid="DELIVERY_FIRST_NAME_INVALID",t.DeliveryFirstNameRequired="DELIVERY_FIRST_NAME_REQUIRED",t.DeliveryFirstNameContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",t.DeliveryFirstNameTooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",t.DeliveryFirstNameContainsUrl="ADDRESS_FIELD_CONTAINS_URL: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",t.DeliveryFirstNameContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.firstName",t.DeliveryLastNameInvalid="DELIVERY_LAST_NAME_INVALID",t.DeliveryLastNameRequired="DELIVERY_LAST_NAME_REQUIRED",t.DeliveryLastNameContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",t.DeliveryLastNameTooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",t.DeliveryLastNameContainsUrl="ADDRESS_FIELD_CONTAINS_URL: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",t.DeliveryLastNameContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.lastName",t.DeliveryAddress1Required="DELIVERY_ADDRESS1_REQUIRED",t.DeliveryAddress1Invalid="DELIVERY_ADDRESS1_INVALID",t.DeliveryAddress1TooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address1",t.DeliveryAddress1ContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address1",t.DeliveryAddress1ContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address1",t.DeliveryAddress2Required="DELIVERY_ADDRESS2_REQUIRED",t.DeliveryAddress2Invalid="DELIVERY_ADDRESS2_INVALID",t.DeliveryAddress2TooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",t.DeliveryAddress2ContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",t.DeliveryAddress2ContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",t.DeliveryAddress2AddressFieldRequired="ADDRESS_FIELD_IS_REQUIRED: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.address2",t.DeliveryCityRequired="DELIVERY_CITY_REQUIRED",t.DeliveryCityInvalid="DELIVERY_CITY_INVALID",t.DeliveryCityTooLong="ADDRESS_FIELD_IS_TOO_LONG: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",t.DeliveryCityContainsHtmlTags="ADDRESS_FIELD_CONTAINS_HTML_TAGS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",t.DeliveryCityContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",t.DeliveryCityAddressFieldRequired="ADDRESS_FIELD_IS_REQUIRED: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.city",t.DeliveryZoneNotFound="DELIVERY_ZONE_NOT_FOUND",t.DeliveryZoneRequiredForCountry="DELIVERY_ZONE_REQUIRED_FOR_COUNTRY",t.DeliveryPostalCodeInvalid="DELIVERY_POSTAL_CODE_INVALID",t.DeliveryInvalidPostalCodeForZone="DELIVERY_INVALID_POSTAL_CODE_FOR_ZONE",t.DeliveryInvalidPostalCodeForCountry="DELIVERY_INVALID_POSTAL_CODE_FOR_COUNTRY",t.DeliveryPostalCodeRequired="DELIVERY_POSTAL_CODE_REQUIRED",t.DeliveryZipInvalidForCountry="INVALID_ZIP_CODE_FOR_COUNTRY: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.zip",t.DeliveryPostalCodeContainsEmojis="ADDRESS_FIELD_CONTAINS_EMOJIS: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.zip",t.DeliveryPostalCodeAddressFieldRequired="ADDRESS_FIELD_IS_REQUIRED: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.zip",t.DeliveryCountryInvalid="INVALID: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.country",t.DeliveryPhoneNumberRequired="DELIVERY_PHONE_NUMBER_REQUIRED",t.DeliveryOptionsPhoneNumberRequired="DELIVERY_OPTIONS_PHONE_NUMBER_REQUIRED",t.DeliveryPhoneNumberInvalid="DELIVERY_PHONE_NUMBER_INVALID",t.DeliveryPhoneDoesNotMatchExpectedPattern="ADDRESS_FIELD_DOES_NOT_MATCH_EXPECTED_PATTERN: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.phone",t.MerchandiseOutOfStock="MERCHANDISE_OUT_OF_STOCK",t.InvalidQuantity="INVALID: input.lines.0.quantity",t.DeliveryOutOfStockAtOrigin="DELIVERY_OUT_OF_STOCK_AT_ORIGIN_LOCATION",t.DeliveryExternalPromiseUnfulfillable="DELIVERY_EXTERNAL_PROMISE_UNFULFILLABLE",t.MerchandiseNotApplicable="MERCHANDISE_NOT_APPLICABLE",t.MerchandiseVariantNotFound="MERCHANDISE_PRODUCT_VARIANT_NOT_FOUND",t.MerchandiseNotFound="MERCHANDISE_NOT_FOUND",t.MerchandiseNotPublished="MERCHANDISE_PRODUCT_NOT_PUBLISHED",t.MerchandiseNotSupportedForB2B="MERCHANDISE_SELLING_PLANS_NOT_SUPPORTED_FOR_B2B",t.MerchandiseBundleRequiresComponents="MERCHANDISE_BUNDLE_REQUIRES_COMPONENTS",t.MerchandiseGiftCardsNotSupported="MERCHANDISE_GIFT_CARDS_COMPONENTS_NOT_SUPPORTED",t.MerchandiseGiftCardGreaterThanZero="MERCHANDISE_GIFT_CARD_PRICE_MUST_BE_GREATER_THAN_ZERO",t.MerchandiseGiftCardCannotExceedLimit="MERCHANDISE_GIFT_CARD_PRICE_MUST_NOT_EXCEED_LIMIT",t.UnacceptablePaymentsAmount="PAYMENTS_UNACCEPTABLE_PAYMENT_AMOUNT",t.DeliveryNotAvailable="DELIVERY_NO_DELIVERY_AVAILABLE",t.DeliveryNoStrategyAvailable="DELIVERY_NO_DELIVERY_STRATEGY_AVAILABLE",t.DeliveryNoLocalPickupStrategyAvailable="DELIVERY_LOCAL_PICKUP_NO_DELIVERY_STRATEGY_AVAILABLE",t.DeliveryLineChanged="DELIVERY_DELIVERY_LINE_DETAIL_CHANGED",t.DeliveryLocalPickupLineChanged="DELIVERY_LOCAL_PICKUP_DELIVERY_LINE_DETAIL_CHANGED",t.DeliveryNoDeliveryAvailableForMerchandise="DELIVERY_NO_DELIVERY_STRATEGY_AVAILABLE_FOR_MERCHANDISE_LINE",t.DeliveryFulfillmentConstraintNotSatisfied="DELIVERY_MUST_FULFILL_FROM_CONSTRAINT_NOT_SATISFIED",t.DeliveryFulfillmentLocationConstraint="DELIVERY_MUST_FULFILL_FROM_SAME_LOCATION_CONSTRAINT_NOT_SATISFIED",t.NoDeliveryGroupSelected="NO_DELIVERY_GROUP_SELECTED",t.PendingDeliveryGroups="PENDING_DELIVERY_GROUPS",t.InvalidPaymentAmount="INVALID_PAYMENT: amount",t.InvalidPaymentPaymentAmount="INVALID_PAYMENT: payment.amount",t.NewTaxMustBeAccepted="TAX_NEW_TAX_MUST_BE_ACCEPTED",t.MerchandiseExpectedPriceMismatch="MERCHANDISE_EXPECTED_PRICE_MISMATCH",t.InvalidPaymentApplePayBillingAddress="INVALID_PAYMENT: payment.walletPaymentMethod.applePayWalletContent.billingAddress",t.InvalidPaymentGooglePayBillingAddress="INVALID_PAYMENT: payment.walletPaymentMethod.googlePayWalletContent.billingAddress",t.UnsupportedGooglePayPaymentMethod="PAYMENT_METHOD_NOT_SUPPORTED: payment.walletPaymentMethod.googlePayWalletContent",t))(h||{});const Gr=["INVALID_PAYMENT: amount","INVALID_PAYMENT: payment.amount"],zr=["DELIVERY_NO_DELIVERY_STRATEGY_AVAILABLE_FOR_MERCHANDISE_LINE","DELIVERY_OUT_OF_STOCK_AT_ORIGIN_LOCATION","DELIVERY_MUST_FULFILL_FROM_CONSTRAINT_NOT_SATISFIED","DELIVERY_MUST_FULFILL_FROM_SAME_LOCATION_CONSTRAINT_NOT_SATISFIED","DELIVERY_EXTERNAL_PROMISE_UNFULFILLABLE","MERCHANDISE_OUT_OF_STOCK","MERCHANDISE_PRODUCT_VARIANT_NOT_FOUND","MERCHANDISE_NOT_FOUND","MERCHANDISE_PRODUCT_NOT_PUBLISHED","MERCHANDISE_SELLING_PLANS_NOT_SUPPORTED_FOR_B2B","MERCHANDISE_BUNDLE_REQUIRES_COMPONENTS","MERCHANDISE_GIFT_CARDS_COMPONENTS_NOT_SUPPORTED","MERCHANDISE_GIFT_CARD_PRICE_MUST_BE_GREATER_THAN_ZERO","MERCHANDISE_GIFT_CARD_PRICE_MUST_NOT_EXCEED_LIMIT","INVALID: input.lines.0.quantity","MERCHANDISE_NOT_APPLICABLE"];class ui extends Error{constructor(e){super("[".concat(e.name,"] ").concat(e.message)),this.stack=e.stack,this.name="HandleCreateCartError"}}async function ne({element:t,instrumentName:e,dataSource:n}){try{const r=await n.getInitialCart(e),{cart:a,errors:i}=r;if(di(()=>{t&&(t.disabled=!1)}),!a||!a.id)throw new Error("[".concat(e,"] received invalid cart"));if(!a.checkoutUrl)throw new Error("[".concat(e,"] Created cart with no checkout URL"));const o=i.length===1&&i[0]===h.InvalidQuantity;if(i.length>0&&!o)throw new Error("Failed to create cart: ".concat(JSON.stringify(i)));const s=o&&a.lineItems.every(u=>u.quantity===0);return{cart:a,errors:i,outOfStock:s}}catch(r){throw new ui(r)}finally{t.disabled=!1}}class hi extends ct{constructor(){super(),c(this,"anchor"),c(this,"i18n"),c(this,"dataSource"),c(this,"classNames"),c(this,"setI18n"),c(this,"setDataSource"),c(this,"setClassNames"),[this.i18n,this.setI18n]=W(),[this.dataSource,this.setDataSource]=W(),[this.classNames,this.setClassNames]=W()}static get observedAttributes(){return["disabled"]}connectedCallback(){this.anchor||this.render()}attributeChangedCallback(e,n,r){n!==r&&e==="disabled"&&this.anchor&&(r===""?this.anchor.setAttribute("aria-disabled","true"):this.anchor.removeAttribute("aria-disabled"),this.setAccessibilityAttributes())}async handleClick(e){if(e.preventDefault(),this.disabled||!this.anchor)return;this.disabled=!0;const[n,r]=await Promise.all([this.i18n,this.dataSource]);try{const{outOfStock:a,cart:i}=await ne({element:this,instrumentName:b.MoreOptions,dataSource:r});if(a){te(n);return}const o=this.recommendedInstrument===b.ShopPay?"skip_shop_pay":"allow_redirect";g.sheetClicked({instrument:b.MoreOptions,result:"success"}),re(b.MoreOptions),ee(i.checkoutUrl,o)}catch(a){g.sheetClicked({instrument:b.MoreOptions,result:"failed"}),w.notify(a),ye(n.translate("error_dialogs.checkout.title"),n.translate("error_dialogs.checkout.generic_error"))}}async render(){const e=await this.i18n,n=await this.classNames;this.anchor=document.createElement("a"),this.anchor.textContent=e.translate("more_payment_options"),this.anchor.className=n,this.anchor.setAttribute("id","more-payment-options-link"),this.anchor.onclick=a=>this.handleClick(a),this.setAccessibilityAttributes(),this.appendChild(this.anchor);const r=document.createElement("style");r.textContent=xa,this.appendChild(r)}setAccessibilityAttributes(){this.anchor&&(this.disabled?(this.anchor.removeAttribute("href"),this.anchor.role="link"):(this.anchor.removeAttribute("role"),this.anchor.href="#"))}}class Vr extends HTMLElement{constructor(){super(),c(this,"i18n"),c(this,"apiClient"),c(this,"setI18n"),c(this,"setApiClient"),[this.i18n,this.setI18n]=W(),[this.apiClient,this.setApiClient]=W()}}const pi="#buyer-consent{margin-top:1em;display:inline-block}#buyer-consent-button{background:none;border:none;padding:0;text-decoration:underline;font-size:inherit;cursor:pointer}#buyer-consent-button:before{box-shadow:none}";class qr extends Vr{connectedCallback(){this.innerHTML="",this.render()}async render(){const e=await this.i18n,n=await this.apiClient,r=document.createElement("small");r.setAttribute("id","buyer-consent");const a=document.createElement("buyer-consent-button");a.setI18n(e),a.setApiClient(n),r.innerHTML=e.translate("subscriptions.buyer_consent",{subscriptionPolicyLink:'<span id="subscription-policy-button"></span>'}),r.querySelector("#subscription-policy-button").appendChild(a);const i=document.createElement("style");i.textContent=pi;const o=new DocumentFragment;o.appendChild(i),o.appendChild(r),this.appendChild(o)}}class mi extends Vr{constructor(){super(...arguments),c(this,"isFetchingPolicy",!1),c(this,"policy")}connectedCallback(){this.render()}async render(){const{translate:e}=await this.i18n,n=e("subscriptions.cancellation_policy"),r=Ve({label:e("action.view",{content:n})});r.setAttribute("id","buyer-consent-button"),r.textContent=n,r.onclick=this.onClick.bind(this),this.appendChild(r)}async onClick(e){e.preventDefault();const n=await this.i18n,r=await this.apiClient;if(!this.isFetchingPolicy){if(this.policy){this.showPolicy(this.policy,n);return}try{await this.fetchSubscriptionPolicy(r);const a=this.policy&&this.policy!==""?this.policy:n.translate("subscriptions.policy_not_found");this.showPolicy(a,n)}catch(a){w.notify(a),this.showPolicy(n.translate("subscriptions.policy_not_found"),n)}}}async fetchSubscriptionPolicy(e){this.isFetchingPolicy=!0,this.policy=await e.fetchSubscriptionPolicy(),this.isFetchingPolicy=!1}showPolicy(e,n){qt(n.translate("subscriptions.subscription_policy"),e)}}G("buyer-consent-button",mi,{isChildCustomElement:!0}),G("buyer-consent",qr);var T=(t=>(t.ButtonDisplay="buttonDisplay",t.LoadInstrument="loadInstrument",t.LoadSdk="loadSDK",t.AuthorizationLatency="authorizationLatency",t))(T||{});function jr(){var t,e;return!!((t=window.performance)!=null&&t.mark)&&!!((e=window.performance)!=null&&e.measure)}function dt(t,e){return qe(t,e),()=>J(t,e)}function qe(t,e){jr()&&window.performance.mark("".concat(t,"-").concat(e,"-start"))}function J(t,e){var n,r;if(jr())try{const a="".concat(t,"-").concat(e,"-start"),i="".concat(t,"-").concat(e,"-end"),o="".concat(t,"-").concat(e,"-duration");window.performance.mark(i);const s=(r=window.performance.measure(o,a,i))!=null?r:(n=window.performance.getEntriesByName(o,"measure"))==null?void 0:n[0],u=s==null?void 0:s.duration;if(u==null){w.notify(new dr("Could not measure performance of ".concat(t," ").concat(e)),{severity:"warning"});return}return u}catch(a){a instanceof SyntaxError||w.notify(new dr("An error occurred when attempting to measure benchmark duration ".concat(t," with context ").concat(e,": ").concat(a)));return}}class dr extends Error{constructor(){super(...arguments),c(this,"name","BenchmarkError")}}function jt(t,e,n){if(Me!=null&&Me.length){const r=Me.join(",");t.querySelectorAll(r).forEach(a=>{n===null?a.removeAttribute(e):a.setAttribute(e,n)})}}function yi(t,e){try{const n=JSON.parse(t!=null?t:"[]");if(!(n instanceof Array))throw new Error("[".concat(e,"] invalid walletConfigs found"));return n}catch(n){throw new Error("[".concat(e,"] Error while parsing walletConfigs JSON: ").concat(n))}}function gi(t,e){try{return t?JSON.parse(t):null}catch(n){throw new Error("[".concat(e,"] Error while parsing walletConfig JSON: ").concat(n))}}function Wt(t){var e;const n=t==null?void 0:t.getLoadEligibility();return g.instrumentLoadEligibility({instrument:t==null?void 0:t.getInstrumentName(),result:n!=null&&n.eligible?"success":"failed",reason:n!=null&&n.eligible||n==null?void 0:n.reason}),(e=n==null?void 0:n.eligible)!=null?e:!1}function fi(t){return t.filter(Wt)}async function Nt({walletInstrument:t,instanceNumber:e}){const n=t.getInstrumentName(),r=dt(T.LoadSdk,"".concat(n,":").concat(e));try{await t.loadWalletSDK(),g.instrumentSDKLoaded({instrument:n,measurement:r(),result:"success"})}catch(i){return w.notify(i),g.instrumentSDKLoaded({instrument:n,measurement:r(),result:"failed"}),null}let a;try{a=t.getPartnerSDKEligibility()}catch(i){w.notify(i),a={eligible:!1,reason:"uncaught exception"}}return a.eligible?(g.instrumentSDKEligible({instrument:n,result:"success"}),t):(g.instrumentSDKEligible({instrument:n,reason:a.reason,result:"failed"}),null)}class Yt extends ct{constructor(){super(...arguments),c(this,"name",null),c(this,"apiClient"),c(this,"i18n")}get shopId(){return this.getAttribute("shop-id")}get cartId(){return this.getAttribute("cart-id")}get walletConfigs(){return this.getAttribute("wallet-configs")}get recommendedWallet(){return this.getAttribute("recommended")}get fallbackWallet(){return this.getAttribute("fallback")}get variantParams(){var e;try{return JSON.parse((e=this.getAttribute("variant-params"))!=null?e:"[]")}catch(n){throw new De({code:"invalid-variant-params",message:"variant-params must be a valid JSON string. Received variant-params: ".concat(this.getAttribute("variant-params"),", received error: ").concat(n)})}}get styleExtractorDisabled(){return this.hasAttribute("disable-compat")}triggerLoadedEvent(){document.dispatchEvent(new Event("shopify:payment_button:loaded",{bubbles:!0,cancelable:!0}))}async attributeChangedCallback(e,n,r){n!==r&&jt(this,e,r)}toggleBuyerConsent(e,n,r){if(!n||!r)return;const a=e.querySelector("buyer-consent");if(a){a.remove();return}if(this.hasSellingPlan){const i=document.createElement("buyer-consent");i.setI18n(r),i.setApiClient(n),i.slot="buyer-consent",e.appendChild(i)}}clearUI(){this.innerHTML=""}}G("buyer-consent",qr,{isChildCustomElement:!0});function Wr({type:t,form:e}){if(!e)return[];const n=document.querySelectorAll('[name^="'.concat(t,'"][form^="').concat(CSS.escape(e.getAttribute("id")||""),'"]')),r=e.querySelectorAll('[name^="'.concat(t,'"]')),a=[...n,...r],i={};return a.forEach(o=>{const s=bi(o),u=wi(o);s&&typeof u<"u"&&(i[s]=u)}),Object.entries(i!=null?i:{}).map(([o,s])=>({key:o,value:s}))}function ut({page:t,element:e}){const n=t==="product"?'[data-shopify="payment-button"]':'[data-shopify="dynamic-checkout-cart"]',r=ur(e,n)||document.querySelector(n);return ur(r,"form")}const Oe=Element.prototype;function ur(t,e){if(Oe.matches=Oe.matches||Oe.webkitMatchesSelector||Oe.msMatchesSelector||Oe.mozMatchesSelector,!t||t.matches(e))return t;let n=t;for(;n&&n!==document.body;)if(n=n.parentElement,n&&n.matches(e))return n;return null}function bi(t){const e=t.getAttribute("name");if(e===null)return null;const n=e.indexOf("["),r=e.lastIndexOf("]");return n===-1||r===-1?null:e.substring(n+1,r)}function wi(t){if(!(["radio","checkbox"].includes(t.type)&&!t.checked)&&!(t.value===""||typeof t.value>"u"))return t.value}function Kt(t){const e=ut({page:"product",element:t});return Yr(e)}function Yr(t){var e;const n=t==null?void 0:t.elements;if(!n)return null;const r=Je(n,"id");if(!r||isNaN(Number(r)))return null;const a=Number((e=Je(n,"quantity"))!=null?e:"1"),i="gid://shopify/ProductVariant/".concat(r),o=Je(n,"selling_plan"),s=o?"gid://shopify/SellingPlan/".concat(o):void 0,u=Wr({type:"properties",form:t});return{variantId:r,quantity:a,merchandiseId:i,sellingPlanId:s,lineItemProperties:u}}function Ai(t){const e=t==null?void 0:t.elements;return e?!!Je(e,"selling_plan"):!1}function Je(t,e){var n;const r=t.namedItem(e);return r&&"value"in r&&(n=r.value)!=null?n:null}class Kr{constructor(e,n){c(this,"addToCartMutationObserver"),c(this,"addToCartForm"),c(this,"addToCartButtons"),this.element=e,this.onFormChanged=n,this.addToCartMutationObserver=null,this.addToCartForm=null,this.addToCartButtons=[]}setupMutationObservers(){if(this.findAndSetAddToCartButtons(),!this.addToCartForm)return;this.syncComponentStateWithForm();const e=new MutationObserver(()=>this.reobserveOnFormChanges());this.addToCartMutationObserver=new MutationObserver(()=>this.syncComponentStateWithForm()),e.observe(this.addToCartForm,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),this.observeAddToCartButtons()}syncComponentStateWithForm(){if(!this.addToCartForm){this.onFormChanged({disabled:!0,hasSellingPlan:!1});return}const e=Yr(this.addToCartForm),n=!!(this.addToCartButtons.length>0&&this.addToCartButtons.every(r=>r.hasAttribute("disabled")||r.getAttribute("aria-disabled")==="true"));this.onFormChanged({disabled:n||e===null,hasSellingPlan:Ai(this.addToCartForm),variantId:e==null?void 0:e.variantId,sellingPlanId:e==null?void 0:e.sellingPlanId})}observeAddToCartButtons(){this.addToCartButtons.forEach(e=>{this.addToCartMutationObserver.observe(e,{attributes:!0})})}reobserveOnFormChanges(){var e;(e=this.addToCartMutationObserver)==null||e.disconnect(),this.findAndSetAddToCartButtons(),this.observeAddToCartButtons(),this.syncComponentStateWithForm()}findAndSetAddToCartButtons(){this.addToCartForm=ut({page:"product",element:this.element}),this.addToCartForm&&(this.addToCartButtons=[...this.addToCartForm.querySelectorAll("[type=submit]")])}}function _i(t,e,n){try{const r=JSON.parse(t!=null?t:"{}"),a=JSON.parse(e!=null?e:JSON.stringify({name:"buy_it_now",wallet_params:{}}));if(r===null||Object.keys(r).length===0){if(!(a instanceof Object))throw new Error("[".concat(n,"] Invalid fallback wallet configs JSON"));return{recommendedWallet:null,fallbackWallet:a}}return{recommendedWallet:r,fallbackWallet:a}}catch(r){throw r instanceof SyntaxError?(g.walletConfigDeveloperError(),new De({code:"invalid-recommended-fallback-json",message:"recommended / fallback must be valid JSON"})):new Error("[".concat(n,"] Error while parsing recommended/fallback JSON: ").concat(r))}}const Ci=".shopify-payment-button__button--hidden{visibility:hidden}.shopify-payment-button__button{height:var(--shopify-accelerated-checkout-button-block-size, 44px);min-height:var(--shopify-accelerated-checkout-button-block-size, 44px);border-radius:var(--shopify-accelerated-checkout-button-border-radius, 4px);width:100%;border:none;box-shadow:0 0 0 0 transparent;color:#fff;cursor:pointer;display:block;font-size:1em;font-weight:500;line-height:1;text-align:center;transition:background .2s ease-in-out}.shopify-payment-button__button[disabled]{opacity:.6;cursor:default}.shopify-payment-button__button--unbranded{background-color:#1990c6;padding:1em 2em}.shopify-payment-button__button--unbranded:hover:not([disabled]){background-color:#136f99}.shopify-payment-button__more-options{background:transparent;border:0 none;cursor:pointer;display:block;font-size:1em;margin-top:1em;text-align:center;text-decoration:underline;width:100%}.shopify-payment-button__more-options.shopify-payment-button__skeleton{height:auto!important;min-height:0!important;border-radius:4px!important;width:50%;margin-left:25%;margin-right:25%}.shopify-payment-button__more-options[disabled]{opacity:.6;cursor:default!important}.shopify-payment-button__button.shopify-payment-button__button--branded{display:flex;flex-direction:column;position:relative;z-index:1}.shopify-payment-button__button.shopify-payment-button__button--branded .shopify-cleanslate{flex:1!important;display:flex!important;flex-direction:column!important}.shopify-payment-button__button.button.loading{position:relative;color:transparent}.shopify-payment-button__button.button.loading>.loading-overlay__spinner{top:50%;left:50%;transform:translate(-50%,-50%);position:absolute;height:100%;display:flex;align-items:center}.shopify-payment-button__button.button.loading>.loading-overlay__spinner .spinner{width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}.button.loading>.loading-overlay__spinner .path{stroke:#fff}.shopify-payment-button__button .loading-overlay__spinner{width:1.8rem;display:inline-block}.shopify-payment-button__button .spinner{animation:shopify-rotator 1.4s linear infinite}@keyframes shopify-rotator{0%{transform:rotate(0)}to{transform:rotate(270deg)}}.shopify-payment-button__button .path{stroke-dasharray:280;stroke-dashoffset:0;transform-origin:center;stroke:#121212;animation:shopify-dash 1.4s ease-in-out infinite}@media screen and (forced-colors: active){.shopify-payment-button__button .path{stroke:CanvasText}}@keyframes shopify-dash{0%{stroke-dashoffset:280}50%{stroke-dashoffset:75;transform:rotate(135deg)}to{stroke-dashoffset:280;transform:rotate(450deg)}}@keyframes acceleratedCheckoutLoadingSkeleton{50%{opacity:var(--shopify-accelerated-checkout-skeleton-animation-opacity-start, 1)}75%{opacity:var(--shopify-accelerated-checkout-skeleton-animation-opacity-end, .5)}to{opacity:var(--shopify-accelerated-checkout-skeleton-animation-opacity-start, 1)}}.shopify-payment-button__skeleton{animation:acceleratedCheckoutLoadingSkeleton var(--shopify-accelerated-checkout-skeleton-animation-duration, 4s) var(--shopify-accelerated-checkout-skeleton-animation-timing-function, ease) infinite;animation-delay:-.168s;background-color:var(--shopify-accelerated-checkout-skeleton-background-color, #dedede);box-sizing:border-box;text-decoration:none!important;height:var(--shopify-accelerated-checkout-button-block-size, inherit);min-height:var(--shopify-accelerated-checkout-button-block-size, inherit);border-radius:var(--shopify-accelerated-checkout-button-border-radius, inherit)}.shopify-payment-button__button{border-radius:0}",Jr='.accelerated-checkout-button{height:clamp(25px,var(--shopify-accelerated-checkout-button-block-size, 44px),55px);min-height:clamp(25px,var(--shopify-accelerated-checkout-button-block-size, 44px),55px);border-radius:var(--shopify-accelerated-checkout-button-border-radius, 0px);box-shadow:var(--shopify-accelerated-checkout-button-box-shadow);min-width:150px}:host([page-type="cart_page"]) .accelerated-checkout-button{height:100%;width:100%;border-radius:var(--shopify-accelerated-checkout-button-border-radius, 4px);box-shadow:var(--shopify-accelerated-checkout-button-box-shadow)}',Si=70;class Ue{constructor(e,n,r,a){c(this,"red"),c(this,"green"),c(this,"blue"),c(this,"opacity"),this.red=e||0,this.green=n||0,this.blue=r||0,this.opacity=typeof a>"u"?1:a}getLuminance(){const e=this.red&255,n=this.green&255,r=this.blue&255;return e*.2126+n*.7152+r*.0722}isDark(){return this.opacity===0?!1:this.getLuminance()/this.opacity<Si}blendWith(e,n){this.opacity=1-(1-e.opacity)*(1-n.opacity),this.red=this.blend(e.red,n.red,e,n),this.green=this.blend(e.green,n.green,e,n),this.blue=this.blend(e.blue,n.blue,e,n)}blend(e,n,r,a){return Math.round(e*r.opacity/this.opacity+n*a.opacity*(1-r.opacity)/this.opacity)}}function Ei(t){const e=[...t];let n=new Ue(0,0,0,0),r=new Ue(255,255,255,1),a=e.shift();for(;a;)n.opacity>0&&a.opacity>0?(r=new Ue(0,0,0,0),r.blendWith(a,n)):a.opacity>0?r=a:r=n,n=r,a=e.shift();return r}const Tt=new Ue(255,255,255,1);function Ii(t){const e=[];let n=t;for(;n.parentElement;){n=n.parentElement;const r=window.getComputedStyle(n).backgroundColor,a=vi(r);if(r&&e.push(a),a.opacity===1)break}try{return Ei(e.reverse())}catch(r){return w.notify(new Error("[BackgroundDetection] Failed to blend colors for element ".concat(t.outerHTML))),Tt}}function vi(t){if(!t)return Tt;try{const e=t.split("(")[1].split(")")[0].replace(" ","").split(",");return new Ue(Number(e[0]),Number(e[1]),Number(e[2]),typeof e[3]>"u"?1:Number(e[3]))}catch(e){w.notify(new Error("[BackgroundDetection] Failed to convert rgbString to array ".concat(t)))}return Tt}class ge extends ct{constructor(){super(),c(this,"name",null),c(this,"i18n"),c(this,"dataSource"),c(this,"apiClient"),c(this,"classNames"),c(this,"containerInstanceNumber"),c(this,"onRendered"),c(this,"setI18n"),c(this,"setDataSource"),c(this,"setApiClient"),c(this,"setClassNames"),c(this,"setContainerInstanceNumber"),c(this,"parsedWalletParams"),this.onRendered=()=>{},[this.i18n,this.setI18n]=W(),[this.dataSource,this.setDataSource]=W(),[this.apiClient,this.setApiClient]=W(),[this.classNames,this.setClassNames]=W(),[this.containerInstanceNumber,this.setContainerInstanceNumber]=W()}async cleanupOnFailure(e,n){var r;try{await e()}catch(a){w.notify(new Pi("An error occurred requiring cleanup when attempting to a render the ".concat(n," instrument : ").concat(a)));const i=await this.containerInstanceNumber;g.instrumentLoaded({instrumentOrComponentName:n,result:"failed",measurement:J(T.ButtonDisplay,"".concat(n,":").concat(i))}),(r=this.parentElement)==null||r.remove()}}attributeChangedCallback(e,n,r,a){n!==r&&e==="disabled"&&a&&(r===""?(a.setAttribute("aria-disabled","true"),a.setAttribute("disabled","")):(a.removeAttribute("aria-disabled"),a.removeAttribute("disabled")))}get pageType(){return this.getAttribute("page-type")||S.Unknown}get buttonTheme(){return Ii(this).isDark()?"LIGHT":"DARK"}get isCTA(){return this.hasAttribute("call-to-action")}get walletParams(){var e;if(this.parsedWalletParams===void 0)try{this.parsedWalletParams=JSON.parse((e=this.getAttribute("wallet-params"))!=null?e:"{}")}catch(n){throw new Error("Error while parsing wallet-params JSON: ".concat(n))}return this.parsedWalletParams}async initializeShadowStyles(e,n=""){const r=document.createElement("style");r.innerHTML=[Jr,n].join("\n"),e.appendChild(r)}}class Pi extends Error{constructor(){super(...arguments),c(this,"name","CleanupOnFailureError")}}class Di extends ge{constructor(){super(...arguments),c(this,"name",b.BuyItNow),c(this,"button",null)}static get observedAttributes(){return["disabled"]}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}attributeChangedCallback(e,n,r){super.attributeChangedCallback(e,n,r,this.button)}async handleClick(){if(this.disabled||!this.button||this.button.getAttribute("aria-disabled"))return;this.disabled=!0;const[e,n]=await Promise.all([this.i18n,this.dataSource]);try{const{outOfStock:r,cart:a}=await ne({element:this,instrumentName:this.name,dataSource:n});if(g.sheetClicked({instrument:this.name,checkoutToken:st(a),result:"success"}),r){te(e);return}re(this.name),ee(a.checkoutUrl,"allow_redirect")}catch(r){w.notify(r),g.sheetClicked({instrument:this.name,result:"failed"}),ye(e.translate("error_dialogs.checkout.title"),e.translate("error_dialogs.checkout.generic_error"))}}async render(){var e;this.button||(this.button=Ve());const n=await this.classNames;this.button.textContent=(await this.i18n).translate("instruments_copy.checkout.buy_now"),this.button.className=n,this.disabled&&this.button.setAttribute("aria-disabled","true"),this.button.onclick=()=>this.handleClick(),this.appendChild(this.button),(e=this.onRendered)==null||e.call(this)}}function Ni(){const t=navigator.userAgent,e=t.indexOf("Android")>-1,n=t.indexOf("Chrome/")>-1,r=parseInt((/Chrome\/([0-9]+)/.exec(t)||["0","0"])[1],10);return e&&n&&r===114}class ae{constructor(e){c(this,"walletParams"),this.walletParams=e.wallet_params}static walletName(){throw new Error("Must define walletName for WalletInstrument subclass")}createWebComponent({walletContainer:e,dataSource:n,i18n:r,apiClient:a,containerInstanceNumber:i,classNames:o="",callToAction:s,pageType:u=S.ProductPage,slot:l="button",onRendered:d=()=>{}}){var p,y,m;const C=this.getWebComponentName();G(C,this.getWebComponentClass(),{isChildCustomElement:!0});const f=document.createElement(C),I={"access-token":(p=e.accessToken)!=null?p:"","buyer-country":(y=e.buyerCountry)!=null?y:"","buyer-currency":e.buyerCurrency,"wallet-params":JSON.stringify((m=this.walletParams)!=null?m:{}),"page-type":u,slot:l};try{e.disabled&&f.setAttribute("disabled",""),lt(f,I),e.isShippingRequired&&f.setAttribute("requires-shipping",""),e.hasSellingPlan&&f.setAttribute("has-selling-plan","")}catch(B){const Z=B;throw Z.message.includes("setAttribute is not a function")&&Ni()?new ze({message:Z.message}):Z}return s&&f.setAttribute("call-to-action",""),f.setDataSource(n),f.setApiClient(a),f.setI18n(r),f.setClassNames(o),f.setContainerInstanceNumber(i),f.onRendered=d,f}loadWalletSDK(){return Promise.resolve()}getLoadEligibility(){return{eligible:!0}}getPartnerSDKEligibility(){return{eligible:!0}}}class Ti extends ae{static walletName(){return"buy_it_now"}getWebComponentName(){return"shopify-buy-it-now-button"}getInstrumentName(){return b.BuyItNow}getWebComponentClass(){return Di}}const Ri="shopify-paypal-button[disabled]{opacity:.5;cursor:not-allowed}shopify-paypal-button div.paypal-buttons>iframe{z-index:auto!important;border-radius:0!important;box-shadow:none}",ki="::slotted(div){height:100%}";async function Ce(t){const{cartClient:e,instrumentName:n}=t;try{if(!t.cartId)throw new Error("[".concat(n,"] provided no cart ID when updating buyer identity"));if(!e)throw new Error("[".concat(n,"] provided invalid cart client when updating buyer identity"));return await e.updateCartBuyerIdentity(t)}catch(r){throw g.updateFailed(n,"updateBuyerIdentity"),r}}async function Jt({cartId:t,totalAmount:e,paymentMethod:n,billingAddress:r,cartClient:a,instrumentName:i,abortSignal:o,hasSellingPlan:s,canUsePaymentMethodForFreeOrder:u}){try{if(!t)throw new Error("[".concat(i,"] provided no cart ID when updating payment"));if(!e)throw new Error("[".concat(i,"] provided no total amount when updating payment"));if(!n)throw new Error("[".concat(i,"] provided no apple pay wallet content when updating payment"));if(!a)throw new Error("[".concat(i,"] provided invalid cart client when updating payment"));const l={freePaymentMethod:{billingAddress:r}};return await a.updateCartPayment(t,_({amount:{amount:e.amount,currencyCode:e.currencyCode}},Number(e.amount)<=0&&!u&&!s?l:n),i,o)}catch(l){throw g.updateFailed(i,"updatePayment"),l}}function Zt({checkoutUrl:t,instrumentName:e,currentCartTotal:n,initialBuyerCurrency:r}){if(!t)return!1;const a=n.amount;if(!a||Number(a)===0||r.toUpperCase()===n.currencyCode.toUpperCase())return!1;const i=new URL(t);return i.searchParams.set(ra.CURRENCY_CHANGE,"true"),g.decelerated({instrument:e,reason:"currency_changed"}),ee(i.toString()),!0}function Zr(t){return window[Qr(t)]}function Qr(t){return"paypal-".concat(t.replace(/[^a-zA-Z0-9]/g,""))}function hr(t){if(!t)return null;const e=getComputedStyle(t).borderRadius;return e.includes("px")?parseInt(e,10):null}function Rt(t){if(!t)return null;const e=getComputedStyle(t).height;return e.includes("px")?parseInt(e,10):null}function Qt(){return typeof AbortController=="function"&&new AbortController||null}const wt=25,pr=55;var ce;class Li extends ge{constructor(){super(),c(this,"name",b.PayPal),c(this,"abortController"),c(this,"cartId"),c(this,"sdkButtonsComponent"),c(this,"container",null),c(this,"resizeObserver",null),c(this,"buttonHeight"),c(this,"rendering",!1),c(this,"prevBorderRadius",0),c(this,"prevHeight",0),Y(this,ce,void 0),Q(this,ce,this.attachShadow({mode:"closed"})),this.abortController=Qt(),this.resizeObserver=typeof ResizeObserver=="function"&&new ResizeObserver(()=>this.onResize())||null}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}async disconnectedCallback(){this.innerHTML="",v(this,ce).innerHTML="",await this.teardownPayPalButton(),this.resizeObserver&&this.resizeObserver.disconnect()}async teardownPayPalButton(){var e;try{await((e=this.sdkButtonsComponent)==null?void 0:e.close().catch(()=>{}))}catch(n){}finally{this.sdkButtonsComponent=void 0}}async onResize(){const e=hr(this.container),n=Rt(this.container),r=e!==null&&this.prevBorderRadius!==e||n!==null&&this.prevHeight!==n;!this.rendering&&r&&(await this.teardownPayPalButton(),this.container.innerHTML="",await this.cleanupOnFailure(()=>this.renderFromPayPalSDK(),this.name))}async render(){var e;const n=document.createElement("div");n.className=pe.BUTTON;const r=document.createElement("style");r.innerHTML=Ri,this.appendChild(r),await this.initializeShadowStyles(v(this,ce),ki),v(this,ce).appendChild(n),this.container=n,this.renderFromPayPalSDK(),(e=this.resizeObserver)==null||e.observe(this.container)}getHeight(){const e=Rt(this.container);return e?e>=wt&&e<=pr?e:e<wt?(console.debug("[PayPalButton] Container height is less than the minimum height of the PayPal button. Using the minimum height of 25px."),wt):(console.debug("[PayPalButton] Container height is greater than the maximum height of the PayPal button. Using the maximum height of 55px."),pr):Xn}async renderFromPayPalSDK(){var e,n,r;if(!this.container)throw new Error("button container not set when attempting to render");this.rendering=!0;const a=this.walletParams.paymentIntent==="TOKENIZE",i=()=>this.createToken(this.apiClient);let o,s;a?s=i:o=i;const u=hr(this.container),l=this.getHeight();this.prevHeight=l;const d=await this.i18n,p={color:"gold",label:this.isCTA?"pay":"paypal",disableMaxWidth:!0,height:l,shape:"sharp"};u&&u>0&&(p.borderRadius=u,this.prevBorderRadius=u),this.sdkButtonsComponent=(n=(e=Zr(this.walletParams.sdkUrl))==null?void 0:e.Buttons)==null?void 0:n.call(e,{fundingSource:"paypal",style:p,createOrder:o,createBillingAgreement:s,onApprove:async y=>{await this.onApprove(y)},onCancel:()=>{var y;g.sheetCancelled(this.name),(y=this.abortController)==null||y.abort()},onClick:this.onClick.bind(this),onError:y=>{var m;if(y.message==="Window is closed, can not determine type"){g.sheetCancelled(this.name),(m=this.abortController)==null||m.abort();return}w.notify(y);const C=d.translate("brand.paypal");K(C,d)}}),await((r=this.sdkButtonsComponent)==null?void 0:r.render(this.container)),this.rendering=!1,this.onRendered()}async onClick(e,n){if(this.disabled)return n.reject();const r=this.getBoundingClientRect(),a=r.left+r.width/2,i=r.top+r.height/2,o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1,clientX:a,clientY:i,screenX:window.screenX+a,screenY:window.screenY+i});this.dispatchEvent(o);const[s,u]=await Promise.all([this.dataSource,this.i18n]);try{const{outOfStock:l,cart:d}=await ne({element:this,instrumentName:this.name,dataSource:s});return l?(te(u),n.reject()):(re(this.name),this.cartId=d.id,n.resolve())}catch(l){return l instanceof Error&&(g.sheetClicked({instrument:this.name,result:"failed"}),w.notify(l),ye(u.translate("error_dialogs.checkout.title"),u.translate("error_dialogs.checkout.generic_error"))),n.reject()}}async createToken(e){const n=await e;try{if(!this.cartId)throw new Error("cartId not found when creating token");const r=await n.paypalTokenCreate(this.cartId);return g.sheetClicked({instrument:this.name,result:"success"}),r}catch(r){throw g.sheetClicked({instrument:this.name,result:"failed"}),r}}async onApprove({orderID:e,payerID:n}){var r,a,i;try{if(g.authorizationAttempt(this.name),qe(T.AuthorizationLatency,this.name),!this.cartId)throw new Error("Cart not found");const o=await this.apiClient,s=await o.paypalBuyerDetailsFetch(e,this.cartId),{data:u}=await Ce({cartId:this.cartId,cartClient:o,instrumentName:this.name,emailAddress:s.email,streetAddress:s.destinationAddress});if(!u)throw new Error("Cart not found");const{id:l,checkoutUrl:d,totalAmount:p}=u;if(await Jt({abortSignal:(r=this.abortController)==null?void 0:r.signal,cartClient:o,cartId:l,instrumentName:b.PayPal,billingAddress:(a=s.billingAddress)!=null?a:s.destinationAddress,paymentMethod:{walletPaymentMethod:{paypalWalletContent:{billingAddress:(i=s.billingAddress)!=null?i:s.destinationAddress,email:s.email,expiresAt:s.expiresAt,payerId:n,token:e,acceptedSubscriptionTerms:!1,vaultingAgreement:!1,merchantId:this.walletParams.merchantId}}},canUsePaymentMethodForFreeOrder:!0,totalAmount:p}),Zt({checkoutUrl:d,instrumentName:this.name,currentCartTotal:p,initialBuyerCurrency:this.buyerCurrency}))return;g.authorizationComplete({instrument:this.name,result:"success",measurement:J(T.AuthorizationLatency,this.name)}),ee(d)}catch(o){throw g.authorizationComplete({instrument:this.name,result:"failure",measurement:J(T.AuthorizationLatency,this.name)}),o}}}ce=new WeakMap;const we=class Ks extends ae{static walletName(){return"paypal"}constructor(e){super(e)}getWebComponentName(){return"shopify-paypal-button"}getInstrumentName(){return b.PayPal}getWebComponentClass(){return Li}loadWalletSDK(){let e=Ks.paypalSDKPromiseByUrl.get(this.walletParams.sdkUrl);if(e)return e;const n=document.createElement("script");return n.setAttribute("src",this.walletParams.sdkUrl),e=new Promise((r,a)=>{n.setAttribute("data-namespace",Qr(this.walletParams.sdkUrl)),n.onload=()=>r(),n.onerror=i=>{Ks.paypalSDKPromiseByUrl.delete(this.walletParams.sdkUrl),n&&document.body.contains(n)&&document.body.removeChild(n),a(i)},document.body.appendChild(n)}),Ks.paypalSDKPromiseByUrl.set(this.walletParams.sdkUrl,e),e}getLoadEligibility(){return{eligible:!0}}getPartnerSDKEligibility(){var e,n;try{return(n=(e=Zr(this.walletParams.sdkUrl))==null?void 0:e.Buttons)!=null&&n.call(e).isEligible()?{eligible:!0}:{eligible:!1,reason:"PayPal SDK not eligible"}}catch(r){throw new De({code:"paypal-sdk-eligibility-check-failed",message:"PayPal SDK 'isEligible' method failed unexpectedly: ".concat(r)})}}};c(we,"paypalSDKPromiseByUrl",new Map);let kt=we;const Oi=".apple-pay-button{display:flex;align-items:center;justify-content:center;width:100%;padding:0!important;cursor:pointer;border:none}.apple-pay-button:hover:not(:disabled){filter:brightness(92%)}.apple-pay-button:disabled{opacity:.5;cursor:not-allowed}.apple-pay-button svg{height:100%;flex-shrink:0}.apple-pay--content{font-size:16px;font-family:San Francisco,sans-serif;width:100%;height:100%;flex-grow:1;display:flex;align-items:center;justify-content:center;white-space:pre}.apple-pay--light{background:#fff;color:#000}.apple-pay--light svg{fill:#000}.apple-pay--dark{background:#000;color:#fff}.apple-pay--dark svg{fill:#fff}",Lt={UK:"GB",JA:"JP"},Xr=["AS","GU","MP","PR","VI"];Xr.forEach(t=>{Lt[t]="US"});function We(t){var e,n;const r=t.countryCode,a={firstName:t.givenName||void 0,lastName:t.familyName||void 0,address1:(e=t==null?void 0:t.addressLines)==null?void 0:e[0],address2:((n=t==null?void 0:t.addressLines)==null?void 0:n[1])||void 0,city:t.locality||void 0,zip:t.postalCode||void 0,province:t.administrativeArea||t.subLocality||void 0,country:xi(t.countryCode),phone:t.phoneNumber||void 0};return a.country==="HK"&&(a.zip=void 0,a.province=t.postalCode),r&&Xr.includes(r)&&(a.province=r),a.lastName||(a.lastName=a.firstName),a}function xi(t){if(!t)return"ZZ";const e=t.toUpperCase();return Object.keys(Lt).includes(e)?Lt[e]:e}function en(t,e){return t.map(n=>{var r;return{title:Fi(n,e),estimatedCost:{amount:Mi(n),currencyCode:n[0].estimatedCost.currencyCode},handle:Ui(n),description:(r=n[0].description)!=null?r:""}})}function tn(t){return t.map(e=>e.deliveryOptions.map(n=>D(_({},n),{groupType:e.groupType}))).reduce((e,n)=>e.flatMap(r=>n.map(a=>[...r,a])),[[]])}function Mi(t){return t.reduce((e,n)=>e+Number(n.estimatedCost.amount),0).toFixed(2)}function Fi(t,e){var n,r;const a=(n=t.find(s=>s.groupType===$e.OneTimePurchase))==null?void 0:n.title,i=(r=t.find(s=>s.groupType===$e.Subscription))==null?void 0:r.title,o=[...new Set([a,i])].filter(Boolean);return o.length===2?e.translate("shipping_methods.connect_shipping_methods",{methodOne:o[0],methodTwo:o[1]}):o[0]}function Ui(t){return t.map(e=>e.handle).join(",")}function rn({deliveryGroups:t,i18n:e}){const n=t.some(r=>r.groupType===$e.Subscription);return t.map(r=>{var a;let i=e.translate("order_summary.shipping");return n&&(i=r.groupType===$e.Subscription?e.translate("order_summary.shipping_subscription"):e.translate("order_summary.shipping_one_time_purchase")),{label:i,amount:ue(((a=r.selectedDeliveryOption)==null?void 0:a.estimatedCost.amount)||0)}})}function Bi(t,e){return Fe({label:t,possibleLines:[e]})[0]}function $i({subtotal:t,deliveryGroups:e,duties:n,taxes:r,discountAllocations:a,i18n:i,formattedRecurringTotals:o}){var s;const u=Fe({label:i.translate("order_summary.subtotal"),possibleLines:[t]}),l=rn({deliveryGroups:e,i18n:i}),d=Fe({label:i.translate("order_summary.duties"),possibleLines:[n]}),p=Fe({label:i.translate("order_summary.taxes"),possibleLines:[r]}),y=o.map(f=>({label:f,amount:"0.00",type:"pending"})),m=y.length?[{label:i.translate("order_summary.subscriptions.recurring_total_tooltip_line"),amount:"0.00",type:"pending"}]:[],C=(s=a==null?void 0:a.flatMap(f=>{var I;const B=(I=f.title)!=null?I:f.code;return Fe({label:B!=null?B:i.translate("order_summary.discount"),possibleLines:[f.discountedAmount],isDiscount:!0})}))!=null?s:[];return[...u,...l,...d,...p,...C,...y,...m]}function Fe({label:t,possibleLines:e,isDiscount:n=!1}){return e.filter(r=>(r==null?void 0:r.amount)!==void 0).map(r=>({label:t,amount:n?"-".concat(ue(r.amount)):ue(r.amount)}))}function Hi(t,e){if(!t.length)return[];const n=tn(t);return en(n,e).map(r=>{var a;return{label:r.title||"",amount:r.estimatedCost.amount,identifier:r.handle,detail:(a=r.description)!=null?a:""}})}const At=async({paymentSheetAction:t,onProceed:e,terminateSession:n})=>{switch(t.action){case"abort":n();break;case"show_error":await e(t.errors);break;case"update":await e(t.errors);break;default:throw new Error('Missing handler for payment sheet action "'.concat(t.action,'"'))}},Gi=["abort","show_error","complete","update"];class nn extends Error{constructor(){super(...arguments),c(this,"name","UnhandledActionError")}}class an{constructor(){c(this,"generatePrioritizedPaymentSheetAction",(e,n)=>{let r;const a=[],i=[],o=[],s=n.filter(l=>l!==h.UnacceptablePaymentsAmount).some(l=>e[l]!==void 0);for(const l of Object.keys(e))if(!(l===h.UnacceptablePaymentsAmount&&s)){const d=e[l]();d.effects&&i.push(...d.effects),d.action!=="complete"&&d.errors&&o.push(...d.errors),a.push(d)}const u=(l=>Gi.map(d=>l.find(p=>p.action===d)).find(d=>!!d))(a);return u&&(r=u,r.effects=i,r.action!=="complete"&&(r.errors=o)),r})}getMergedPaymentSheetAction({result:e,errorActions:n}){const r={};n.forEach(i=>{i.errors.forEach(o=>{e.errors.includes(o)&&(r[o]=i.generateAction)})});let a;for(const i of e.errors){const o=r[i];if(o){a=o();break}}return{firstPaymentSheetAction:a,prioritizedPaymentSheetAction:this.generatePrioritizedPaymentSheetAction(r,e.errors)}}getUnhandledErrors(e,n){const r=n.flatMap(a=>a.errors);return e.filter(a=>!r.includes(a))}}class zi extends an{constructor(e){super(),this.i18n=e}mapMutationResultToPaymentSheetAction(e,n){var r;const a=this.mapCustomValidationFunctionErrorToAction(e.errors);if(a)return a;const i=this.getErrorActions(),o=e.errors,s=this.getUnhandledErrors(o,i);if(s.forEach(l=>{w.notify(new nn("[".concat(b.ApplePay,"] mutation result error not handled: ").concat(l)))}),((r=e.data)==null?void 0:r.deliveryGroups.length)===0&&n!=null&&n.shippingRequired)return{action:"show_error",errors:[new ApplePayError("addressUnserviceable")]};const{firstPaymentSheetAction:u}=this.getMergedPaymentSheetAction({result:e,errorActions:i});return u||(s.length>0?{action:"abort"}:{action:"update",errors:[]})}mapCompletionResultToPaymentSheetAction(e){if(!e.data)throw new Error("[".concat(b.ApplePay,"] completion returned null result"));switch(e.data.__typename){case"SubmitSuccess":return{action:"complete",redirectUrl:e.data.redirectUrl};case"SubmitAlreadyAccepted":case"SubmitThrottled":case"SubmitFailed":{const n=this.mapCustomValidationFunctionErrorToAction(e.errors);if(n)return n;const r=this.getErrorActions(),a=e.errors;this.getUnhandledErrors(a,r).forEach(o=>{w.notify(new Error("[".concat(b.ApplePay,"] completion result error not handled: ").concat(o)))});const{prioritizedPaymentSheetAction:i}=this.getMergedPaymentSheetAction({result:e,errorActions:r});return i||{action:"abort"}}default:throw new Error("[".concat(b.ApplePay,"] unknown completion result type: ").concat(e.data.__typename))}}getErrorActions(){return[{errors:[h.InvalidLanguage],generateAction:()=>({action:"abort",effects:[()=>{w.notify(new Error("[".concat(b.ApplePay,"] mutation provided invalid language, aborting")))}]})},{errors:[h.InvalidCountry],generateAction:()=>({action:"abort",effects:[()=>{w.notify(new Error("[".concat(b.ApplePay,"] mutation provided invalid country, aborting")))}]})},{errors:[h.MissingCartId],generateAction:()=>({action:"abort",effects:[()=>{w.notify(new Error("[".concat(b.ApplePay,"] mutation provided invalid cart ID, aborting")))}]})},{errors:[h.UnacceptablePaymentsAmount],generateAction:()=>({action:"abort"})},{errors:Gr,generateAction:()=>({action:"abort"})},{errors:zr,generateAction:()=>({action:"abort"})},{errors:[h.DeliveryNotAvailable,h.NoDeliveryGroupSelected],generateAction:()=>({action:"show_error",errors:[new ApplePayError("addressUnserviceable")]})},{errors:[h.BuyerIdentityEmailRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","emailAddress",this.i18n.translate("errors.missing.email"))]})},{errors:[h.DeliveryFirstNameRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.missing.first_name"))]})},{errors:[h.DeliveryFirstNameInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.invalid.first_name"))]})},{errors:[h.DeliveryLastNameRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.missing.last_name"))]})},{errors:[h.DeliveryLastNameInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.invalid.last_name"))]})},{errors:[h.DeliveryAddress1Required],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.missing.address1"))]})},{errors:[h.DeliveryAddress1Invalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.invalid.address1"))]})},{errors:[h.DeliveryAddress2Required,h.DeliveryAddress2AddressFieldRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.missing.address2"))]})},{errors:[h.DeliveryAddress2Invalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.invalid.address2"))]})},{errors:[h.DeliveryCityRequired,h.DeliveryCityAddressFieldRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.missing.city"))]})},{errors:[h.DeliveryCityInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.invalid.city"))]})},{errors:[h.DeliveryZoneRequiredForCountry],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","administrativeArea",this.i18n.translate("errors.missing.zone"))]})},{errors:[h.DeliveryZoneNotFound],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","administrativeArea",this.i18n.translate("errors.invalid.zone"))]})},{errors:[h.DeliveryPostalCodeRequired,h.DeliveryPostalCodeAddressFieldRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.missing.postal_code"))]})},{errors:[h.DeliveryPostalCodeInvalid,h.DeliveryInvalidPostalCodeForZone,h.DeliveryInvalidPostalCodeForCountry,h.DeliveryZipInvalidForCountry],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.invalid.postal_code"))]})},{errors:[h.DeliveryPhoneNumberRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","phoneNumber",this.i18n.translate("errors.missing.phone"))]})},{errors:[h.DeliveryPhoneNumberInvalid,h.BuyerIdentityInvalidPhone,h.DeliveryPhoneDoesNotMatchExpectedPattern],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","phoneNumber",this.i18n.translate("errors.invalid.phone"))]})},{errors:[h.BuyerIdentityInvalidCountry,h.DeliveryCountryInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","country",this.i18n.translate("errors.invalid.country"))]})},{errors:[h.InvalidPaymentApplePayBillingAddress],generateAction:()=>({action:"show_error",errors:[new ApplePayError("billingContactInvalid")]})},{errors:[h.DeliveryLastNameContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.emojis.last_name"))]})},{errors:[h.DeliveryFirstNameContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.emojis.first_name"))]})},{errors:[h.DeliveryAddress1TooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.too_long.address1"))]})},{errors:[h.DeliveryAddress2TooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.too_long.address2"))]})},{errors:[h.DeliveryFirstNameTooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.too_long.first_name"))]})},{errors:[h.DeliveryLastNameTooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.too_long.last_name"))]})},{errors:[h.DeliveryCityTooLong],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.too_long.city"))]})},{errors:[h.DeliveryFirstNameContainsUrl],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.url.first_name"))]})},{errors:[h.DeliveryLastNameContainsUrl],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.url.last_name"))]})},{errors:[h.DeliveryAddress1ContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.html_tags.address1"))]})},{errors:[h.DeliveryAddress2ContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.html_tags.address2"))]})},{errors:[h.DeliveryCityContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.html_tags.city"))]})},{errors:[h.DeliveryFirstNameContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.html_tags.first_name"))]})},{errors:[h.DeliveryLastNameContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.html_tags.last_name"))]})},{errors:[h.DeliveryCityContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.emojis.city"))]})},{errors:[h.DeliveryAddress1ContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.emojis.address1"))]})},{errors:[h.DeliveryAddress2ContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.emojis.address2"))]})},{errors:[h.DeliveryPostalCodeContainsEmojis],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.emojis.postal_code"))]})},{errors:[h.BuyerIdentityEmailInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","emailAddress",this.i18n.translate("errors.invalid.email"))]})}]}mapCustomValidationFunctionErrorToAction(e){const n=e.find(r=>typeof r=="object"&&(r==null?void 0:r.code)===Ze);return n?{action:"abort",effects:[()=>{const r=this.i18n.translate("brand.apple_pay");qt(this.i18n.translate("error_dialogs.wallet.title",{wallet:r}),n.message)}]}:null}}const mr=["name","postalAddress"];function Vi({shippingRequired:t,walletParams:e,buyerCurrency:n}){const{phoneRequired:r,emailRequired:a}=e,i=[...a?["email"]:[],...r?["phone"]:[]],o=t?[...mr,...i]:i;return{countryCode:e.countryCode,currencyCode:n,merchantCapabilities:e.merchantCapabilities,supportedNetworks:e.supportedNetworks,total:{type:"pending",label:e.merchantName,amount:"1.00"},requiredBillingContactFields:mr,requiredShippingContactFields:o,shippingType:e.shippingType}}const qi=t=>{const e=t.lineItems.flatMap(n=>n.discountAllocations);return[...t.discountCodes.filter(n=>n.applicable&&t.discountAllocations.findIndex(r=>r.code===n.code)===-1&&e.findIndex(r=>r.code===n.code)===-1).map(n=>({code:n.code,discountedAmount:{amount:"0",currencyCode:t.totalAmount.currencyCode}})),...t.discountAllocations,...e]},on=t=>{const e=t.lineItems.reduce((n,r)=>n+Number(r.subtotalAmount.amount),0);return{amount:String(e),currencyCode:t.totalAmount.currencyCode}};function ji(t,e){return t.reduce((n,r)=>{if(!r.sellingPlanAllocation)return n;const{sellingPlanAllocation:{sellingPlan:a,priceAdjustments:i},quantity:o}=r;if(!a.recurringDeliveries||!a.billingPolicy)return n;const s=Wi({billingPolicy:a.billingPolicy,i18n:e});if(i.length===0){const u=Ye({price:Number(r.subtotalAmount.amount)*o,currencyCode:r.subtotalAmount.currencyCode,locale:e.locale});return[...n,e.translate("order_summary.subscriptions.recurring_totals",{fixedPrice:u,interval:s})]}else if(i.length===1){const u=Ye({price:Number(i[0].price.amount)*o,currencyCode:i[0].price.currencyCode,locale:e.locale});return[...n,e.translate("order_summary.subscriptions.recurring_totals",{fixedPrice:u,interval:s})]}else if(i.length===2){const u=Ye({price:Number(i[0].price.amount)*o,currencyCode:i[0].price.currencyCode,locale:e.locale}),l=Ye({price:Number(i[1].price.amount)*o,currencyCode:i[1].price.currencyCode,locale:e.locale}),d=a.priceAdjustments[0].orderCount;return[...n,e.translate("order_summary.subscriptions.recurring_totals_with_policies",{count:d,fixedPrice:u,recurringPrice:l,interval:s})]}return n},[])}function Ye({price:t,currencyCode:e,locale:n}){return Intl.NumberFormat(n,{style:"currency",currency:e,currencyDisplay:"narrowSymbol"}).format(t)}function Wi({billingPolicy:t,i18n:e}){const{interval:n,intervalCount:r}=t,a={YEAR:"order_summary.subscriptions.recurring_total_intervals.year",MONTH:"order_summary.subscriptions.recurring_total_intervals.month",WEEK:"order_summary.subscriptions.recurring_total_intervals.week",DAY:"order_summary.subscriptions.recurring_total_intervals.day"}[n];if(!a)throw new Error("Unknown selling plan interval provided: ".concat(n));return e.translate(a,{count:r})}const ht="GraphQL Client",yr=0,gr=3,sn="An error occurred while fetching from the API. Review 'graphQLErrors' for details.",ln="Response returned unexpected Content-Type:",cn="An unknown error has occurred. The API did not return a data object or any errors in its response.",Ot={json:"application/json",multipart:"multipart/mixed"},fr="X-SDK-Variant",br="X-SDK-Version",Yi="shopify-graphql-client",Ki="1.2.0",dn=1e3,Ji=[429,503],un=/@(defer)\b/i,wr="\r\n",Zi=/boundary="?([^=";]+)"?/i,Ar=wr+wr;function X(t,e=ht){return t.startsWith("".concat(e))?t:"".concat(e,": ").concat(t)}function Ne(t){return t instanceof Error?t.message:JSON.stringify(t)}function hn(t){return t instanceof Error&&t.cause?t.cause:void 0}function pn(t){return t.flatMap(({errors:e})=>e!=null?e:[])}function mn({client:t,retries:e}){if(e!==void 0&&(typeof e!="number"||e<yr||e>gr))throw new Error("".concat(t,': The provided "retries" value (').concat(e,") is invalid - it cannot be less than ").concat(yr," or greater than ").concat(gr))}function k(t,e){return e&&(typeof e!="object"||Array.isArray(e)||typeof e=="object"&&Object.keys(e).length>0)?{[t]:e}:{}}function yn(t,e){if(t.length===0)return e;const n={[t.pop()]:e};return t.length===0?n:yn(t,n)}function gn(t,e){return Object.keys(e||{}).reduce((n,r)=>(typeof e[r]=="object"||Array.isArray(e[r]))&&t[r]?(n[r]=gn(t[r],e[r]),n):(n[r]=e[r],n),Array.isArray(t)?[...t]:_({},t))}function fn([t,...e]){return e.reduce(gn,_({},t))}function Qi({clientLogger:t,customFetchApi:e=fetch,client:n=ht,defaultRetryWaitTime:r=dn,retriableCodes:a=Ji}){const i=async(o,s,u)=>{const l=s+1,d=u+1;let p;try{if(p=await e(...o),t({type:"HTTP-Response",content:{requestParams:o,response:p}}),!p.ok&&a.includes(p.status)&&l<=d)throw new Error;return p}catch(y){if(l<=d){const m=p==null?void 0:p.headers.get("Retry-After");return await Xi(m?parseInt(m,10):r),t({type:"HTTP-Retry",content:{requestParams:o,lastResponse:p,retryAttempt:s,maxRetries:u}}),i(o,l,u)}throw new Error(X("".concat(u>0?"Attempted maximum number of ".concat(u," network retries. Last message - "):"").concat(Ne(y)),n))}};return i}async function Xi(t){return new Promise(e=>setTimeout(e,t))}function eo({headers:t,url:e,customFetchApi:n=fetch,retries:r=0,logger:a}){mn({client:ht,retries:r});const i={headers:t,url:e,retries:r},o=to(a),s=Qi({customFetchApi:n,clientLogger:o,defaultRetryWaitTime:dn}),u=ro(s,i),l=no(u),d=uo(u);return{config:i,fetch:u,request:l,requestStream:d}}function to(t){return e=>{t&&t(e)}}async function bn(t){const{errors:e,data:n,extensions:r}=await t.json();return _(D(_(_({},k("data",n)),k("extensions",r)),{headers:t.headers}),e||!n?{errors:D(_({networkStatusCode:t.status,message:X(e?sn:cn)},k("graphQLErrors",e)),{response:t})}:{})}function ro(t,{url:e,headers:n,retries:r}){return async(a,i={})=>{const{variables:o,headers:s,url:u,retries:l,signal:d}=i,p=JSON.stringify({query:a,variables:o});mn({client:ht,retries:l});const y=Object.entries(_(_({},n),s)).reduce((C,[f,I])=>(C[f]=Array.isArray(I)?I.join(", "):I.toString(),C),{});!y[fr]&&!y[br]&&(y[fr]=Yi,y[br]=Ki);const m=[u!=null?u:e,{method:"POST",headers:y,body:p,signal:d}];return t(m,1,l!=null?l:r)}}function no(t){return async(...e)=>{if(un.test(e[0]))throw new Error(X("This operation will result in a streamable response - use requestStream() instead."));try{const n=await t(...e),{status:r,statusText:a}=n,i=n.headers.get("content-type")||"";return n.ok?i.includes(Ot.json)?bn(n):{errors:{networkStatusCode:r,message:X("".concat(ln," ").concat(i)),response:n}}:{errors:{networkStatusCode:r,message:X(a),response:n}}}catch(n){return{errors:{message:Ne(n)}}}}}function ao(t){return fe(this,null,function*(){const e=new TextDecoder;if(t.body[Symbol.asyncIterator])try{for(var n=V(t.body),r,a,i;r=!(a=yield new z(n.next())).done;r=!1){const o=a.value;yield e.decode(o)}}catch(o){i=[o]}finally{try{r&&(a=n.return)&&(yield new z(a.call(n)))}finally{if(i)throw i[0]}}else{const o=t.body.getReader();let s;try{for(;!(s=yield new z(o.read())).done;)yield e.decode(s.value)}finally{o.cancel()}}})}function io(t,e){return{[Symbol.asyncIterator](){return fe(this,null,function*(){try{let o="";try{for(var n=V(t),r,a,i;r=!(a=yield new z(n.next())).done;r=!1){const s=a.value;if(o+=s,o.indexOf(e)>-1){const u=o.lastIndexOf(e),l=o.slice(0,u).split(e).filter(d=>d.trim().length>0).map(d=>d.slice(d.indexOf(Ar)+Ar.length).trim());l.length>0&&(yield l),o=o.slice(u+e.length),o.trim()==="--"&&(o="")}}}catch(s){i=[s]}finally{try{r&&(a=n.return)&&(yield new z(a.call(n)))}finally{if(i)throw i[0]}}}catch(o){throw new Error("Error occured while processing stream payload - ".concat(Ne(o)))}})}}}function oo(t){return{[Symbol.asyncIterator](){return fe(this,null,function*(){const e=yield new z(bn(t));yield D(_({},e),{hasNext:!1})})}}}function so(t){return t.map(e=>{try{return JSON.parse(e)}catch(n){throw new Error("Error in parsing multipart response - ".concat(Ne(n)))}}).map(e=>{const{data:n,incremental:r,hasNext:a,extensions:i,errors:o}=e;if(!r)return D(_(_({data:n||{}},k("errors",o)),k("extensions",i)),{hasNext:a});const s=r.map(({data:u,path:l,errors:d})=>_({data:u&&l?yn(l,u):{}},k("errors",d)));return D(_({data:s.length===1?s[0].data:fn([...s.map(({data:u})=>u)])},k("errors",pn(s))),{hasNext:a})})}function lo(t,e){if(t.length>0)throw new Error(sn,{cause:{graphQLErrors:t}});if(Object.keys(e).length===0)throw new Error(cn)}function co(t,e){var n;const r=(e!=null?e:"").match(Zi),a="--".concat(r?r[1]:"-");if(!((n=t.body)!=null&&n.getReader)&&!t.body[Symbol.asyncIterator])throw new Error("API multipart response did not return an iterable body",{cause:t});const i=ao(t);let o={},s;return{[Symbol.asyncIterator](){return fe(this,null,function*(){var u,l;try{let C=!0;try{for(var d=V(io(i,a)),p,y,m;p=!(y=yield new z(d.next())).done;p=!1){const f=y.value,I=so(f);s=(l=(u=I.find(Z=>Z.extensions))==null?void 0:u.extensions)!=null?l:s;const B=pn(I);o=fn([o,...I.map(({data:Z})=>Z)]),C=I.slice(-1)[0].hasNext,lo(B,o),yield D(_(_({},k("data",o)),k("extensions",s)),{hasNext:C})}}catch(f){m=[f]}finally{try{p&&(y=d.return)&&(yield new z(y.call(d)))}finally{if(m)throw m[0]}}if(C)throw new Error("Response stream terminated unexpectedly")}catch(C){const f=hn(C);yield D(_(_({},k("data",o)),k("extensions",s)),{errors:D(_({message:X(Ne(C)),networkStatusCode:t.status},k("graphQLErrors",f==null?void 0:f.graphQLErrors)),{response:t}),hasNext:!1})}})}}}function uo(t){return async(...e)=>{if(!un.test(e[0]))throw new Error(X("This operation does not result in a streamable response - use request() instead."));try{const n=await t(...e),{statusText:r}=n;if(!n.ok)throw new Error(r,{cause:n});const a=n.headers.get("content-type")||"";switch(!0){case a.includes(Ot.json):return oo(n);case a.includes(Ot.multipart):return co(n,a);default:throw new Error("".concat(ln," ").concat(a),{cause:n})}}catch(n){return{[Symbol.asyncIterator](){return fe(this,null,function*(){const r=hn(n);yield{errors:_(_({message:X(Ne(n))},k("networkStatusCode",r==null?void 0:r.status)),k("response",r)),hasNext:!1}})}}}}}const ho="mutation cartCreate($input:CartInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartCreate(input:$input){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",po="mutation cartAttributesUpdate($cartId:ID!$attributes:[AttributeInput!]!$country:CountryCode=CA$language:LanguageCode=EN$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartAttributesUpdate(cartId:$cartId attributes:$attributes){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",mo="mutation cartBillingAddressUpdate($cartId:ID!$billingAddress:MailingAddressInput$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartBillingAddressUpdate(cartId:$cartId billingAddress:$billingAddress){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",yo="mutation cartBuyerIdentityUpdate($cartId:ID!$buyerIdentity:CartBuyerIdentityInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartBuyerIdentityUpdate(cartId:$cartId buyerIdentity:$buyerIdentity){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",go="mutation cartSelectedDeliveryOptionsUpdate($cartId:ID!$selectedDeliveryOptions:[CartSelectedDeliveryOptionInput!]!$country:CountryCode=CA$language:LanguageCode=EN$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartSelectedDeliveryOptionsUpdate(cartId:$cartId selectedDeliveryOptions:$selectedDeliveryOptions){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",fo="mutation applePaySessionCreate($validationUrl:URL!){applePaySessionCreate(validationUrl:$validationUrl){...@defer{applePaySession{body}}}}",bo="mutation PayPalBuyerDetailsFetch($token:String!$cartId:ID){paypalBuyerDetailsFetch(token:$token cartId:$cartId){...@defer{paypalDetails{email expiresAt destinationAddress{...on MailingAddress{address1 address2 city company country firstName lastName phone province zip}}billingAddress{...on MailingAddress{address1 address2 city company country firstName lastName phone province zip}}}}}}",wo="mutation PayPalTokenCreate($cartId:ID!){paypalTokenCreate(cartId:$cartId){...@defer{paypalToken{token}}}}",Ao="query cartQuery($id:ID!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){cart(id:$id){...@defer(if:$withCarrierRates){...CartParts}}}",_o="query subscriptionPolicyQuery($country:CountryCode$language:LanguageCode)@inContext(country:$country language:$language){shop{subscriptionPolicy(sanitized:true){body}}}",Co="mutation cartPaymentUpdate($cartId:ID!$input:CartPaymentInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartPaymentUpdate(cartId:$cartId payment:$input){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",_t="fragment CartParts on Cart{id checkoutUrl buyerIdentity{deliveryAddressPreferences{...on MailingAddress{address1 address2 city province phone country firstName lastName zip}}}deliveryGroups(first:10 withCarrierRates:$withCarrierRates){edges{node{id groupType selectedDeliveryOption{code title description handle estimatedCost{amount currencyCode}}deliveryOptions{code title description estimatedCost{amount currencyCode}handle}}}}cost{subtotalAmount{amount currencyCode}totalAmount{amount currencyCode}totalTaxAmount{amount currencyCode}totalDutyAmount{amount currencyCode}}discountAllocations{discountedAmount{amount currencyCode}...on CartCodeDiscountAllocation{code}...on CartAutomaticDiscountAllocation{title}...on CartCustomDiscountAllocation{title}}discountCodes{code applicable}lines(first:10){edges{node{quantity cost{subtotalAmount{amount currencyCode}totalAmount{amount currencyCode}}discountAllocations{discountedAmount{amount currencyCode}...on CartCodeDiscountAllocation{code}...on CartAutomaticDiscountAllocation{title}...on CartCustomDiscountAllocation{title}}merchandise{...on ProductVariant{requiresShipping}}sellingPlanAllocation{priceAdjustments{price{amount currencyCode}}sellingPlan{billingPolicy{...on SellingPlanRecurringBillingPolicy{interval intervalCount}}priceAdjustments{orderCount}recurringDeliveries}}}}}}",So="mutation cartSubmitForCompletion($cartId:ID!$attemptToken:String!$country:CountryCode$language:LanguageCode)@inContext(country:$country language:$language){cartSubmitForCompletion(cartId:$cartId attemptToken:$attemptToken){result{__typename ...on SubmitSuccess{redirectUrl}...on SubmitThrottled{pollAfterV2:pollAfter}...on SubmitFailed{errors{code message}}}errors:userErrors{...on CartUserError{code field message}}}}",Eo="unstable",_r="RESTRICTED_WALLET_ACCOUNT";class be extends Error{constructor(e="No response"){super(e),this.name="NoResponseError"}}class pt{constructor({accessToken:e,country:n,locale:r,apiVersion:a=Eo,withCarrierRates:i=!1}){if(c(this,"OPERATION_NAME_REGEX",/[^ ]+ (\w+)/),c(this,"client"),c(this,"country"),c(this,"url"),c(this,"locale"),c(this,"withCarrierRates"),c(this,"lastValidCart"),!e)throw new Error("StorefrontApiClient constructed with no access token");if(!n)throw new Error("StorefrontApiClient constructed with no buyer country");if(!r)throw new Error("StorefrontApiClient constructed with no locale");this.country=n,this.locale=r,this.withCarrierRates=i,this.url="/api/".concat(a,"/graphql.json"),this.client=eo({headers:{"Content-Type":"application/json",Accept:"application/json","X-Shopify-Storefront-Access-Token":e,"X-SDK-Variant":"portable-wallets"},url:this.url,retries:0,logger:o=>{if(o.type==="HTTP-Response"){const[s,u]=o.content.requestParams;w.leaveBreadcrumb("POST: ".concat(s),{statusCode:o.content.response.status,statusText:o.content.response.statusText,url:s,method:u==null?void 0:u.method,headers:u==null?void 0:u.headers,body:u==null?void 0:u.body},"request")}}})}async createCart(e){var n,r,a,i,o,s;const u=await this.requestStream([ho,_t],{input:{lines:[{merchandiseId:e.merchandiseId,quantity:e.quantity,sellingPlanId:e.sellingPlanId,attributes:e.lineItemProperties}],discountCodes:e.discountCodes,buyerIdentity:e.buyerIdentity},country:this.country,language:this.formatLanguage(this.locale)},{instrumentName:e.instrumentName,startingCheckout:!0});try{for(var l=V(u),d,p,y;d=!(p=await l.next()).done;d=!1){const m=p.value;m.errors&&this.onError(m.errors);const C=(r=(n=m.data)==null?void 0:n.result)==null?void 0:r.cart;if(C&&!m.hasNext)return(i=(a=m.data)==null?void 0:a.result)!=null&&i.errors&&this.onResultError((s=(o=m.data)==null?void 0:o.result)==null?void 0:s.errors),{data:this.parseCartResponse(C),errors:this.parseMutationErrors(m,"result")}}}catch(m){y=[m]}finally{try{d&&(p=l.return)&&await p.call(l)}finally{if(y)throw y[0]}}throw new be("Cart create operation returned no response")}async updateCartBillingAddress(e){const{cartId:n,billingAddress:r,instrumentName:a}=e;return this.requestDeferredCart(mo,{cartId:n,billingAddress:r},{instrumentName:a})}async updateCartBuyerIdentity(e,n){const{cartId:r,emailAddress:a,streetAddress:i,countryCode:o,phone:s,preferences:u,instrumentName:l}=e;return this.requestDeferredCart(yo,{cartId:r,buyerIdentity:{email:a,countryCode:o!=null?o:i==null?void 0:i.country,phone:s!=null?s:i==null?void 0:i.phone,deliveryAddressPreferences:i?[{deliveryAddressValidationStrategy:e.validateAddress?"STRICT":"COUNTRY_CODE_ONLY",deliveryAddress:i}]:[],preferences:u}},{instrumentName:l,abortSignal:n})}async updateSelectedDeliveryOptions(e,n,r,a){let i=n;const o=Date.now()+2e4;for(;Date.now()<o;){const s=await this.requestDeferredCart(go,{cartId:e,selectedDeliveryOptions:i},{instrumentName:r,abortSignal:a});if(!s.errors.some(l=>typeof l=="string"&&l.startsWith(h.PendingDeliveryGroups)))return s;const u=s.data.deliveryGroups.flatMap(l=>l.deliveryOptions.map(d=>({deliveryOptionHandle:d.handle,deliveryGroupId:l.id})));i=i.map(l=>{var d;return(d=u.find(p=>p.deliveryOptionHandle===l.deliveryOptionHandle))!=null?d:l})}throw new Error("Selected delivery options update operation timed out")}async applePaySessionCreate(e){var n,r,a;const i=await this.requestStream([fo],{validationUrl:e.toString()},{instrumentName:b.ApplePay});try{for(var o=V(i),s,u,l;s=!(u=await o.next()).done;s=!1){const d=u.value;d.errors&&this.onError(d.errors);const p=(a=(r=(n=d.data)==null?void 0:n.applePaySessionCreate)==null?void 0:r.applePaySession)==null?void 0:a.body;if(p)return p}}catch(d){l=[d]}finally{try{s&&(u=o.return)&&await u.call(o)}finally{if(l)throw l[0]}}throw new be("Apple Pay session create operation returned no response")}async paypalBuyerDetailsFetch(e,n){var r,a;const i=await this.requestStream([bo],{token:e,cartId:n},{instrumentName:b.PayPal});try{for(var o=V(i),s,u,l;s=!(u=await o.next()).done;s=!1){const d=u.value;if(d.hasNext)continue;d.errors&&this.onError(d.errors);const p=(a=(r=d.data)==null?void 0:r.paypalBuyerDetailsFetch)==null?void 0:a.paypalDetails;if(p)return p}}catch(d){l=[d]}finally{try{s&&(u=o.return)&&await u.call(o)}finally{if(l)throw l[0]}}throw new be("PayPal buyer details fetch operation returned no response")}async paypalTokenCreate(e){var n,r,a,i;const o=await this.requestStream([wo],{cartId:e},{instrumentName:b.PayPal});try{for(var s=V(o),u,l,d;u=!(l=await s.next()).done;u=!1){const p=l.value;if(p.errors){if((n=p.errors.graphQLErrors)!=null&&n.find(m=>{var C;return((C=m.extensions)==null?void 0:C.code)===_r}))throw new ze({message:_r});this.onError(p.errors)}const y=(i=(a=(r=p.data)==null?void 0:r.paypalTokenCreate)==null?void 0:a.paypalToken)==null?void 0:i.token;if(y)return y}}catch(p){d=[p]}finally{try{u&&(l=s.return)&&await l.call(s)}finally{if(d)throw d[0]}}throw new be("PayPal token create operation returned no response")}async fetchCart({id:e,startingCheckout:n,instrumentName:r}){var a;const i=this.formatLanguage(this.locale),o=await this.requestStream([Ao,_t],{id:e,country:this.country,language:i,withCarrierRates:this.withCarrierRates},{instrumentName:r,startingCheckout:n});try{for(var s=V(o),u,l,d;u=!(l=await s.next()).done;u=!1){const p=l.value;p.errors&&this.onError(p.errors);const y=(a=p.data)==null?void 0:a.cart;if(w.leaveBreadcrumb("Fetch cart response",{body:y,hasNext:p.hasNext},"log"),y&&!p.hasNext){const m=this.parseCartResponse(y);return this.lastValidCart=m,m}}}catch(p){d=[p]}finally{try{u&&(l=s.return)&&await l.call(s)}finally{if(d)throw d[0]}}throw new be("Cart fetch operation returned no response")}async updateCartPayment(e,n,r,a){var i,o;const s={cartId:e,input:n},{amount:u,currencyCode:l}=n.amount;let d;const p=Date.now()+1e4;for(;Date.now()<p;){const y=await this.requestDeferredCart(Co,s,{instrumentName:r,abortSignal:a});if(d||(d=y),y.errors.includes(h.InvalidPaymentAmount)){parseFloat((o=(i=y.data.totalTaxAmount)==null?void 0:i.amount)!=null?o:"0")===0&&await new Promise(m=>setTimeout(m,500)),s.input.amount={amount:y.data.totalAmount.amount,currencyCode:y.data.totalAmount.currencyCode};continue}return(y.data.totalAmount.amount===u||parseFloat(y.data.totalAmount.amount)<=parseFloat(u))&&y.data.totalAmount.currencyCode===l?y:d}throw new Error("Payment update operation timed out")}async updateCartAttributes({cartId:e,attributes:n,instrumentName:r,startingCheckout:a}){const i={cartId:e,attributes:n};return await this.requestDeferredCart(po,i,{instrumentName:r,startingCheckout:a})}async submitForCompletion(e,n,r){var a,i;const o=this.formatLanguage(this.locale),s=await this.request([So],{cartId:e,attemptToken:n,country:this.country,language:o,withCarrierRates:this.withCarrierRates},{instrumentName:r});return{data:(i=(a=s.data)==null?void 0:a.cartSubmitForCompletion)==null?void 0:i.result,errors:this.parseCompletionErrors(s)}}async fetchSubscriptionPolicy(){var e,n;const{data:r}=await this.request([_o],{country:this.country,language:this.formatLanguage(this.locale)},{});return(n=(e=r==null?void 0:r.shop)==null?void 0:e.subscriptionPolicy)==null?void 0:n.body}generateURLWithOperationName(e){const n=e.match(this.OPERATION_NAME_REGEX);if(n){const r=this.url.includes("?")?"&":"?",a="operation_name=".concat(n[1]);return"".concat(this.url).concat(r).concat(a)}return this.url}async request(e,n,r){return this.client.request(e.join(""),{variables:n,headers:Cr(r),url:this.generateURLWithOperationName(e[0])})}async requestStream(e,n,r){return this.client.requestStream(e.join(""),{variables:n,headers:Cr(r),url:this.generateURLWithOperationName(e[0]),signal:r.abortSignal})}async requestDeferredCart(e,n,r){var a,i,o,s,u,l;const d=this.formatLanguage(this.locale),p=await this.requestStream([e,_t],D(_({},n),{country:this.country,language:d,withCarrierRates:this.withCarrierRates}),r);try{for(var y=V(p),m,C,f;m=!(C=await y.next()).done;m=!1){const I=C.value;I.errors&&this.onError(I.errors);const B=(i=(a=I.data)==null?void 0:a.result)==null?void 0:i.cart;if(B&&!I.hasNext)return{data:await this.fetchCart({id:B.id,instrumentName:r.instrumentName,startingCheckout:!1}),errors:this.parseMutationErrors(I,"result")};if(this.lastValidCart&&(s=(o=I.data)==null?void 0:o.result)!=null&&s.errors)return this.onResultError((l=(u=I.data)==null?void 0:u.result)==null?void 0:l.errors),{data:this.lastValidCart,errors:this.parseMutationErrors(I,"result")}}}catch(I){f=[I]}finally{try{m&&(C=y.return)&&await C.call(y)}finally{if(f)throw f[0]}}throw new be("Deferred cart operation returned no response")}onError(e){var n,r;if(!e)return;w.leaveBreadcrumb("GraphQL response error",e,"error");const a=(r=(n=e.graphQLErrors)==null?void 0:n.map(s=>s.message).join(", "))!=null?r:"",i="".concat(e.message).concat(a.length>0?" - ".concat(a):""),o=e!=null&&e.networkStatusCode?"with status ".concat(e.networkStatusCode," => ").concat(i):"=> ".concat(i);throw new Error("GraphQL mutation failed ".concat(o))}onResultError(e){w.leaveBreadcrumb("GraphQL result error",e,"error")}formatLanguage(e){return e.includes("-")?e.split("-")[0].toUpperCase():e.toUpperCase()}parseCartResponse(e){var n,r,a;const i=e.lines.edges.map(s=>{var u,l;const d=s.node;return{quantity:d.quantity,totalAmount:{amount:d.cost.totalAmount.amount,currencyCode:d.cost.totalAmount.currencyCode},subtotalAmount:{amount:(u=d.cost.subtotalAmount)==null?void 0:u.amount,currencyCode:(l=d.cost.subtotalAmount)==null?void 0:l.currencyCode},merchandise:{requiresShipping:d.merchandise.requiresShipping},discountAllocations:d.discountAllocations,sellingPlanAllocation:d.sellingPlanAllocation}}),o=e.deliveryGroups.edges.map(s=>s.node);return{id:e.id,totalAmount:e.cost.totalAmount,subtotalAmount:(n=e.cost.subtotalAmount)!=null?n:void 0,totalTaxAmount:(r=e.cost.totalTaxAmount)!=null?r:void 0,totalDutyAmount:(a=e.cost.totalDutyAmount)!=null?a:void 0,discountAllocations:e.discountAllocations,discountCodes:e.discountCodes,lineItems:i,deliveryGroups:o,checkoutUrl:e.checkoutUrl}}parseGraphQlErrors(e){var n,r;return(r=(n=e==null?void 0:e.graphQLErrors)==null?void 0:n.map(a=>a.message.replace(/\(Expected.*\)/,"").trim()))!=null?r:[]}parseMutationErrors(e,n){var r,a,i;const o=this.parseGraphQlErrors(e.errors),s=((i=(a=(r=e.data)==null?void 0:r[n])==null?void 0:a.errors)==null?void 0:i.map(l=>l.code===Ze?{code:Ze,message:l.message}:l.field&&l.field.length>0?"".concat(l.code,": ").concat(l.field.join(".")):l.code).filter(l=>l))||[],u=[...o,...s];return w.leaveBreadcrumb("GraphQL errors on mutation",u,"error"),u}parseCompletionErrors(e){var n,r,a,i;const o=this.parseGraphQlErrors(e.errors);let s=[];((a=(r=(n=e.data)==null?void 0:n.cartSubmitForCompletion)==null?void 0:r.result)==null?void 0:a.__typename)==="SubmitFailed"&&(s=(i=e.data.cartSubmitForCompletion.result.errors.map(l=>l.code))!=null?i:[]);const u=[...o,...s];return w.leaveBreadcrumb("GraphQL errors on completion",u,"error"),u}}function Cr({instrumentName:t,startingCheckout:e}){const n={};return t&&(n["X-Wallet-Name"]="".concat(t)),e&&(n["X-Start-Wallet-Checkout"]="".concat(e)),n}async function wn({cartId:t,cartClient:e,instrumentName:n,selectedDeliveryOptions:r,abortSignal:a}){try{if(!t)throw new Error("[".concat(n,"] provided no cart ID when updating shipping method"));if(!e)throw new Error("[".concat(n,"] provided invalid cart client when updating shipping method"));return await e.updateSelectedDeliveryOptions(t,r,n,a)}catch(i){throw g.updateFailed(n,"updateSelectedDeliveryOptions"),i}}async function An({cartId:t,token:e,cartClient:n,instrumentName:r}){try{if(!t)throw new Error("[".concat(r,"] provided no cart ID when submitting for completion"));if(!n)throw new Error("[".concat(r,"] provided invalid cart client when submitting for completion"));if(!e)throw new Error("[".concat(r,"] provided no token when submitting for completion"));return await n.submitForCompletion(t,e,r)}catch(a){throw g.updateFailed(r,"submitForCompletion"),a}}function _n({selectedDeliveryOptionHandles:t,deliveryGroups:e,instrumentName:n}){return e.map(r=>{const a=r.deliveryOptions.filter(i=>t.includes(i.handle));if(!a.length)throw new Error("[".concat(n,"] could not find delivery option for group: ").concat(r.id));if(a.length>1)throw new Error("[".concat(n,"] found multiple delivery options with selectedDeliverOptionHandle in group: ").concat(r.id));return{deliveryGroupId:r.id,deliveryOptionHandle:a[0].handle}})}async function Io(t){const{cartClient:e,instrumentName:n}=t;try{if(!t.cartId)throw new Error("[".concat(n,"] provided no cart ID when updating billing address"));if(!e)throw new Error("[".concat(n,"] provided invalid cart client when updating billing address"));return await e.updateCartBillingAddress(t)}catch(r){throw g.updateFailed(n,"updateBillingAddress"),r}}class vo{constructor({accessToken:e,buyerCountry:n,buyerCurrency:r,button:a,i18n:i,merchantName:o,dataSource:s,apiClient:u,walletParams:l}){c(this,"name",b.ApplePay),c(this,"accessToken"),c(this,"button"),c(this,"buyerCountry"),c(this,"cart"),c(this,"apiClient"),c(this,"dataSource"),c(this,"i18n"),c(this,"merchantName"),c(this,"session"),c(this,"paymentSheetActionGenerator"),c(this,"cancelled"),c(this,"buyerCurrency"),c(this,"customerAccountEmail"),c(this,"abortController",null),c(this,"onvalidatemerchant",async d=>{try{const p=new URL(d.validationURL),y=this.getMerchantSession(p),{cart:m,outOfStock:C}=await ne({element:this.button,instrumentName:this.name,dataSource:this.dataSource});this.cart=m;const f=await y;if(w.leaveBreadcrumb("ApplePay Session completeMerchantValidation",{session:f},"log"),C){this.abortAndShowOutOfStockError();return}if(this.sessionIsCancelled())return;this.session.completeMerchantValidation(f)}catch(p){g.sheetClicked({instrument:b.ApplePay,result:"failed"}),this.terminateSession(p)}}),c(this,"onshippingcontactselected",async d=>{try{const p=We(d.shippingContact),y=await Ce({cartId:this.cart.id,streetAddress:p,cartClient:this.apiClient,instrumentName:this.name});if(!y.data)throw new Error("Missing cart during Apple Pay Session creation");if(this.shouldDecelerate(y.data))return;await this.applyPaymentSheetActions(y,m=>this.completeShippingContactSelection(y.data,m),{shippingRequired:this.isShippingRequired})}catch(p){this.terminateSession(p)}}),c(this,"onshippingmethodselected",async d=>{var p;try{const y=d.shippingMethod.identifier.split(","),m=_n({selectedDeliveryOptionHandles:y,deliveryGroups:this.cart.deliveryGroups,instrumentName:this.name}),C=await wn({cartId:this.cart.id,cartClient:this.apiClient,instrumentName:this.name,selectedDeliveryOptions:m,abortSignal:(p=this.abortController)==null?void 0:p.signal});await this.applyPaymentSheetActions(C,()=>this.completeShippingMethodSelection(C.data))}catch(y){this.terminateSession(y)}}),c(this,"onpaymentmethodselected",async d=>{try{const{billingContact:p}=d.paymentMethod;if(!this.isShippingRequired&&p){const C=We(p),f=await Ce({cartId:this.cart.id,countryCode:C.country,cartClient:this.apiClient,instrumentName:this.name});if(!f.data)throw new Error("Missing cart during Apple Pay Session creation");if(this.shouldDecelerate(f.data))return;await this.applyPaymentSheetActions(f,()=>this.cart=f.data);const I=await Io({billingAddress:C,cartId:this.cart.id,cartClient:this.apiClient,instrumentName:this.name});await this.applyPaymentSheetActions(I,()=>this.cart=I.data)}const{newTotal:y,newLineItems:m}=this.getNewTotalAndLineItems(this.cart);if(w.leaveBreadcrumb("ApplePay Session completePaymentMethodSelection",{newTotal:y,newLineItems:m},"log"),this.sessionIsCancelled())return;this.session.completePaymentMethodSelection({newTotal:y,newLineItems:m})}catch(p){this.terminateSession(p)}}),c(this,"oncancel",()=>{var d;this.cancelled=!0,g.sheetCancelled(this.name),this.button.disabled=!1,(d=this.abortController)==null||d.abort()}),c(this,"onpaymentauthorized",async d=>{g.authorizationAttempt(this.name),qe(T.AuthorizationLatency,this.name);const p=O=>{g.authorizationComplete({instrument:this.name,measurement:J(T.AuthorizationLatency,this.name),result:"failure"}),this.terminateSession(O)},y=async O=>{var F,Te;switch((F=O.effects)==null||F.forEach(A=>A()),O.action){case"complete":{const A=ApplePaySession.STATUS_SUCCESS;try{await this.completePayment(A),ee(O.redirectUrl)}catch(M){p(M)}break}case"show_error":{const A=(Te=O.errors)!=null?Te:[];try{await this.completePayment(ApplePaySession.STATUS_FAILURE,A)}catch(M){p(M)}break}case"abort":{try{await this.completePayment(ApplePaySession.STATUS_FAILURE),this.button.disabled=!1}catch(A){p(A)}break}default:p(new Error("[".concat(this.name,"] completion action not handled: ").concat(O.action)))}},{token:m,billingContact:C,shippingContact:f}=d.payment;let I=null,B=null;try{if(!C){await this.completePayment(ApplePaySession.STATUS_FAILURE);return}if(I=We(D(_({},C),{phoneNumber:f==null?void 0:f.phoneNumber})),this.isShippingRequired){if(!f){await this.completePayment(ApplePaySession.STATUS_FAILURE);return}B=We(f)}}catch(O){p(O);return}const Z=async()=>{var O;try{const F=this.isShippingRequired?{validateAddress:!0,streetAddress:B}:{},Te=(O=this.customerAccountEmail)!=null?O:f==null?void 0:f.emailAddress,A=await Ce(_({cartId:this.cart.id,emailAddress:Te,cartClient:this.apiClient,instrumentName:this.name},F)),M=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(A);await At({paymentSheetAction:M,onProceed:async Re=>{Re&&Re.length>0?await this.completePayment(ApplePaySession.STATUS_FAILURE,Re):await je()},terminateSession:p})}catch(F){p(F)}},je=async()=>{var O;try{const F=this.cart.lineItems.some(M=>!!M.sellingPlanAllocation),Te=await Jt({cartId:this.cart.id,totalAmount:this.cart.totalAmount,paymentMethod:{walletPaymentMethod:{applePayWalletContent:{billingAddress:I,data:m.paymentData.data,header:m.paymentData.header,lastDigits:m.paymentMethod.displayName.split(" ")[1],signature:m.paymentData.signature,version:m.paymentData.version}}},canUsePaymentMethodForFreeOrder:!1,billingAddress:I,cartClient:this.apiClient,instrumentName:this.name,hasSellingPlan:F,abortSignal:(O=this.abortController)==null?void 0:O.signal}),A=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(Te);await At({paymentSheetAction:A,onProceed:async M=>{M&&M.length>0?await this.completePayment(ApplePaySession.STATUS_FAILURE,M):await mt()},terminateSession:p})}catch(F){p(F)}},mt=async()=>{try{const O=await An({cartId:this.cart.id,token:m.transactionIdentifier,cartClient:this.apiClient,instrumentName:this.name}),F=this.paymentSheetActionGenerator.mapCompletionResultToPaymentSheetAction(O);await y(F)}catch(O){p(O)}};await Z()}),c(this,"terminateSession",d=>{var p;this.button.disabled=!1,d&&w.notify(d),g.sheetFailed(this.name,d);try{w.leaveBreadcrumb("ApplePay Session abort",{},"log"),this.session.abort(),(p=this.abortController)==null||p.abort()}catch(y){console.debug("[DEBUG] InvalidAccessError occurred during Apple Pay terminateSession")}if(d){const y=this.i18n.translate("brand.apple_pay");K(y,this.i18n)}}),c(this,"abortAndShowOutOfStockError",()=>{var d;this.session.abort(),(d=this.abortController)==null||d.abort(),te(this.i18n)}),c(this,"getMostRecentNonNullCart",(d,p)=>d?(this.cart=d,d):p),c(this,"handleNullCart",d=>{if(!d)throw new Error("[".concat(this.name,"] no cart returned on mutation, aborting"))}),c(this,"completeShippingContactSelection",(d,p)=>{try{const y=this.getMostRecentNonNullCart(d,this.cart),{newTotal:m,newLineItems:C}=this.getNewTotalAndLineItems(y),f=Hi(y.deliveryGroups,this.i18n);w.leaveBreadcrumb("ApplePay Session completeShippingContactSelection",{errors:p,newTotal:m,newLineItems:C,newShippingMethods:f},"log"),this.session.completeShippingContactSelection({errors:p!=null?p:[],newTotal:m,newLineItems:C,newShippingMethods:f})}catch(y){this.terminateSession(y)}}),c(this,"completeShippingMethodSelection",d=>{try{this.handleNullCart(d),this.cart=d;const{newTotal:p,newLineItems:y}=this.getNewTotalAndLineItems(d);w.leaveBreadcrumb("ApplePay Session completeShippingContactSelection",{newTotal:p,newLineItems:y},"log"),this.session.completeShippingMethodSelection({newTotal:p,newLineItems:y})}catch(p){this.terminateSession(p)}}),c(this,"sessionIsCancelled",()=>this.cancelled),this.accessToken=e,this.buyerCountry=n,this.button=a,this.cart=null,this.apiClient=u,this.dataSource=s,this.i18n=i,this.merchantName=o,this.cancelled=!1,this.buyerCurrency=r,this.customerAccountEmail=l.customerAccountEmail,this.session=new ApplePaySession(Ur,Vi({shippingRequired:this.isShippingRequired,walletParams:l,buyerCurrency:r})),this.session.onvalidatemerchant=this.onvalidatemerchant,this.session.onshippingcontactselected=this.onshippingcontactselected,this.session.onshippingmethodselected=this.onshippingmethodselected,this.session.onpaymentmethodselected=this.onpaymentmethodselected,this.session.oncancel=this.oncancel,this.session.onpaymentauthorized=this.onpaymentauthorized,this.paymentSheetActionGenerator=new zi(i)}begin(){w.leaveBreadcrumb("ApplePay Session begin",{},"log"),this.abortController=Qt(),this.session.begin()}async applyPaymentSheetActions(e,n,r){var a;const i=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(e,r);(a=i.effects)==null||a.forEach(o=>o()),!this.sessionIsCancelled()&&await At({paymentSheetAction:i,onProceed:n,terminateSession:this.terminateSession})}async getMerchantSession(e){const n=await new pt({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale,apiVersion:"unstable"}).applePaySessionCreate(e);return JSON.parse(n)}async completePayment(e,n=void 0){w.leaveBreadcrumb("ApplePay Session completePayment",{status:e,errors:n},"log"),this.session.completePayment({status:e,errors:n}),g.authorizationComplete({instrument:this.name,measurement:J(T.AuthorizationLatency,this.name),result:e===ApplePaySession.STATUS_SUCCESS?"success":"failure"})}getNewTotalAndLineItems(e){return{newTotal:Bi(this.merchantName,e.totalAmount),newLineItems:$i({subtotal:on(e),discountAllocations:qi(e),deliveryGroups:e.deliveryGroups,duties:e.totalDutyAmount,taxes:e.totalTaxAmount,i18n:this.i18n,formattedRecurringTotals:ji(this.cart.lineItems,this.i18n)})}}shouldDecelerate(e){const{checkoutUrl:n,totalAmount:r}=e;return Zt({checkoutUrl:n,instrumentName:this.name,currentCartTotal:r,initialBuyerCurrency:this.buyerCurrency})?(this.terminateSession(),!0):!1}get isShippingRequired(){return this.button.isShippingRequired}}const Po='<svg viewBox="0 0 43 19" xmlns="http://www.w3.org/2000/svg" width="45px" style="width: 45px;">\n  <path d="M6.948 1.409C7.934.147 9.305.147 9.305.147s.193 1.18-.771 2.316c-1.05 1.2-2.228.993-2.228.993s-.236-.93.642-2.047zM3.82 3.663c-1.735 0-3.6 1.51-3.6 4.363 0 2.916 2.186 6.555 3.943 6.555.6 0 1.543-.6 2.485-.6.922 0 1.607.559 2.464.559 1.907 0 3.322-3.826 3.322-3.826s-2.015-.744-2.015-2.936c0-1.944 1.629-2.73 1.629-2.73s-.836-1.447-2.936-1.447c-1.22 0-2.164.661-2.656.661-.622.021-1.5-.6-2.636-.6zM19.64 1.426c2.453 0 4.188 1.788 4.188 4.396 0 2.608-1.755 4.417-4.248 4.417h-2.932v4.564h-1.974V1.426h4.966zm-2.992 7.067h2.473c1.695 0 2.693-.967 2.693-2.65 0-1.683-.978-2.671-2.693-2.671h-2.473v5.321zm7.559 3.429c0-1.767 1.296-2.777 3.65-2.945l2.572-.147v-.78c0-1.156-.738-1.787-1.994-1.787-1.037 0-1.795.568-1.955 1.43h-1.775c.06-1.788 1.656-3.092 3.79-3.092 2.333 0 3.829 1.304 3.829 3.281v6.9h-1.815v-1.684h-.04c-.519 1.094-1.715 1.788-3.012 1.788-1.934.021-3.25-1.178-3.25-2.965zm6.222-.905v-.778l-2.313.168c-1.297.084-1.975.59-1.975 1.494 0 .862.718 1.409 1.815 1.409 1.396-.021 2.473-.968 2.473-2.293zm3.969 7.383v-1.64c.14.041.438.041.598.041.897 0 1.416-.4 1.735-1.472l.14-.526L33.4 4.707h2.054l2.453 8.224h.04L40.4 4.707h1.994l-3.57 10.538c-.818 2.419-1.715 3.197-3.67 3.197-.14.02-.598-.021-.757-.042z"/>\n</svg>\n';function Xt({translate:t,logoElement:e,setAriaHidden:n}){const r=document.createElement("div");return t("buy_with_button_content",{wallet:"LOGO_PLACEHOLDER"}).split(new RegExp("(LOGO_PLACEHOLDER)")).filter(Boolean).forEach(a=>{let i;a==="LOGO_PLACEHOLDER"?i=e:(i=document.createElement("span"),i.innerText=a,n&&i.setAttribute("aria-hidden","true")),r.appendChild(i)}),r}var Se;class Do extends ge{constructor(){super(),c(this,"name",b.ApplePay),c(this,"button",null),c(this,"logoElement"),Y(this,Se,void 0),Q(this,Se,this.attachShadow({mode:"closed"})),this.logoElement=new DOMParser().parseFromString(Po,"image/svg+xml").documentElement}static get observedAttributes(){return["disabled"]}get merchantName(){return this.walletParams.merchantName}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}attributeChangedCallback(e,n,r){super.attributeChangedCallback(e,n,r,this.button)}async handleClick(e){if(e.preventDefault(),this.disabled||!this.button||this.button.hasAttribute("aria-disabled"))return;this.disabled=!0;const[n,r,a]=await Promise.all([this.i18n,this.dataSource,this.apiClient]);let i;try{if(i=new vo({accessToken:this.accessToken,buyerCountry:this.buyerCountry,buyerCurrency:this.buyerCurrency,button:this,i18n:n,merchantName:this.merchantName,dataSource:r,apiClient:a,walletParams:this.walletParams}),!i)throw new Error("missing ApplePaySession");i.begin(),g.sheetClicked({instrument:this.name,result:"success"}),re(this.name)}catch(o){w.notify(o),g.sheetClicked({instrument:this.name,result:"failed"}),i==null||i.terminateSession()}}async render(){var e;const{translate:n}=await this.i18n;if(!this.button){if(this.button=Ve({label:n("buy_with_button_content",{wallet:n("brand.apple_pay")})}),this.button.onclick=r=>this.handleClick(r),this.button.classList.add("apple-pay-button",Qn[this.buttonTheme],pe.BUTTON),this.isCTA){const r=Xt({translate:n,logoElement:this.logoElement,setAriaHidden:!0});r.classList.add("apple-pay--content"),this.button.appendChild(r)}else this.button.appendChild(this.logoElement);this.initializeShadowStyles(v(this,Se),Oi),v(this,Se).appendChild(this.button),(e=this.onRendered)==null||e.call(this)}this.disabled&&(this.button.setAttribute("disabled",""),this.button.setAttribute("aria-disabled","true"))}}Se=new WeakMap;function er(t){return function(e,n,r){const a=r.value;return r.value=function(...i){const o=a.apply(this,i);return o.eligible||console.debug("[DEBUG] ".concat(t," could not be rendered. Reason: ").concat(o.reason)),o},r}}var No=Object.defineProperty,To=Object.getOwnPropertyDescriptor,Cn=(t,e,n,r)=>{for(var a=To(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(a=o(e,n,a)||a);return a&&No(e,n,a),a};class tr extends ae{constructor(e){super(e),c(this,"companyFieldRequired"),this.companyFieldRequired=!!this.walletParams.companyRequired}static walletName(){return"apple_pay"}getWebComponentName(){return"shopify-apple-pay-button"}getWebComponentClass(){return Do}getInstrumentName(){return b.ApplePay}applePayInIframe(){return typeof window>"u"||window.self!==window.top}getLoadEligibility(){return this.applePayInIframe()?{eligible:!1,reason:"cannot be loaded in an iframe"}:{eligible:!0}}getPartnerSDKEligibility(){var e,n,r,a;return typeof window>"u"||window.ApplePaySession===void 0?{eligible:!1,reason:"window or ApplePaySession is undefined"}:(n=(e=window.ApplePaySession).supportsVersion)!=null&&n.call(e,Ur)?(a=(r=window.ApplePaySession).canMakePayments)!=null&&a.call(r)?{eligible:!0}:{eligible:!1,reason:"failed SDK eligibility check"}:{eligible:!1,reason:"SDK does not meet minimum version requirement"}}}Cn([er("Apple Pay")],tr.prototype,"getLoadEligibility"),Cn([er("Apple Pay")],tr.prototype,"getPartnerSDKEligibility");const Ro=".buy-with-prime-button{width:100%;height:100%;padding:12px 10px 8px;display:flex;align-items:center;justify-content:center;gap:5px;opacity:1;border-width:0px}.buy-with-prime-button:hover:enabled{background-color:#0684eb!important}.buy-with-prime-button:focus{box-shadow:0 0 0 2px #1a98ff,inset 0 0 0 2px rgb(var(--color-background))!important;outline:none!important}.buy-with-prime-button:active,.buy-with-prime-button:hover:enabled:active{background-color:#0066cd!important;box-shadow:none!important}";class Xe extends Error{constructor(){super(...arguments),c(this,"name","MissingAccessTokenError")}}class rr extends Error{constructor(){super(...arguments),c(this,"name","FetchingWalletsPlatformConfigError")}}class Sn extends Error{constructor(){super(...arguments),c(this,"name","EmptyLineItemsWalletsPlatformConfigError")}}async function En({configOptionsEndpoint:t,checkoutUrl:e,sourceId:n,accessToken:r,instrument:a}){try{const i=JSON.stringify({checkout_url:e,checkout_cancel_url:window.location.href,cart_id:n}),o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":r},body:i});if(o.ok)return o.json();const s=await o.json();throw s.error?new Error(s.error):new Error("Could not fetch wallets platform configs: [".concat(o.status,"] ").concat(o.statusText))}catch(i){const{message:o}=i!=null?i:{};switch(o){case"empty_line_items":throw new Sn("[Fetch Pay Config][".concat(a,"] No eligible line items provided in the config request."));default:throw new rr("[Fetch Pay Config][".concat(a,"] ").concat(o))}}}const ko={[S.Checkout]:"Checkout",[S.CartAjax]:"Cart",[S.CartPage]:"Cart",[S.ProductPage]:"Product",[S.Unknown]:"Product"};var Ge;const Ae=class Js extends ge{constructor(){super(...arguments),c(this,"name",b.BuyWithPrime),c(this,"button",null),c(this,"apiClientId",""),Y(this,Ge,this.attachShadow({mode:"closed"}))}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}async createButton(){const{translate:e}=await this.i18n,n=Ve({label:e("buy_with_button_content",{wallet:e("brand.buy_with_prime")})});return n.type="button",n.className="buy-with-prime-button",this.applyEnabledStyles(n),n}applyEnabledStyles(e){e.innerHTML=He.primeLogo,e.disabled=!1,sr(e,{"background-color":"#1A98FF",color:"#FFFFFF",cursor:"pointer"})}applyDisabledStyles(e){e.innerHTML=He.primeLogoDark,e.disabled=!0,sr(e,{"background-color":"#C0E3FF",color:"#7292AC",cursor:"not-allowed"})}async handleClick(){var e;if(!this.button)return;const[n,r]=await Promise.all([this.i18n,this.dataSource]);let a=[];try{this.applyDisabledStyles(this.button);let i=this.walletParams;if(this.apiClientId=this.apiClientId||i.appId||"",!i.createCheckoutSessionConfig){const{cart:o,outOfStock:s}=await ne({element:this,instrumentName:this.name,dataSource:r});if(s){te(n);return}if(!this.accessToken)throw new Xe("[Fetch Pay Config] could not fetch pay configs since required accessToken is missing.");i=_({},await En({configOptionsEndpoint:Js.OPTIMUS_CONFIG_REST_API_URL,checkoutUrl:o.checkoutUrl,sourceId:(e=st(o))!=null?e:"",accessToken:this.accessToken,instrument:this.name}))}i.placement=this.getPlacement(),a=this.extractSKUs(i),delete i.checkoutSupportsSplitCart,delete i.appId,window.amazon.buywithprime.initCheckout({amazonPayOptions:i}),g.sheetClicked({instrument:this.name,result:"success",webPixelMetaData:this.apiClientId?{apiClientId:this.apiClientId,skus:a,pageType:this.pageType}:void 0}),re(this.name)}catch(i){const{name:o}=i!=null?i:{};Js.EXPECTED_ERRORS.includes(o)||w.notify(i),g.sheetClicked({instrument:this.name,result:"failed",webPixelMetaData:this.apiClientId?{apiClientId:this.apiClientId,skus:a,pageType:this.pageType}:void 0});const{title:s,content:u}=this.getErrorCopies(o,n);ye(s,u)}finally{this.applyEnabledStyles(this.button)}}getErrorCopies(e,n){const r=n.translate("brand.buy_with_prime");switch(e){case"EmptyLineItemsWalletsPlatformConfigError":return{title:n.translate("error_dialogs.wallet.buy_with_prime.empty_line_items.title"),content:n.translate("error_dialogs.wallet.buy_with_prime.empty_line_items.content")};default:return{title:n.translate("error_dialogs.wallet.title",{wallet:r}),content:n.translate("error_dialogs.wallet.generic_error",{wallet:r})}}}extractSKUs(e){var n;return(n=e.createCheckoutSessionConfig)!=null&&n.payloadJSON?JSON.parse(e.createCheckoutSessionConfig.payloadJSON).cartDetails.lineItems.map(r=>r&&r.sku).filter(r=>r):[]}getPlacement(){return this.pageType&&ko[this.pageType]||"Other"}async render(){var e;this.button||(this.button=await this.createButton(),this.button.onclick=()=>this.handleClick(),this.button.classList.add("buy-with-prime-button"),this.getPlacement().includes("Checkout")||this.button.classList.add(pe.BUTTON),await this.initializeShadowStyles(v(this,Ge),Ro),v(this,Ge).appendChild(this.button),(e=this.onRendered)==null||e.call(this))}};Ge=new WeakMap,c(Ae,"OPTIMUS_CONFIG_REST_API_URL","".concat(window.location.origin,"/wallets/config/optimus")),c(Ae,"EXPECTED_ERRORS",[rr.name,Xe.name,Sn.name]);let xt=Ae;function In(t,e=3,n=1e3,r=()=>!0){const a=()=>new Promise(o=>{setTimeout(o,n)}),i=async o=>{try{return await t()}catch(s){if(o>0&&r(s))return await a(),i(o-1);throw s}};return i(e-1)}async function Ct(t){const e=t.createCheckoutSessionConfig,n=JSON.parse(e.payloadJSON),r=new URL(n.webCheckoutDetails.checkoutReviewReturnUrl),a=await(await fetch("https:///sandbox/v2/checkoutSessions",{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"}})).json();r.searchParams.set("amazonCheckoutSessionId",a.checkoutSessionId||"testCheckoutSessionId"),r.searchParams.set("promiseId","testPromiseId"),ee(r.toString())}const vn={buywithprime:{initCheckout:async t=>{Ct(t.amazonPayOptions)}},Pay:{initCheckout:async t=>{Ct(t)},renderButton:()=>({initCheckout:Ct,onClick:()=>{}})}};async function Lo(){return window.amazon=vn,"loaded"}async function Oo(t){return new Promise((e,n)=>{if(document.querySelector('script[src="'.concat(t,'"]'))&&window.amazon){e();return}const r=document.createElement("script");r.src=t,r.onload=()=>{window.amazon?e():n(new Error("Amazon SDK not present after loading"))},r.onerror=()=>{n(new ze({message:"Error loading Amazon SDK"}))},document.head.append(r)})}async function Pn({sdkUrl:t=Gt,maxRetries:e=3,shouldMock:n=!1}){if(n){await Lo();return}await In(()=>Oo(t),e,200)}const q=class Ws extends ae{static walletName(){return"buy_with_prime"}constructor(e){super(e)}getWebComponentName(){return"shopify-buy-with-prime-button"}getInstrumentName(){return b.BuyWithPrime}isMockedAmazonServiceUsed(){return!1}getWebComponentClass(){return xt}async loadWalletSDK(){await Pn({sdkUrl:Ws.SDK_URL,shouldMock:this.isMockedAmazonServiceUsed(),maxRetries:Ws.MAX_RETRIES}),await this.loadLogos()}async loadLogos(){await Promise.all([this.loadPrimeLogo(),this.loadPrimeLogoDark()])}async loadPrimeLogo(){Ws.primeLogo=(await import("./prime-logo-DoVHKBSO.js")).default}async loadPrimeLogoDark(){Ws.primeLogoDark=(await import("./prime-logo-dark-DJIA6J0w.js")).default}};c(q,"MAX_RETRIES",3),c(q,"SDK_URL",Gt),c(q,"primeLogo"),c(q,"primeLogoDark");let He=q;const xo="shopify-amazon-pay-button div[role=button][slot=amazon-pay-slot][data-testid=amazon-pay-button]{border-radius:0!important}",Mo=[rr.name,Xe.name],Sr="amazon-pay-slot";var Ee;const tt=class Xs extends ge{constructor(){super(),c(this,"name",b.AmazonPay),c(this,"container",null),Y(this,Ee,void 0),Q(this,Ee,this.attachShadow({mode:"closed"}))}connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}async handleClick(e){var n;const[r,a]=await Promise.all([this.i18n,this.dataSource]);try{const{cart:i,outOfStock:o}=await ne({element:this,instrumentName:this.name,dataSource:a});if(o){te(r);return}const{totalAmount:{amount:s},checkoutUrl:u}=i;let l=this.walletParams;if(!l.createCheckoutSessionConfig){if(!this.accessToken)throw new Xe("[Fetch Pay Config] could not fetch pay configs since required accessToken is missing.");l=D(_({},await En({configOptionsEndpoint:Xs.CV2_CONFIG_REST_API_URL,checkoutUrl:u,sourceId:(n=st(i))!=null?n:"",accessToken:this.accessToken,instrument:this.name})),{placement:this.pageType===S.ProductPage?"Product":"Cart"})}delete l.appId,e.initCheckout(_(_({},l),Number(s)!==0&&{estimatedOrderAmount:{amount:s,currencyCode:this.buyerCurrency}})),g.sheetClicked({instrument:this.name,result:"success"}),re(this.name)}catch(i){const{name:o}=i!=null?i:{};Mo.includes(o)||w.notify(i),g.sheetClicked({instrument:this.name,result:"failed"});const s=r.translate("brand.amazon_pay");K(s,r)}}createContainer({containerID:e,height:n}){const r=document.createElement("div");return r.id=e,r.style.display="flex",n!=null&&(r.style.height="".concat(n,"px")),r.slot=Sr,r.setAttribute("data-testid","amazon-pay-button"),r}async render(){var e;try{if(!this.container){const n=document.createElement("slot");n.name=Sr;const r=document.createElement("style");r.textContent=xo,this.appendChild(r),await this.initializeShadowStyles(v(this,Ee));const a=await this.containerInstanceNumber,i="AcceleratedCheckoutAmazonPayButtonContainer".concat(this.pageType).concat(a),o=document.createElement("div");o.classList.add(pe.BUTTON),o.style.overflow="hidden",o.appendChild(n),v(this,Ee).appendChild(o);const s=Rt(o);this.container=this.createContainer({containerID:i,height:s}),this.appendChild(this.container);const u=window.amazon.Pay.renderButton("#".concat(i),D(_({},this.walletParams),{placement:this.pageType===S.ProductPage?"Product":"Cart"}));u==null||u.onClick(()=>this.handleClick(u)),(e=this.onRendered)==null||e.call(this)}}catch(n){w.notify(n)}}};Ee=new WeakMap,c(tt,"CV2_CONFIG_REST_API_URL","".concat(window.location.origin,"/wallets/config/amazon_pay"));let Mt=tt;const _e=class Zs extends ae{static walletName(){return"amazon_pay"}constructor(e){super(e)}getWebComponentName(){return"shopify-amazon-pay-button"}getInstrumentName(){return b.AmazonPay}isMockedAmazonServiceUsed(){return!1}getWebComponentClass(){return Mt}async loadWalletSDK(){if(await Pn({sdkUrl:Zs.SDK_URL,shouldMock:!1,maxRetries:Zs.MAX_RETRIES}),this.isMockedAmazonServiceUsed()){const e=window.amazon.Pay.renderButton;window.amazon.Pay.renderButton=(n,r)=>{const a=e(n,r);return a.initCheckout=vn.Pay.initCheckout,a}}}};c(_e,"MAX_RETRIES",3),c(_e,"SDK_URL",Gt);let Ft=_e;var St={Purple:{D0:"#4524DB",D1:"#30368D",D2:"#1C234C",L0:"#6445ED",L1:"#9C83F8",L2:"#EEEAFF",L3:"#F7F5FF",Primary:"#5433EB",PrimaryLight:"#DBD1FF"},Grayscale:{Black:"#000000",D0:"#666666",D1:"#404040",D2:"#121212",D3:"#0B0B0C",D2D:"#2A2A2A",PrimaryLight:"#707070",L1:"#A8A8A7",L2:"#CBCBCA",L2L:"#E3E3E3",L3:"#F0F0F0",L4:"#F2F4F5",White:"#FFFFFF"},Green:{D1:"#008552",D2:"#004839",L1:"#BAEBCB",L2:"#D2F2DE",L3:"#E4F6EB",Primary:"#92D08D"},Poppy:{D0:"#F05D38",D1:"#D92A0F",D2:"#832711",L1:"#FFD2C2",L2:"#FFECE9",Primary:"#FF967D"},Ochre:{D0:"#F8DB67",D1:"#E3BE2B",D2:"#C29D05",D4:"#443600",L1:"#FFF4CB",L2:"#FFF9E2",Primary:"#FFEC9F"},Brand:{Aqua:"#8DC0C6",Lime:"#C7DE00",Magenta:"#D354FF",Olive:"#8B8F01",Sage:"#D8E59D",Sand:"#F4F4ED",Violet:"#A327C2"}},Fo={0:0,none:0,xxxs:2,xxs:4,xs:8,"xs-s":12,s:16,gutter:20,m:24,l:32,section:36,xl:40,xxl:48,xxxl:64,auto:"auto"},Uo=class extends HTMLElement{static get observedAttributes(){return["disabled"]}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this._updateButton()}attributeChangedCallback(){this._updateButton()}_updateButton(){var t;let e=this.shadowRoot;e&&(e.innerHTML=$o,this.hasAttribute("disabled")&&((t=this.shadowRoot.querySelector("button"))==null||t.setAttribute("disabled","")))}};function Bo(){window.customElements&&(customElements.get("gravity-button")||customElements.define("gravity-button",Uo))}var $o="\n<style>\n  * {\n    box-sizing: border-box;\n    border-width: 0;\n    border-style: solid;\n    border-color: currentColor;\n    --focused-box-shadow: 0 0 0 3px #DBD1FF, 0 0 #0000;\n  }\n\n  button {\n    text-transform: none;\n    -webkit-appearance: button;\n    background-color: transparent;\n    background-image: none;\n    font-family: inherit;\n    font-feature-settings: inherit;\n    font-variation-settings: inherit;\n    font-size: 100%;\n    font-weight: inherit;\n    line-height: inherit;\n    letter-spacing: inherit;\n    color: inherit;\n    margin: 0;\n    padding: 0;\n    cursor: pointer;\n  }\n\n  button:disabled {\n    cursor: default;\n    opacity: 0.5;\n  }\n\n  .gravity-button {\n    position: relative;\n    display: flex;\n    min-height: var(--gravity-button-min-height);\n    height: var(--gravity-button-height);\n    width: var(--gravity-button-width, 260px);\n    justify-content: center;\n    color: ".concat(St.Grayscale.White,";\n    align-items: center;\n    overflow: visible;\n    padding: var(--gravity-button-padding, ").concat(Fo.s,"px 10px);\n    border-radius: var(--gravity-button-border-radius);\n    border: none;\n    background-color: ").concat(St.Purple.Primary,";\n    transition: all;\n  }\n\n  .gravity-button:not([disabled]):focus-visible {\n    box-shadow: var(--focused-base-box-shadow, var(--focused-box-shadow));\n    outline: var(--focused-base-outline, 2px solid transparent);\n    outline-offset: var(--focused-base-outline-offset, 2px);\n  }\n\n  .gravity-button:not([disabled]):hover {\n    background-color: ").concat(St.Purple.D0,';\n  }\n</style>\n\n<button class="gravity-button">\n  <slot id="button-content"></slot>\n</button>\n');const Ho=".button-content{display:flex;align-items:center;justify-content:center;width:100%;height:100%;gap:3px;white-space:nowrap;container-type:inline-size;container-name:bc}.ShopPromise>.separator{margin:0 8px}@container bc (width <= 338px){.ShopPromise{display:none!important}}gravity-button{display:block}",Go='.accelerated-checkout-button{--gravity-button-height: clamp( 25px, var(--shopify-accelerated-checkout-button-block-size, 44px), 55px );--gravity-button-min-height: clamp( 25px, var(--shopify-accelerated-checkout-button-block-size, 44px), 55px );--gravity-button-border-radius: var( --shopify-accelerated-checkout-button-border-radius, 0px );--gravity-button-padding: 0px 10px;--gravity-button-width: 100%}:host([page-type="cart_page"]) .accelerated-checkout-button{--gravity-button-height: 100%;--gravity-button-min-height: 100%;--gravity-button-border-radius: var( --shopify-accelerated-checkout-button-border-radius, 4px );--gravity-button-width: 100%}';class Dn extends Error{constructor(){const e="DeliveryEstimatesResponseIsNullError";super("deliveryEstimates is null or undefined"),this.name=e}}class Et extends Error{constructor(){const e="DeliveryPromiseAPIClientError";super("window.Shopify.ShopPromise.deliveryPromiseAPIClient is undefined"),this.name=e}}const zo=15,Vo=200;class qo{constructor(e){c(this,"storefrontAPIToken"),this.storefrontAPIToken=e}async fetchDeliveryPromise({variant:e,postalCode:n,defaultPostalCode:r,sellingPlanId:a}){const i=await In(async()=>this.fetchDeliveryOptions(e,n,r,a),zo,Vo,o=>o instanceof Et).catch(o=>{if(o instanceof Et)throw o;return null});if(!i)throw new Dn;return i}async fetchDeliveryOptions(e,n,r,a){var i,o;const s={variantId:e,sellingPlanId:a,postalCode:n||r,isPostalCodeOverride:!!n},u=(o=(i=window==null?void 0:window.Shopify)==null?void 0:i.ShopPromise)==null?void 0:o.deliveryPromiseAPIClient;if(!u)throw new Et;return u(s,this.storefrontAPIToken)}}function jo(t,e){switch(t){case 0:return(e==null?void 0:e.translate("shop_promise_delivery.same_day"))||null;case 1:return(e==null?void 0:e.translate("shop_promise_delivery.next_day"))||null;case 2:return(e==null?void 0:e.translate("shop_promise_delivery.two_day"))||null;default:return null}}const Wo="delivery_promise_default_address",Yo="delivery_promise_postal_code";class Ko extends ct{constructor(){super(...arguments),c(this,"lastFetchedProductVariantId"),c(this,"lastFetchSellingPlan"),c(this,"fetching",!1),c(this,"i18n",null),c(this,"daysToDelivery"),c(this,"formObserver",null)}async connectedCallback(){this.formObserver=new Kr(this,({variantId:e,sellingPlanId:n})=>{this.fetchDeliveryPromise(e,n)}),this.formObserver.setupMutationObservers()}setTranslations(e){this.i18n=e,this.render()}get postalCode(){try{return JSON.parse(Be(Yo)||"null")||null}catch(e){return null}}get defaultDeliveryAddress(){try{return JSON.parse(Be(Wo)||"null")}catch(e){return null}}async fetchDeliveryPromise(e,n){var r,a,i,o;if(!(!e||!this.accessToken)&&!(e===this.lastFetchedProductVariantId&&n===this.lastFetchSellingPlan))try{this.lastFetchedProductVariantId=e,this.lastFetchSellingPlan=n;const s=((r=this.defaultDeliveryAddress)==null?void 0:r.zip)||"",u=await new qo(this.accessToken).fetchDeliveryPromise({variant:e,postalCode:this.postalCode||"",defaultPostalCode:s,sellingPlanId:n||""}),l=Kt(this),d=(i=(a=u==null?void 0:u.selectedShippingOption)==null?void 0:a.brandedPromise)==null?void 0:i.handle;if((l==null?void 0:l.sellingPlanId)!==n||(l==null?void 0:l.variantId)!==e||d!=="shop_promise")return;this.daysToDelivery=(o=u==null?void 0:u.selectedShippingOption)==null?void 0:o.maxCalendarDaysToDelivery,this.render()}catch(s){s instanceof Dn&&(this.daysToDelivery=null)}}render(){const e=jo(this.daysToDelivery,this.i18n);this.classList.add("ShopPromise"),this.innerHTML=e?'<span class="separator">|</span><span>'.concat(e,"</span>"):""}}var de;class Jo extends ge{constructor(){super(),c(this,"name",b.ShopPay),c(this,"button",null),c(this,"shopPromiseProductPageContent",null),c(this,"shopPromiseEligible",!1),Y(this,de,void 0),Q(this,de,this.attachShadow({mode:"closed"}))}static get observedAttributes(){return["disabled"]}connectedCallback(){this.shopPromiseEligible=Hr(),this.cleanupOnFailure(async()=>{Bo(),await this.render()},this.name)}attributeChangedCallback(e,n,r){super.attributeChangedCallback(e,n,r,this.button)}async addButtonContent(){if(!this.button)return;let e;const n=await this.i18n,r=new DOMParser().parseFromString(Tn.shopPayLogoElement,"image/svg+xml").documentElement;this.isCTA?e=Xt({translate:n.translate,logoElement:r,setAriaHidden:!1}):(e=document.createElement("div"),e.appendChild(r)),e.classList.add("button-content"),this.shopPromiseEligible&&!this.shopPromiseProductPageContent&&(this.shopPromiseProductPageContent=document.createElement("shop-promise-product-page-content"),this.shopPromiseProductPageContent.setTranslations(n),this.shopPromiseProductPageContent.setAttribute("access-token",this.accessToken||""),e.appendChild(this.shopPromiseProductPageContent)),this.button.appendChild(e)}getShopPayBehavior(){return this.pageType===S.ProductPage?"force_shop_pay_product":this.pageType===S.CartPage?"force_shop_pay_cart":"force_shop_pay"}async handleClick(e){if(e.preventDefault(),this.disabled||!this.button||this.button.getAttribute("disabled"))return;this.disabled=!0;const[n,r]=await Promise.all([this.i18n,this.dataSource]);try{const{outOfStock:a,cart:i}=await ne({element:this,instrumentName:b.ShopPay,dataSource:r});if(g.sheetClicked({instrument:this.name,checkoutToken:st(i),result:"success"}),a){te(n);return}re(this.name),ee(i.checkoutUrl,this.getShopPayBehavior())}catch(a){w.notify(new Zo("An error occurred when attempting to a cart using the Shop Pay Button. Details: ".concat(a))),g.sheetClicked({instrument:this.name,result:"failed"}),ye(n.translate("error_dialogs.checkout.title"),n.translate("error_dialogs.checkout.generic_error"))}}async render(){if(v(this,de).innerHTML)return;this.button||(this.button=document.createElement("gravity-button"));const e=document.createElement("style");e.innerHTML=[Jr,Go,Ho].join("\n"),v(this,de).appendChild(e),await this.addButtonContent(),this.disabled&&this.button.setAttribute("disabled",""),this.button.setAttribute("aria-hidden","true"),this.button.classList.add(pe.BUTTON),this.button.onclick=n=>this.handleClick(n),v(this,de).appendChild(this.button),this.onRendered()}}de=new WeakMap,G("shop-promise-product-page-content",Ko);class Zo extends Error{constructor(){super(...arguments),c(this,"name","ShopPayButtonError")}}var Qo=Object.defineProperty,Xo=Object.getOwnPropertyDescriptor,es=(t,e,n,r)=>{for(var a=Xo(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(a=o(e,n,a)||a);return a&&Qo(e,n,a),a},Ie;const Nn=(Ie=class extends ae{static walletName(){return"shop_pay"}constructor(t){super(t)}getWebComponentName(){return"shop-pay-wallet-button"}getWebComponentClass(){return Jo}getInstrumentName(){return b.ShopPay}async loadWalletSDK(){await this.loadLogo()}getLoadEligibility(){return{eligible:!0}}async loadLogo(){Ie.shopPayLogoElement=(await import("./shop-pay-logo-CYhOC7ye.js")).default}},c(Ie,"shopPayLogoElement"),Ie);es([er("Shop Pay")],Nn.prototype,"getLoadEligibility");let Tn=Nn;const ts=".button{display:flex;justify-content:center;align-items:center;width:100%;border:none}.button:hover:not(:disabled){filter:brightness(92%);cursor:pointer}.button:disabled{opacity:.5;cursor:not-allowed}.logo-only>svg{width:50px}.dark{background:#000;color:#fff}.dark svg{fill:#fff}.light{background:#fff;outline:1px solid #3c4043;color:#000}.light svg{fill:#0000008c}.content{display:flex;justify-content:center;align-items:center;white-space:pre}";function It({cart:t,i18n:e}){const n=on(t),r={label:e.translate("order_summary.subtotal"),type:"SUBTOTAL",price:ue(n.amount)},a=rn({deliveryGroups:t.deliveryGroups,i18n:e}).map(s=>rs({lineItem:s,type:"LINE_ITEM"})),i=ns(t,e),o=[r,...a,...i];if(t.totalDutyAmount){const s={label:e.translate("order_summary.duties"),type:"LINE_ITEM",price:ue(t.totalDutyAmount.amount)};o.push(s)}if(t.totalTaxAmount){const s={label:e.translate("order_summary.taxes"),type:"TAX",price:ue(t.totalTaxAmount.amount)};o.push(s)}return{totalPrice:t.totalAmount.amount,currencyCode:t.totalAmount.currencyCode,totalPriceStatus:"ESTIMATED",totalPriceLabel:e.translate("order_summary.total"),displayItems:o}}function rs({lineItem:t,type:e,status:n="FINAL"}){return{label:t.label,type:e,price:t.amount,status:n}}function ns(t,e){return[...t.lineItems.flatMap(n=>n.discountAllocations),...t.discountAllocations].flatMap(n=>{var r;const a=(r=n.title)!=null?r:n.code;return{label:a!=null?a:e.translate("order_summary.discount"),type:"LINE_ITEM",price:"-".concat(ue(Number(n.discountedAmount.amount)))}})}const Rn=["PAYMENT_AUTHORIZATION"],as=Rn.concat(["SHIPPING_ADDRESS","SHIPPING_OPTION"]),is=["PAN_ONLY"];function os({walletParams:t,isShippingRequired:e,hasSellingPlan:n,i18n:r,buyerCurrency:a}){const i={totalPrice:"0.01",currencyCode:a,totalPriceStatus:"ESTIMATED",totalPriceLabel:r.translate("order_summary.total"),displayItems:[{label:r.translate("order_summary.subtotal"),type:"SUBTOTAL",price:"0.01"}]},o=D(_({},t.paymentData),{shippingAddressRequired:e,shippingOptionRequired:e,transactionInfo:i});return e||delete o.shippingAddressParameters,o.callbackIntents=e?as:Rn,n&&ss(o),o}function ss(t){t.allowedPaymentMethods.forEach(e=>{e.parameters.allowedAuthMethods=e.parameters.allowedAuthMethods.filter(n=>is.includes(n))})}class ls extends an{constructor(e){super(),c(this,"brandName"),this.i18n=e,this.brandName=this.i18n.translate("brand.google_pay")}mapMutationResultToPaymentSheetAction(e){const n=this.mapCustomValidationFunctionErrorToAction(e.errors);if(n)return n;const r=this.getErrorActions(),a=e.errors,i=this.getUnhandledErrors(a,r);i.forEach(s=>{w.notify(new nn("[".concat(b.GooglePay,"] mutation result error not handled: ").concat(s)))});const{firstPaymentSheetAction:o}=this.getMergedPaymentSheetAction({result:e,errorActions:r});return o||(i.length>0?{action:"abort"}:{action:"update",errors:[]})}mapCompletionResultToPaymentSheetAction(e){if(!e.data)throw new Error("[".concat(b.GooglePay,"] completion returned null result"));switch(e.data.__typename){case"SubmitSuccess":return{action:"complete",redirectUrl:e.data.redirectUrl};case"SubmitAlreadyAccepted":case"SubmitThrottled":case"SubmitFailed":{const n=this.mapCustomValidationFunctionErrorToAction(e.errors);if(n)return n;const r=this.getErrorActions(),a=e.errors;this.getUnhandledErrors(a,r).forEach(o=>{w.notify(new Error("[".concat(b.GooglePay,"] completion result error not handled: ").concat(o)))});const{prioritizedPaymentSheetAction:i}=this.getMergedPaymentSheetAction({result:e,errorActions:r});return i||(K(this.brandName,this.i18n),{action:"abort"})}default:throw new Error("[".concat(b.GooglePay,"] unknown completion result type: ").concat(e.data.__typename))}}getErrorActions(){return[{errors:[h.InvalidLanguage],generateAction:()=>({action:"abort",effects:[()=>{w.notify(new Error("[".concat(b.GooglePay,"] mutation provided invalid language, aborting")))},()=>K(this.brandName,this.i18n)]})},{errors:[h.InvalidCountry],generateAction:()=>({action:"abort",effects:[()=>{w.notify(new Error("[".concat(b.GooglePay,"] mutation provided invalid country, aborting")))},()=>K(this.brandName,this.i18n)]})},{errors:[h.MissingCartId],generateAction:()=>({action:"abort",effects:[()=>{w.notify(new Error("[".concat(b.GooglePay,"] mutation provided invalid cart ID, aborting")))},()=>K(this.brandName,this.i18n)]})},{errors:[h.UnacceptablePaymentsAmount,h.NewTaxMustBeAccepted,h.MerchandiseExpectedPriceMismatch,h.DeliveryLineChanged,h.DeliveryLocalPickupLineChanged,...Gr],generateAction:()=>({action:"abort",effects:[()=>K(this.brandName,this.i18n)]})},{errors:zr,generateAction:()=>({action:"abort",effects:[()=>te(this.i18n)]})},{errors:[h.DeliveryNoStrategyAvailable,h.DeliveryNoLocalPickupStrategyAvailable,h.DeliveryNotAvailable],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_UNSERVICEABLE",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.shipping_address")}]})},{errors:[h.NoDeliveryGroupSelected],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_OPTION_INVALID",intent:"SHIPPING_OPTION",message:this.i18n.translate("errors.missing.shipping_option")}]})},{errors:[h.BuyerIdentityEmailDomainInvalid,h.BuyerIdentityEmailNotExpectedPattern,h.BuyerIdentityEmailInvalid],generateAction:()=>({action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.email")}]})},{errors:[h.BuyerIdentityEmailRequired],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.email")}]})},{errors:[h.DeliveryAddress2Required,h.DeliveryAddress2AddressFieldRequired],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.address2")}]})},{errors:[h.DeliveryAddress2Invalid],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.address2")}]})},{errors:[h.DeliveryCityAddressFieldRequired,h.DeliveryCityRequired],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.city")}]})},{errors:[h.DeliveryCityInvalid],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.city")}]})},{errors:[h.DeliveryZoneRequiredForCountry],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.zone")}]})},{errors:[h.DeliveryZoneNotFound],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.zone")}]})},{errors:[h.DeliveryPostalCodeRequired,h.DeliveryPostalCodeAddressFieldRequired],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.postal_code")}]})},{errors:[h.DeliveryPostalCodeInvalid,h.DeliveryInvalidPostalCodeForZone,h.DeliveryInvalidPostalCodeForCountry,h.DeliveryZipInvalidForCountry],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.postal_code")}]})},{errors:[h.DeliveryPhoneNumberRequired],generateAction:()=>({action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.phone_number")}]})},{errors:[h.DeliveryPhoneNumberInvalid,h.BuyerIdentityInvalidPhone,h.DeliveryPhoneDoesNotMatchExpectedPattern],generateAction:()=>({action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.phone_number")}]})},{errors:[h.BuyerIdentityInvalidCountry,h.DeliveryCountryInvalid],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.country")}]})},{errors:[h.DeliveryFirstNameRequired],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.first_name")}]})},{errors:[h.DeliveryFirstNameInvalid],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.first_name")}]})},{errors:[h.DeliveryLastNameRequired],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.last_name")}]})},{errors:[h.DeliveryLastNameInvalid],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.last_name")}]})},{errors:[h.DeliveryAddress1Required],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.missing.address1")}]})},{errors:[h.DeliveryAddress1Invalid],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.invalid.address1")}]})},{errors:[h.DeliveryLastNameContainsEmojis],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.emojis.last_name")}]})},{errors:[h.DeliveryCityContainsEmojis],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.emojis.city")}]})},{errors:[h.DeliveryAddress1ContainsEmojis],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.emojis.address1")}]})},{errors:[h.DeliveryAddress2ContainsEmojis],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.emojis.address2")}]})},{errors:[h.DeliveryPostalCodeContainsEmojis],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.emojis.postal_code")}]})},{errors:[h.DeliveryAddress1TooLong],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.too_long.address1")}]})},{errors:[h.DeliveryAddress2TooLong],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.too_long.address2")}]})},{errors:[h.DeliveryFirstNameTooLong],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.too_long.first_name")}]})},{errors:[h.DeliveryLastNameTooLong],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.too_long.last_name")}]})},{errors:[h.DeliveryCityTooLong],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.too_long.city")}]})},{errors:[h.DeliveryFirstNameContainsUrl],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.url.first_name")}]})},{errors:[h.DeliveryLastNameContainsUrl],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.url.last_name")}]})},{errors:[h.DeliveryAddress1ContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.html_tags.address1")}]})},{errors:[h.DeliveryAddress2ContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.html_tags.address2")}]})},{errors:[h.DeliveryCityContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.html_tags.city")}]})},{errors:[h.DeliveryFirstNameContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.html_tags.first_name")}]})},{errors:[h.DeliveryLastNameContainsHtmlTags],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.i18n.translate("errors.html_tags.last_name")}]})},{errors:[h.InvalidPaymentGooglePayBillingAddress],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.i18n.translate("errors.invalid.billing_address")}]})},{errors:[h.UnsupportedGooglePayPaymentMethod],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.i18n.translate("errors.invalid.payment_method")}]})}]}mapCustomValidationFunctionErrorToAction(e){const n=e.find(r=>typeof r=="object"&&(r==null?void 0:r.code)===Ze);return n?(w.notify(new Error("[".concat(b.GooglePay,"] custom validation function error: ").concat(e))),qt(this.i18n.translate("error_dialogs.wallet.title",{wallet:this.brandName}),n.message),{action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"PAYMENT_AUTHORIZATION",message:this.i18n.translate("paymentSheet.errors.unknown")}]}):null}}function cs({deliveryGroups:t,i18n:e}){var n;const r=en(tn(t),e),a=r.map(o=>({id:o.handle,label:o.title||"",description:o.estimatedCost?"".concat(o.estimatedCost.amount.toString()," ").concat(o.estimatedCost.currencyCode):""})),i=(n=r.find(o=>{var s;return o.handle.includes(((s=t[0].selectedDeliveryOption)==null?void 0:s.handle)||"")}))==null?void 0:n.handle;return{shippingOptions:a,defaultSelectedOptionId:i}}function vt(t){let e=t.administrativeArea,n=t.locality;t.countryCode==="AE"&&(n=t.administrativeArea,t.administrativeArea in Er&&(e=Er[t.administrativeArea]));let r,a;if(t.name){const[i,...o]=(t.name||"").split(" ");o.length===0?a=i:a=o.join(" "),r=i}return{firstName:r,lastName:a,address1:t.address1,address2:t.address2,city:n,province:e,country:t.countryCode,phone:t.phoneNumber,zip:t.postalCode}}const Er={"\u0623\u0628\u0648 \u0638\u0628\u064A":"AZ","\u0625\u0645\u0627\u0631\u0629 \u0627\u0644\u0634\u0627\u0631\u0642\u0629\u0651":"SH",\u0627\u0644\u0641\u062C\u064A\u0631\u0629:"FU",\u0639\u062C\u0645\u0627\u0646:"AJ","\u0631\u0623\u0633 \u0627\u0644\u062E\u064A\u0645\u0629":"RK","\u0623\u0645 \u0627\u0644\u0642\u064A\u0648\u064A\u0646":"UQ",\u062F\u0628\u064A:"DU"},ds=27e3;class us extends Error{constructor(e){super(e),this.name="GooglePayError"}}var j;class hs{constructor({walletParams:e,isShippingRequired:n,hasSellingPlan:r,dataSource:a,button:i,i18n:o,cartClient:s,buyerCurrency:u,abortController:l}){c(this,"name",b.GooglePay),c(this,"walletParams"),c(this,"cart",null),c(this,"isShippingRequired"),c(this,"hasSellingPlan"),c(this,"dataSource"),c(this,"button"),c(this,"paymentsClient"),c(this,"i18n"),c(this,"actionGenerator"),c(this,"cartClient"),c(this,"initialBuyerCurrency"),Y(this,j,void 0),c(this,"onPaymentDataChanged",async p=>{var y;const{callbackTrigger:m,shippingAddress:C,shippingOptionData:f}=p,{translate:I}=this.i18n;switch(m){case"INITIALIZE":{if(!this.cart)try{const{cart:B}=await ne({element:this.button,instrumentName:b.GooglePay,dataSource:this.dataSource});this.cart=B,g.sheetClicked({instrument:this.name,result:"success"})}catch(B){return g.sheetClicked({instrument:this.name,result:"failed"}),this.showGooglePayError("SHIPPING_ADDRESS")}return C?this.handleShippingAddress(this.cart.id,C):{newTransactionInfo:It({cart:this.cart,i18n:this.i18n})}}case"SHIPPING_ADDRESS":return this.cart?C?this.handleShippingAddress(this.cart.id,C):{newTransactionInfo:It({cart:this.cart,i18n:this.i18n})}:this.showGooglePayError(m);case"SHIPPING_OPTION":{if(!this.cart)return this.showGooglePayError(m);if(!f||!f.id)return{error:{reason:"SHIPPING_OPTION_INVALID",message:I("shipping_methods.choose_delivery_strategy"),intent:"SHIPPING_OPTION"}};const B=_n({deliveryGroups:this.cart.deliveryGroups,instrumentName:b.GooglePay,selectedDeliveryOptionHandles:f.id.split(",")}),Z=await wn({cartClient:this.cartClient,cartId:this.cart.id,instrumentName:b.GooglePay,selectedDeliveryOptions:B,abortSignal:(y=v(this,j))==null?void 0:y.signal});return Z.data?(this.cart=Z.data,this.updatePaymentSheet({result:Z,intent:m})):this.showGooglePayError(m)}default:return this.logException("Payment data changed callback returned unexpected intent: ".concat(m),{severity:"warning"}),this.showGooglePayError("SHIPPING_ADDRESS")}}),c(this,"onPaymentAuthorized",async p=>{var y,m,C;g.authorizationAttempt(this.name),qe(T.AuthorizationLatency,this.name);const f=async A=>{var M,Re;switch((M=A.effects)==null||M.forEach(yt=>yt()),A.action){case"complete":return g.authorizationComplete({instrument:this.name,measurement:J(T.AuthorizationLatency,this.name),result:"success"}),ee(A.redirectUrl),{transactionState:"SUCCESS"};case"show_error":return this.handlePaymentFailure((Re=A.errors)==null?void 0:Re[0]);case"abort":return{transactionState:"SUCCESS"};default:throw new Error("[".concat(this.name,"] completion action not handled: ").concat(A.action))}},I=A=>"error"in A&&A.error!==void 0,B=(y=p.paymentMethodData.info)==null?void 0:y.billingAddress,Z=p.shippingAddress,{signature:je,signedMessage:mt,protocolVersion:O}=JSON.parse(p.paymentMethodData.tokenizationData.token);if(!B)return this.handlePaymentFailure();if(this.isShippingRequired&&!Z)return this.handlePaymentFailure();const F=async()=>{var A;const M=p.email,Re=this.isShippingRequired?{validateAddress:!0,streetAddress:vt(Z)}:{},yt=await Ce(_({cartClient:this.cartClient,cartId:this.cart.id,instrumentName:this.name,emailAddress:M,abortSignal:(A=v(this,j))==null?void 0:A.signal},Re));return this.updatePaymentSheet({result:yt,intent:"PAYMENT_AUTHORIZATION"})},Te=async()=>{var A;const M=vt(B),Re=await Jt({cartId:this.cart.id,totalAmount:this.cart.totalAmount,paymentMethod:{walletPaymentMethod:{googlePayWalletContent:{billingAddress:M,signature:je,signedMessage:mt,protocolVersion:O}}},canUsePaymentMethodForFreeOrder:!1,billingAddress:M,cartClient:this.cartClient,instrumentName:this.name,hasSellingPlan:this.hasSellingPlan,abortSignal:(A=v(this,j))==null?void 0:A.signal});return this.updatePaymentSheet({result:Re,intent:"PAYMENT_AUTHORIZATION"})};try{const A=setTimeout(()=>{var Qs;(Qs=v(this,j))==null||Qs.abort("Google Pay Timeout")},ds),M=await F();if(I(M))return this.handlePaymentFailure(M.error);const Re=await Te();if(I(Re))return this.handlePaymentFailure(Re.error);if(clearTimeout(A),(C=(m=v(this,j))==null?void 0:m.signal)!=null&&C.aborted)return this.handlePaymentFailure();const yt=await An({cartId:this.cart.id,token:je,cartClient:this.cartClient,instrumentName:this.name}),rl=this.actionGenerator.mapCompletionResultToPaymentSheetAction(yt);return f(rl)}catch(A){const{message:M}=A;return this.logException(M),this.handlePaymentFailure()}}),this.walletParams=e,this.isShippingRequired=n,this.hasSellingPlan=r,this.dataSource=a,this.button=i,this.i18n=o,this.cartClient=s,this.initialBuyerCurrency=u,Q(this,j,l);const d={environment:this.walletParams.environment,merchantInfo:this.walletParams.paymentData.merchantInfo,paymentDataCallbacks:{onPaymentDataChanged:this.isShippingRequired?this.onPaymentDataChanged:void 0,onPaymentAuthorized:this.onPaymentAuthorized}};this.paymentsClient=new window.google.payments.api.PaymentsClient(d),this.actionGenerator=new ls(this.i18n)}async handleClick(){if(!this.isShippingRequired)throw new ze({message:"Google Pay checkout started for digital cart"});const e=os({walletParams:this.walletParams,isShippingRequired:this.isShippingRequired,hasSellingPlan:this.hasSellingPlan,i18n:this.i18n,buyerCurrency:this.initialBuyerCurrency});await this.paymentsClient.loadPaymentData(e)}showGooglePayError(e,{error:n}={}){return n?{error:n}:{error:{reason:"OTHER_ERROR",message:this.i18n.translate("error_dialogs.wallet.generic_error",{wallet:this.i18n.translate("brand.google_pay")}),intent:e!=null?e:"SHIPPING_ADDRESS"}}}updatePaymentSheet({result:e,intent:n}){var r,a;const i=this.actionGenerator.mapMutationResultToPaymentSheetAction(e);switch(i.action){case"update":{const o=i,{data:s}=e;return s?this.isShippingRequired&&s.deliveryGroups.length===0?this.showGooglePayError("SHIPPING_ADDRESS",{error:{reason:"SHIPPING_ADDRESS_INVALID",message:this.i18n.translate("errors.address_unserviceable",{shopName:this.walletParams.paymentData.merchantInfo.merchantName}),intent:"SHIPPING_ADDRESS"}}):{newTransactionInfo:It({cart:s,i18n:this.i18n}),newShippingOptionParameters:this.isShippingRequired?cs({deliveryGroups:s.deliveryGroups,i18n:this.i18n}):void 0,error:(r=o.errors)==null?void 0:r[0]}:this.showGooglePayError(n)}case"show_error":return{error:(a=i.errors)==null?void 0:a[0]};case"abort":return this.showGooglePayError(n);default:return this.logException("Payment sheet update returned unexpected action (see request tab for details)",{metadata:{request:{action:i.action,intent:n}}}),this.showGooglePayError(n)}}shouldDecelerate(e,n){return Zt({checkoutUrl:e,instrumentName:this.name,currentCartTotal:n,initialBuyerCurrency:this.initialBuyerCurrency})}async handleShippingAddress(e,n){var r;const a=await Ce({cartClient:this.cartClient,cartId:e,streetAddress:n?vt(n):{},instrumentName:b.GooglePay,abortSignal:(r=v(this,j))==null?void 0:r.signal});return a.data?(this.cart=a.data,this.shouldDecelerate(this.cart.checkoutUrl,this.cart.totalAmount)?{error:{reason:"OTHER_ERROR",message:this.i18n.translate("errors.currency.mismatch"),intent:"SHIPPING_ADDRESS"}}:this.updatePaymentSheet({result:a,intent:"SHIPPING_ADDRESS"})):this.showGooglePayError("SHIPPING_ADDRESS")}handlePaymentFailure(e){return g.authorizationComplete({instrument:this.name,measurement:J(T.AuthorizationLatency,this.name),result:"failure"}),_({transactionState:"ERROR"},e?{error:e}:this.showGooglePayError("PAYMENT_AUTHORIZATION"))}logException(e,{severity:n,metadata:r}={}){w.notify(new us(e),{severity:n!=null?n:"error",metadata:r})}}j=new WeakMap;const ps='<svg viewBox="0 0 41 17" xmlns="http://www.w3.org/2000/svg" width="45px">\n  <path\n    d="M19.526 2.635v4.083h2.518q.9 0 1.488-.605.605-.604.605-1.437 0-.816-.605-1.422-.588-.62-1.488-.62h-2.518zm0 5.52v4.736h-1.504V1.198h3.99q1.519 0 2.582 1.012 1.08 1.013 1.08 2.466 0 1.487-1.08 2.482-1.046.997-2.583.996zm7.668 2.287q0 .587.499.98.498.39 1.168.391.949 0 1.692-.701.745-.703.744-1.65-.704-.555-1.962-.555-.916 0-1.528.442-.613.44-.613 1.093m1.946-5.815q1.668 0 2.633.89.964.891.964 2.442v4.932h-1.439v-1.11h-.065q-.933 1.372-2.486 1.372-1.323 0-2.215-.784t-.891-1.96q0-1.242.94-1.976c.94-.734 1.463-.735 2.51-.735q1.34 0 2.206.49v-.344q0-.784-.621-1.33a2.13 2.13 0 0 0-1.455-.547q-1.26 0-1.995 1.062l-1.324-.834q1.095-1.568 3.238-1.568m11.853.262-5.02 11.53H34.42l1.864-4.034-3.302-7.496h1.635l2.387 5.749h.032l2.322-5.75z"\n  />\n  <path\n    d="M13.448 7.134q-.001-.71-.116-1.366H6.988v2.588h3.634a3.1 3.1 0 0 1-1.344 2.042v1.68h2.169c1.27-1.17 2.001-2.9 2.001-4.944"\n    style="fill: #4285f4"\n  />\n  <path\n    d="M6.988 13.7c1.816 0 3.344-.595 4.459-1.621l-2.169-1.681c-.603.406-1.38.643-2.29.643-1.754 0-3.244-1.182-3.776-2.774H.978v1.731a6.73 6.73 0 0 0 6.01 3.703"\n    style="fill: #34a853"\n  />\n  <path\n    d="M3.212 8.267a4.03 4.03 0 0 1 0-2.572V3.964H.978A6.7 6.7 0 0 0 .261 6.98c0 1.085.26 2.11.717 3.017z"\n    style="fill: #fbbc05"\n  />\n  <path\n    d="M6.988 2.921c.992 0 1.88.34 2.58 1.008v.001l1.92-1.918C10.324.928 8.804.262 6.989.262a6.73 6.73 0 0 0-6.01 3.702l2.234 1.731c.532-1.592 2.022-2.774 3.776-2.774"\n    style="fill: #ea4335"\n  />\n</svg>\n',ms={LIGHT:"light",DARK:"dark"};var ve;class ys extends ge{constructor(){super(),c(this,"name",b.GooglePay),c(this,"paymentsClient",null),c(this,"button",null),Y(this,ve,void 0),c(this,"handleClick",async()=>{if(this.disabled)return;this.disabled=!0;const e=Qt();try{await this.createPaymentsClient(e),await this.paymentsClient.handleClick(),re(this.name)}catch(n){if(this.disabled=!1,n.statusCode==="CANCELED"){e==null||e.abort("Payment sheet cancelled"),g.sheetCancelled(b.GooglePay);return}e==null||e.abort("Payment sheet failure"),w.notify(n),g.sheetClicked({instrument:this.name,result:"failed"});const r=await this.i18n,a=r.translate("brand.google_pay");K(a,r)}}),Q(this,ve,this.attachShadow({mode:"closed"}))}static get observedAttributes(){return["disabled"]}attributeChangedCallback(e,n,r){super.attributeChangedCallback(e,n,r,this.button)}async connectedCallback(){this.cleanupOnFailure(this.render.bind(this),this.name)}async createPaymentsClient(e){this.paymentsClient=new hs({walletParams:this.walletParams,isShippingRequired:this.isShippingRequired,hasSellingPlan:this.hasSellingPlan,dataSource:await this.dataSource,button:this,cartClient:await this.apiClient,i18n:await this.i18n,buyerCurrency:this.buyerCurrency,abortController:e})}async render(){if(this.button)return;await this.initializeShadowStyles(v(this,ve),ts);const{translate:e}=await this.i18n,n=Ve({label:e("buy_with_button_content",{wallet:e("brand.google_pay")})});this.disabled&&n.setAttribute("disabled",""),n.classList.add("button",pe.BUTTON,ms[this.buttonTheme]),n.onclick=this.handleClick,await this.renderButtonContent(n,e),this.button=n,v(this,ve).appendChild(n),this.onRendered()}async renderButtonContent(e,n){const r=new DOMParser().parseFromString(ps,"image/svg+xml").documentElement;if(e.style.font=window.getComputedStyle(this).font,this.isCTA){const a=Xt({translate:n,logoElement:r,setAriaHidden:!0});a.classList.add("content"),e.appendChild(a)}else e.classList.add("logo-only"),e.appendChild(r)}}ve=new WeakMap;const le=class Ys extends ae{static walletName(){return"google_pay"}constructor(e){super(e)}getWebComponentName(){return"shopify-google-pay-button"}getInstrumentName(){return b.GooglePay}getWebComponentClass(){return ys}async loadWalletSDK(){if(Ys.googlePaySDKPromise)return Ys.googlePaySDKPromise;const e=document.createElement("script");return e.setAttribute("src",this.walletParams.sdkUrl),Ys.googlePaySDKPromise=new Promise((n,r)=>{e.onload=()=>n(),e.onerror=a=>{document.body.removeChild(e),r(a)},document.body.appendChild(e)}),Ys.googlePaySDKPromise}getLoadEligibility(){const e=new Date(this.walletParams.expiresAt*1e3).getTime();return Date.now()<=e?{eligible:!0}:{eligible:!1,reason:"authJwtExpired"}}getPartnerSDKEligibility(){return{eligible:!0}}};c(le,"googlePaySDKPromise");let Ut=le;const gs=[Ti,kt,tr,Ut,He,Ft,Tn],fs=new Map(gs.map(t=>[t.walletName(),e=>new t(e)]));function et(t){const e=fs.get(t.name);return e?e(t):(console.debug("Can't build wallet with name ".concat(t.name)),null)}function bs(t){return t.map(e=>et(e)).filter(e=>e!=null)}const kn="*{box-sizing:border-box}.wallet-button-fade-in{animation:animation-fade-in .3s cubic-bezier(.1,.79,1,1)}@keyframes animation-fade-in{0%{opacity:0}to{opacity:1}}button[aria-disabled=true]{opacity:.5;cursor:not-allowed}";class ws{constructor(e,n,r){this.element=e,this.apiClient=n,this.instrumentName=r}async getInitialCart(e){const n=Kt(this.element);if(!n)throw new Error("[".concat(this.instrumentName,"] unable to find product form"));const r=Be(ta),{data:a,errors:i}=await this.apiClient.createCart(D(_({},n),{discountCodes:r?[r]:[],instrumentName:e}));return{cart:a,errors:i}}}function As({instanceNumber:t,styleId:e,styles:n,cssFileName:r}){var a,i;t===1&&(i=(a=window.Shopify)==null?void 0:a.PaymentButton)!=null&&i.isStorefrontPortableWallets&&(_s({styleId:e,styles:n,cssFileName:r})||Cs({styleId:e,styles:n}))}function _s({styleId:t,styles:e,cssFileName:n}){return!!document.querySelector("style#".concat(t))}function Cs({styleId:t,styles:e}){const n=document.createElement("style");n.id=t,n.innerHTML=e,document.head.appendChild(n)}const H={buttonBlockSize:"--shopify-accelerated-checkout-button-block-size",buttonBorderRadius:"--shopify-accelerated-checkout-button-border-radius",buttonBoxShadow:"--shopify-accelerated-checkout-button-box-shadow",inlineAlignment:"--shopify-accelerated-checkout-inline-alignment"};function Ir(t){let e=0,n=0,r=0;const a=t.split(/\s+/);for(let i=0;i<a.length;i++){const o=a[i];o!==">"&&(o.includes("#")&&(e+=(o.match(/#/g)||[]).length),o.includes(".")&&(n+=(o.match(/\./g)||[]).length),o.includes("[")&&(n+=(o.match(/\[/g)||[]).length),o.includes(":")&&(n+=(o.match(/:[^:]/g)||[]).length),/^[A-Za-z]/.test(o)&&(r+=1))}return[e,n,r]}function Ss(t,e){for(let n=0;n<3;n++)if(t[n]!==e[n])return e[n]-t[n];return 0}function vr(t){return[...t].sort((e,n)=>{const r=Ir(e.selector),a=Ir(n.selector);return Ss(r,a)})}const Es=/\.cart__dynamic-checkout-buttons|\.dynamic-checkout-buttons\s*(>\s*)?li(?![a-zA-Z0-9_.:#-])/,Is=/\.cart__dynamic-checkout-buttons|\.dynamic-checkout-buttons\s*\[role="?button"?\](?![:\w-])/,vs=/\.additional-checkout-buttons\s*(?:div\s*)?\[role="?button"?\](?![:\w-])/,Ln=/\[data-shopify-buttoncontainer\](?![:\w-])/,On=/.dynamic-checkout-buttons .shopify-payment-button__button/,Ps=/(?!.*\.shopify-cleanslate)\.shopify-payment-button__button(?:--branded)?(?![\w-:.#>])/,Ds=/\.(shopify-payment-button|shopify-payment-button__button|shopify-payment-button__button--branded)\s*\[role="?button"?\](?![:\w-])/,Ns=/(?:only\s+)?(?:screen\s+and\s+)?\((?:min|max)-(?:width|height):\s*\d+px\)/,Ts=[Is,Ln,Es,vs,On],Rs=[Ps,Ds,On];function xn(t){const e=t.pageType,n=[...document.styleSheets].filter(ks),r=[],a=[];n.forEach(O=>{try{const F=[...O.cssRules].filter(A=>A instanceof CSSMediaRule),Te=[...O.cssRules].filter(A=>A instanceof CSSStyleRule);a.push(...F.filter(A=>Ns.test(A.conditionText)).flatMap(A=>[...A.cssRules].filter(M=>M instanceof CSSStyleRule).flatMap(M=>M.selectorText.split(",").map(Re=>Re.trim()).map(Re=>_({selector:Re,conditionText:A.conditionText},Rr(M)))))),r.push(...Te.flatMap(A=>A.selectorText.split(",").map(M=>M.trim()).map(M=>_({selector:M},Rr(A)))))}catch(F){Qe()("shopify-support-debug")&&(console.debug("[shopify-support-debug] stylesheet origin: ".concat(O.href)),console.debug(F))}});const i=e===S.ProductPage?Rs:Ts,o=new Set;function s(O,F){const Te=F.selector.match(O);return Te?(o.add(Te[0]),!0):!1}const u=r.filter(O=>i.some(F=>s(F,O))).reverse(),l=a.filter(O=>i.some(F=>s(F,O))).reverse(),d=Qe()("shopify-support-debug");d&&console.table(Array.from(o));const p=vr(u),y=vr(l),m={},C=Pr(e)?document.querySelector(".cart__blocks .button"):document.querySelector(".product-form__buttons .button");C&&(m.boxShadow=getComputedStyle(C,":before").boxShadow);for(const O of p){const F=["height","minHeight","borderRadius","marginTop"];Pr(e)&&O.selector.match(Ln)&&F.push("justifyContent");for(const Te of F)m[Te]=xs({rule:O,property:Te,currentPropertyValue:m[Te]})}const{height:f,borderRadius:I,minHeight:B,marginTop:Z,justifyContent:je,boxShadow:mt}=m;return d&&console.table([{property:"height",value:f},{property:"borderRadius",value:I},{property:"minHeight",value:B},{property:"marginTop",value:Z},{property:"justifyContent",value:je},{property:"boxShadow",value:mt}]),e===S.ProductPage?Tr({styles:{height:f,minHeight:B,borderRadius:I,marginTop:Z,boxShadow:mt},mediaRules:y,element:t}):Tr({styles:{borderRadius:I,boxShadow:mt,justifyContent:je},mediaRules:y,element:t})}function Mn(t,e){if(!e)return;const n="global-".concat(t.tagName.toLowerCase(),"-styles");if(document.head.querySelector("style#".concat(n))==null){const r=document.createElement("style");r.id=n,r.innerHTML=e,document.head.appendChild(r)}}function ks(t){const e=t.ownerNode instanceof HTMLLinkElement&&(t.ownerNode.getAttribute("crossorigin")==="anonymous"||t.ownerNode.getAttribute("crossorigin")==="");return t.href==null||t.href.startsWith(window.location.origin)||e}function Pr(t){return t===S.CartPage||t===S.CartAjax}function Dr({height:t,minHeight:e}){let n=t,r=e;return n!=null&&n.includes("var(".concat(H.buttonBlockSize))&&(n=null),r!=null&&r.includes("var(".concat(H.buttonBlockSize))&&(r=null),n===r?n:r&&n?"max(".concat(n,",").concat(r,")"):n||r}function Nr({existingProperties:t,mediaCondition:e,selector:n,styles:r}){const a=_({},r);for(const i of t)delete a[i];for(const[i,o]of Object.entries(a))o!=null&&o.startsWith("var(".concat(i))&&delete a[i];return Object.keys(a).length===0?"":Ls({mediaCondition:e,selector:n,styles:a})}function Ls({mediaCondition:t,selector:e,styles:n}){let r="".concat(t?"@media ".concat(t," { "):"").concat(e," {");for(const[a,i]of Object.entries(n))i&&(r+="\n  ".concat(a,": ").concat(i,";"));return r+="\n}",t&&(r+="}"),r+="\n",r}function Tr({styles:t,element:e,mediaRules:n}){const{height:r,minHeight:a,borderRadius:i,marginTop:o,justifyContent:s,boxShadow:u}=t,l=e.tagName.toLowerCase(),d=getComputedStyle(e),p=new Set;for(const m of Object.values(H))d.getPropertyValue(m)&&p.add(m);let y=Nr({existingProperties:p,selector:l,styles:{[H.buttonBlockSize]:Dr({height:r,minHeight:a}),[H.buttonBorderRadius]:i,[H.buttonBoxShadow]:u,[H.inlineAlignment]:s,"margin-top":o,display:o?"block":void 0}});return n.forEach(m=>{(m.height||m.minHeight||m.borderRadius||m.boxShadow||m.justifyContent||m.marginTop)&&(y+=Nr({existingProperties:p,mediaCondition:m.conditionText,selector:l,styles:{[H.buttonBlockSize]:Dr({height:m.height,minHeight:m.minHeight}),[H.buttonBorderRadius]:m.borderRadius,[H.buttonBoxShadow]:m.boxShadow,[H.inlineAlignment]:m.justifyContent,"margin-top":m.marginTop,display:m.marginTop?"block":void 0}}))}),y.trim()}function Rr(t){return[["height"],["minHeight","min-height"],["borderRadius","border-radius"],["marginTop","margin-top"],["justifyContent","justify-content"]].reduce((e,[n,r])=>(e[n]=Os({rule:t,property:r!=null?r:n}),e),{})}function Os({rule:t,property:e}){const n=t.style.getPropertyValue(e);return t.style.getPropertyPriority(e)?"".concat(n," !important"):n||null}function xs({rule:t,property:e,currentPropertyValue:n}){const r=t[e];return!(n!=null&&n.includes("!important"))&&r!=null&&r.includes("!important")?r:n!=null?n:r}const kr=2e3;class Lr extends Error{constructor(){super(...arguments),c(this,"name","AcceleratedCheckoutError")}}const rt=class el extends Yt{constructor(){super(),c(this,"instanceNumber",++el.instanceCount),c(this,"pageType",S.ProductPage),c(this,"formObserver"),c(this,"dataSource"),c(this,"wrapper"),c(this,"shopPromiseEligible"),c(this,"didInitiateRender",!1),this.wrapper=document.createElement("div"),zt({shop:{shopId:this.shopId}}),As({instanceNumber:this.instanceNumber,styleId:"shopify-accelerated-checkout",styles:Ci,cssFileName:"AcceleratedCheckout.css"}),this.shopPromiseEligible=Hr()}static get observedAttributes(){return["access-token","disabled","has-selling-plan","requires-shipping"]}async connectedCallback(){var e,n,r;try{if((n=(e=this.wrapper)==null?void 0:e.children)!=null&&n.length||this.didInitiateRender)return;if(!this.validateRenderingSurface()){this.clearUI();return}this.instanceNumber===1&&g.initStarted();const a=dt(T.ButtonDisplay,"dc:".concat(this.instanceNumber));this.i18n=it(),this.setupFormObserver(),this.didInitiateRender=!0;const i=await this.loadWallet(),o=(r=i==null?void 0:i.getInstrumentName())!=null?r:b.BuyItNow,s=o===b.ApplePay||o===b.GooglePay;this.apiClient=new pt({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale,withCarrierRates:s}),this.dataSource=new ws(this,this.apiClient,o),this.extractStyles();const u=i==null?void 0:i.createWebComponent({walletContainer:this,dataSource:this.dataSource,i18n:this.i18n,apiClient:this.apiClient,classNames:Ms(o),callToAction:"true",pageType:this.pageType,containerInstanceNumber:this.instanceNumber,onRendered:()=>g.instrumentLoaded({instrumentOrComponentName:o,result:"success",measurement:a()})});if(!u)throw new Lr("No web component found");this.render(u,o),g.initCompleted({result:"success"}),this.instanceNumber===1&&this.triggerLoadedEvent()}catch(a){if(this.clearUI(),g.initCompleted({error:a}),a.name===De.name)throw a;w.notify(new Lr("An error occurred while attempting to render the AcceleratedCheckout: ".concat(a)))}}async attributeChangedCallback(e,n,r){n!==r&&(jt(this,e,r),e==="has-selling-plan"&&this.toggleBuyerConsent(this,this.apiClient,this.i18n))}async render(e,n){this.clearUI();const r=this.attachShadow({mode:"closed"}),a=document.createElement("style");a.innerHTML=kn,r.appendChild(a),this.wrapper.className="wallet-button-fade-in";const i=document.createElement("slot");i.name="button",this.wrapper.appendChild(i);const o=document.createElement("slot");o.name="promise",this.wrapper.appendChild(o);const s=document.createElement("slot");s.name="more-options",this.wrapper.appendChild(s);const u=document.createElement("slot");u.name="buyer-consent",this.wrapper.appendChild(u),r==null||r.appendChild(this.wrapper),this.toggleBuyerConsent(this,this.apiClient,this.i18n);const l=new DocumentFragment;l.appendChild(e);const d=this.getShopPromiseSlot();d&&l.appendChild(d);const p=this.getMorePaymentOptionsLink(n);p&&l.appendChild(p),this.appendChild(l)}getMorePaymentOptionsLink(e){var n,r;if(e===b.BuyItNow)return null;const a=document.createElement("more-payment-options-link");return lt(a,{"buyer-country":(n=this.buyerCountry)!=null?n:"","access-token":(r=this.accessToken)!=null?r:"","recommended-instrument":e,slot:"more-options"}),a.disabled=this.disabled,a.setDataSource(this.dataSource),a.setI18n(this.i18n),a.setClassNames(Pt.MORE_PAYMENT_OPTION_BUTTON),a}getShopPromiseSlot(){if(!this.shopPromiseEligible)return null;const e=document.createElement("div");return e.setAttribute("data-shopify","shop-promise-payment-button-slot"),e.style.height="100%",e.slot="promise",e}validateRenderingSurface(){return ut({page:"product",element:this})!=null}async loadWallet(){const e=_i(this.recommendedWallet,this.fallbackWallet,"AcceleratedCheckout");return await Us(D(_({},e),{instanceNumber:this.instanceNumber}))}setupFormObserver(){this.formObserver||(this.formObserver=new Kr(this,({disabled:e,hasSellingPlan:n})=>{this.disabled=e,this.hasSellingPlan=n,this.isShippingRequired=Fs(this,this.variantParams)}),this.formObserver.setupMutationObservers())}extractStyles(){if(this.styleExtractorDisabled){Qe()("shopify-support-debug")&&console.debug("[shopify-support-debug] styling backward compatibility disabled");return}const e=xn(this);e&&Mn(this,e)}};c(rt,"instanceCount",0);let Bt=rt;function Ms(t){return t===b.BuyItNow?Pt.UNBRANDED_BUTTON:Pt.BRANDED_BUTTON}function Fs(t,e){var n;const r=Kt(t);return!!((n=e.find(a=>a.id===Number(r==null?void 0:r.variantId)))!=null&&n.requiresShipping)}async function Us({recommendedWallet:t,fallbackWallet:e,instanceNumber:n}){const r=t?et(t):null,a=et(e);if(Wt(r)){const i=Nt({walletInstrument:r,instanceNumber:n}),o="timeout",s=await Promise.race([i,new Promise(u=>setTimeout(()=>u(o),kr))]);if(s===o)g.instrumentSDKLoaded({instrument:r.getInstrumentName(),measurement:kr,result:"timeout"});else if(s instanceof ae)return s}return a&&Nt({walletInstrument:a,instanceNumber:n})}G("shopify-accelerated-checkout",Bt),G("more-payment-options-link",hi,{isChildCustomElement:!0});const Bs=t=>{const e=new PerformanceObserver(n=>{n.getEntriesByType("resource").some(r=>r.name.includes(xe.CartUpdate)||r.name.includes(xe.CartChange)||r.name.includes(xe.CartAdd)||r.name.includes(xe.CartClear))&&t()});return e.observe({entryTypes:["resource"]}),e},$s=".wallet-cart-wrapper{--wallet-button-height-horizontal: clamp( 25px, var(--shopify-accelerated-checkout-button-inline-size, 42px), 55px );--wallet-button-height-vertical: clamp( 25px, var(--shopify-accelerated-checkout-button-block-size, 54px), 55px );--wallet-button-width-horizontal: 150px;--wallet-button-width-vertical: 100%;--wallet-button-border-radius: var( --shopify-accelerated-checkout-button-border-radius, 4px );--wallet-grid-margin-horizontal: 0 -5px -5px -5px;--wallet-button-container-margin-horizontal: 0 5px 5px;--wallet-button-container-margin-vertical: var( --shopify-accelerated-checkout-row-gap, 8px ) 0 0}.wallet-cart-wrapper{container-type:inline-size;container-name:wrapper}.wallet-cart-grid{margin:var(--wallet-grid-margin-horizontal);padding:0;display:flex;justify-content:var(--shopify-accelerated-checkout-inline-alignment, start);flex-direction:row}.wallet-cart-grid.wallet-cart-grid--vertical{justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid.wallet-cart-grid--vertical .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid.wallet-cart-grid--vertical .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid.wallet-cart-grid--vertical .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}.wallet-cart-button-container{position:relative;margin:var(--wallet-button-container-margin-horizontal)}.wallet-cart-button-container,.wallet-cart-button{width:var(--wallet-button-width-horizontal);height:var(--wallet-button-height-horizontal);border-radius:var(--wallet-button-border-radius);list-style-type:none!important;text-align:center;flex-shrink:0;flex-grow:0}@container wrapper (width >= 150px) and (width <= 500px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container wrapper (width <= 310px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container wrapper (width <= 470px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container wrapper (width <= 630px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@container wrapper (width <= 790px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)){justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}@media screen and (max-width: 750px){.wallet-cart-grid{justify-content:flex-start;flex-direction:column;max-width:none;margin:0}.wallet-cart-grid .wallet-cart-button-container{max-width:none;width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-grid .wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}@supports (not (container-type: inline-size)) or (not (selector(:has(*)))){.wallet-cart-grid{justify-content:flex-start;flex-direction:column;margin:0}.wallet-cart-button-container{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical);margin:var(--wallet-button-container-margin-vertical)}.wallet-cart-button-container:first-child{margin-top:0}.wallet-cart-grid .wallet-cart-button{width:var(--wallet-button-width-vertical);height:var(--wallet-button-height-vertical)}}",Hs=".wallet-cart-grid.wallet-cart-grid--vertical .wallet-cart-button-container:first-child{margin-top:8px}@container wrapper (width >= 150px) and (width <= 500px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button-container:first-child{margin-top:8px}}@container wrapper (width <= 310px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button-container:first-child{margin-top:8px}}@container wrapper (width <= 470px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button-container:first-child{margin-top:8px}}@container wrapper (width <= 630px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button-container:first-child{margin-top:8px}}@container wrapper (width <= 790px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button-container:first-child{margin-top:8px}}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button-container:first-child{margin-top:8px}@media screen and (max-width: 750px){.wallet-cart-grid .wallet-cart-button-container:first-child{margin-top:8px}}@supports (not (container-type: inline-size)) or (not (selector(:has(*)))){.wallet-cart-button-container:first-child{margin-top:8px}}";function Gs(t){const e=ut({page:"cart",element:t});return Wr({type:"attributes",form:e})}class zs{constructor(e,n,r){this.element=e,this.cartToken=n,this.apiClient=r}async getInitialCart(e){const n="gid://shopify/Cart/".concat(this.cartToken),r=Gs(this.element);let a,i=[];if(r.length){const o=await this.apiClient.updateCartAttributes({cartId:n,attributes:r,instrumentName:e,startingCheckout:!0});a=o.data,i=o.errors}else a=await this.apiClient.fetchCart({id:n,instrumentName:e,startingCheckout:!0});return{cart:a,errors:i}}}var Pe;const nt=class tl extends Yt{constructor(){super(),c(this,"instanceNumber",++tl.instanceCount),c(this,"pageType",S.CartPage),c(this,"cartObserver",null),c(this,"dataSource",null),c(this,"wrapper"),c(this,"didInitiateRender",!1),Y(this,Pe,void 0),zt({shop:{shopId:this.shopId,cartId:this.cartId}}),this.wrapper=document.createElement("div")}static get observedAttributes(){return["access-token","has-selling-plan","requires-shipping"]}createDataSource(e){if(!this.cartToken)throw new Error("[AcceleratedCheckoutCart] cart cookie does not exist");const n=it(),r=new pt({accessToken:this.accessToken,country:this.buyerCountry,locale:n.locale,withCarrierRates:e}),a=new zs(this,this.cartToken,r);this.dataSource=a,this.apiClient=r,this.i18n=n}async createWebComponents({shouldRefetchCartAttributes:e}){if(!this.walletConfigs)throw new Error("[AcceleratedCheckoutCart] walletConfigs does not exist");const n=yi(this.walletConfigs,"AcceleratedCheckoutCart");if(!(n instanceof Array))throw new Error("[AcceleratedCheckoutCart] invalid walletConfigs found");const r=T.ButtonDisplay,a=u=>"".concat(u,":").concat(this.instanceNumber),i=await Vs({walletConfigs:n,instanceNumber:this.instanceNumber,startButtonDisplayBenchmark:u=>qe(r,a(u))}),o=new Set([b.ApplePay,b.GooglePay]),s=i.some(u=>o.has(u.getInstrumentName()));return this.createDataSource(s),e&&await this.updateAttributes(),i.map(u=>{const l=u.getInstrumentName();return u.createWebComponent({walletContainer:this,dataSource:this.dataSource,i18n:this.i18n,apiClient:this.apiClient,pageType:this.pageType,containerInstanceNumber:this.instanceNumber,slot:"button-".concat(u.getInstrumentName()),onRendered:()=>g.instrumentLoaded({instrumentOrComponentName:l,result:"success",measurement:J(r,a(l))})})})}async cartChangedCallback(){try{if(!this.dataSource&&this.cartToken){await this.render({shouldRefetchCartAttributes:!0});return}else if(!this.cartToken){g.cartTokenMissing({reason:"cartChangedCallback"});return}await this.updateAttributes()}catch(e){this.clearUI(),w.notify(e)}}async updateAttributes(){var e;if(!this.cartToken)return;const n=await((e=this.apiClient)==null?void 0:e.fetchCart({id:"gid://shopify/Cart/".concat(this.cartToken),instrumentName:b.Unknown}));if(!(n!=null&&n.id))throw new Error("[".concat(this.updateAttributes,"] received invalid cart"));this.hasSellingPlan=n.lineItems.some(r=>r.sellingPlanAllocation!=null),this.isShippingRequired=n.lineItems.some(r=>r.merchandise.requiresShipping)}async connectedCallback(){try{if(this.didInitiateRender)return;if(U({event:L.CartInitCalled}),this.cartObserver=Bs(()=>this.cartChangedCallback()),!this.cartToken){g.cartTokenMissing({reason:"connectedCallback"});return}await this.render({shouldRefetchCartAttributes:!1})}catch(e){this.clearUI(),w.notify(e)}}disconnectedCallback(){var e;(e=this.cartObserver)==null||e.disconnect()}async attributeChangedCallback(e,n,r){n!==r&&(jt(this,e,r),e==="has-selling-plan"&&this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n))}get cartToken(){return Be("cart")}async render({shouldRefetchCartAttributes:e}){if(this.hasLegacyCartCookie()){g.legacyCartCookie(),this.clearUI();return}this.didInitiateRender=!0;const n=dt(T.ButtonDisplay,"cart:".concat(this.instanceNumber)),r=await this.createWebComponents({shouldRefetchCartAttributes:e});if(this.clearUI(),r.length===0)return;const a=new DocumentFragment,i=this.getOrCreateShadowRoot(),o=document.createElement("style");o.innerHTML=[kn,$s].join("\n"),i.appendChild(o),this.extractStyles(),this.wrapper=document.createElement("div"),this.wrapper.className="wallet-cart-wrapper wallet-button-fade-in";const s=document.createElement("ul");s.className="wallet-cart-grid ".concat(pe.CONTAINER),s.setAttribute("role","list"),qs()&&s.classList.add("wallet-cart-grid--vertical"),r.forEach(l=>{const d=document.createElement("li"),p=document.createElement("div"),y=document.createElement("slot");y.name="button-".concat(l.name),d.className="wallet-cart-button-container",p.className="wallet-cart-button",d.setAttribute("data-testid","grid-cell"),d.appendChild(p),p.appendChild(y),s.appendChild(d),a.appendChild(l)}),this.wrapper.appendChild(s);const u=document.createElement("slot");u.name="buyer-consent",this.wrapper.appendChild(u),this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n),i.appendChild(this.wrapper),this.appendChild(a),g.instrumentLoaded({instrumentOrComponentName:"AcceleratedCheckoutCart",result:"success",measurement:n()})}getOrCreateShadowRoot(){return v(this,Pe)||Q(this,Pe,this.attachShadow({mode:"closed"})),v(this,Pe)}hasLegacyCartCookie(){var e;return this.cartToken?(e=this.cartToken)==null?void 0:e.match(/^[a-z0-9]+$/):!1}extractStyles(){if(this.styleExtractorDisabled){Qe()("shopify-support-debug")&&console.debug("[shopify-support-debug] styling backward compatibility disabled");return}const e=xn(this);if(e){Mn(this,e);const n=this.getOrCreateShadowRoot(),r=document.createElement("style");r.innerHTML=Hs,n.appendChild(r)}}};Pe=new WeakMap,c(nt,"instanceCount",0);let $t=nt;async function Vs({walletConfigs:t,instanceNumber:e,startButtonDisplayBenchmark:n=()=>{}}){const r=fi(bs(t));return(await Promise.all(r.map(a=>(n(a.getInstrumentName()),Nt({walletInstrument:a,instanceNumber:e}))))).filter(a=>a!=null)}function qs(){return!!document.querySelector(".additional-checkout-buttons--vertical shopify-accelerated-checkout-cart")}G("shopify-accelerated-checkout-cart",$t);class js{getInitialCart(){throw new Error('[NoOpDataSource] Unexpected call to "getCart"')}}const at=class nl extends Yt{constructor(){super(),c(this,"instanceNumber",++nl.instanceCount),zt({shop:{shopId:this.shopId}})}get walletConfig(){return this.getAttribute("wallet-config")}get pageType(){return this.getAttribute("page-type")||S.Unknown}async connectedCallback(){try{if(this.children.length)return;this.instanceNumber===1&&g.initStarted();const e=dt(T.ButtonDisplay,"dc:".concat(this.instanceNumber)),n=gi(this.walletConfig,"WalletButton");if(!n)throw new na("[WalletButton] No config provided.");const r=et(n);if(!r||!await this.eligibleToShow(r))return;const a=r.getInstrumentName();this.i18n=it(),this.apiClient=new pt({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale});const i=this.createWebComponent(r,this.i18n,this.apiClient,a,e);this.innerHTML="",this.appendChild(i),g.initCompleted({result:"success"}),this.instanceNumber===1&&this.triggerLoadedEvent()}catch(e){this.innerHTML="",g.initCompleted({error:e}),w.notify(e)}}createWebComponent(e,n,r,a,i){const o=e.createWebComponent({walletContainer:this,dataSource:new js,i18n:n,apiClient:r,containerInstanceNumber:this.instanceNumber,pageType:this.pageType});return o.onRendered=()=>{g.instrumentLoaded({instrumentOrComponentName:a,result:"success",measurement:i()})},o}async eligibleToShow(e){return!(!Wt(e)||(await e.loadWalletSDK(),!e.getPartnerSDKEligibility().eligible))}};c(at,"instanceCount",0);let Ht=at;G("shopify-wallet-button",Ht),Jn(w),Zn(w),g.startExporter();
